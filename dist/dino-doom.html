<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DINO DOOM: Santa's Last Stand</title>
    <link href="https://fonts.googleapis.com/css2?family=Bungee&family=Orbitron:wght@700;900&family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>*{margin:0;padding:0;box-sizing:border-box}body{background:#0a0a0f;font-family:'Orbitron',sans-serif;overflow:hidden;cursor:none}#game-container{position:relative;width:100vw;height:100vh;background:linear-gradient(180deg,#1a0a2e 0%,#16213e 50%,#0f3460 100%);transition:transform 0.05s ease-out}#game-canvas{display:block;width:100%;height:100%}#hud{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none}.hud-corner{position:absolute;padding:20px}.top-left{top:0;left:0}.top-right{top:0;right:0;text-align:right}.bottom-left{bottom:0;left:0}.bottom-right{bottom:0;right:0;text-align:right}.top-center{top:0;left:50%;transform:translateX(-50%);text-align:center}.stat-label{font-family:'Press Start 2P',monospace;font-size:10px;color:#ff6b6b;text-transform:uppercase;letter-spacing:2px;text-shadow:0 0 10px #ff6b6b}.stat-value{font-family:'Bungee',cursive;font-size:36px;color:#fff;text-shadow:0 0 10px #00ff88,0 0 20px #00ff88,0 0 40px #00ff88}#health-bar-container{width:300px;height:30px;background:rgba(0,0,0,0.7);border:3px solid #ff3333;border-radius:5px;overflow:hidden;box-shadow:0 0 20px rgba(255,51,51,0.5)}#health-bar{height:100%;background:linear-gradient(90deg,#ff0000,#ff6600,#ff3333);transition:width 0.3s ease;box-shadow:inset 0 0 20px rgba(255,255,255,0.3)}#coins-display{font-family:'Orbitron',sans-serif;font-size:28px;font-weight:900;color:#ffd700;text-shadow:0 0 10px #ffd700}#wave-display{font-family:'Bungee',cursive;font-size:24px;color:#ffcc00;text-shadow:0 0 15px #ffcc00}#weapon-name{font-family:'Bungee',cursive;font-size:20px;color:#ff6b6b;text-shadow:0 0 10px #ff6b6b}#kill-feed{position:absolute;top:100px;right:20px;width:300px}.kill-entry{font-family:'Press Start 2P',monospace;font-size:10px;color:#fff;padding:8px 12px;margin-bottom:5px;background:rgba(0,0,0,0.7);border-left:4px solid #ff0000;animation:killSlide 0.3s ease-out}#damage-overlay{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;background:radial-gradient(ellipse at center,transparent 50%,rgba(255,0,0,0.5) 100%);opacity:0;transition:opacity 0.1s}#wave-announcement{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-family:'Bungee',cursive;font-size:72px;color:#ffcc00;text-shadow:0 0 20px #ffcc00,0 0 40px #ffcc00;opacity:0;pointer-events:none;z-index:50;text-align:center}#muzzle-flash{position:absolute;bottom:100px;left:50%;transform:translateX(-50%);width:100px;height:100px;background:radial-gradient(circle,#ffff00 0%,#ff6600 30%,transparent 70%);opacity:0;pointer-events:none}#crosshair{position:absolute;pointer-events:none;z-index:50}.crosshair-line{position:absolute;background:#ff0000;box-shadow:0 0 10px #ff0000,0 0 20px #ff0000}.crosshair-h{width:20px;height:3px;top:50%;transform:translateY(-50%)}.crosshair-v{width:3px;height:20px;left:50%;transform:translateX(-50%)}.ch-left{left:-35px}.ch-right{right:-35px}.ch-top{top:-35px}.ch-bottom{bottom:-35px}#crosshair-dot{position:absolute;width:6px;height:6px;background:#ff0000;border-radius:50%;top:50%;left:50%;transform:translate(-50%,-50%);box-shadow:0 0 15px #ff0000}.hit-marker{position:absolute;pointer-events:none;z-index:60;width:40px;height:40px;transform:translate(-50%,-50%);animation:hitMarkerFade 0.2s ease-out forwards}.hit-marker::before,.hit-marker::after{content:'';position:absolute;top:50%;left:50%;width:20px;height:3px;background:white;box-shadow:0 0 8px white,0 0 15px white}.hit-marker::before{transform:translate(-50%,-50%) rotate(45deg)}.hit-marker::after{transform:translate(-50%,-50%) rotate(-45deg)}.hit-marker.crit::before,.hit-marker.crit::after{background:#ffd700;box-shadow:0 0 10px #ffd700,0 0 20px #ff8800;width:25px;height:4px}#combo-counter{position:absolute;top:180px;left:20px;font-family:'Bungee',cursive;font-size:32px;color:#00ff00;text-shadow:0 0 10px #00ff00;pointer-events:none;z-index:60;display:none;animation:comboPulse 0.3s ease-out}#combo-counter.wombo-combo{animation:womboComboShake 0.2s infinite}.kill-streak-announcement{position:absolute;top:30%;left:50%;transform:translate(-50%,-50%);font-family:'Bungee',cursive;font-size:64px;font-weight:bold;pointer-events:none;z-index:70;animation:killStreakAnimate 1.5s ease-out forwards;text-transform:uppercase;letter-spacing:4px}#achievement-container{position:absolute;top:20px;right:20px;width:320px;pointer-events:none;z-index:80;display:flex;flex-direction:column;gap:10px}.achievement-toast{background:linear-gradient(135deg,rgba(30,30,30,0.95),rgba(50,50,50,0.95));border:2px solid #ffd700;border-radius:10px;padding:15px 20px;display:flex;align-items:center;gap:15px;animation:achievementSlideIn 0.5s ease-out forwards;box-shadow:0 0 20px rgba(255,215,0,0.3)}.achievement-toast.hiding{animation:achievementSlideOut 0.5s ease-in forwards}.achievement-icon{font-size:32px}.achievement-content{flex:1}.achievement-title{font-family:'Bungee',cursive;font-size:14px;color:#ffd700;text-shadow:0 0 10px #ffd700;margin-bottom:4px}.achievement-name{font-family:'Orbitron',sans-serif;font-size:12px;color:#ffffff}#boss-intro-overlay{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0);display:none;justify-content:center;align-items:center;flex-direction:column;z-index:100;pointer-events:none}#boss-intro-overlay.active{display:flex;animation:bossDarken 0.5s ease-out forwards}#boss-intro-emoji{font-size:150px;opacity:0;transform:translateY(-200px) scale(0.5)}#boss-intro-emoji.slide-in{animation:bossSlideIn 0.8s ease-out forwards}#boss-intro-name{font-family:'Orbitron',sans-serif;font-size:48px;color:#ffd700;text-shadow:0 0 20px #ffd700,0 0 40px #ff8800;opacity:0;margin-top:20px}#boss-intro-name.show{animation:bossNameReveal 0.5s ease-out forwards}#boss-intro-title{font-family:'Press Start 2P',monospace;font-size:18px;color:#ff4444;text-shadow:0 0 10px #ff0000;opacity:0;margin-top:10px}#boss-intro-title.show{animation:bossTitleReveal 0.4s ease-out forwards}#boss-intro-flash{position:absolute;top:0;left:0;width:100%;height:100%;background:white;opacity:0;pointer-events:none}#boss-intro-flash.flash{animation:bossFlash 0.3s ease-out forwards}#boss-health-container{position:absolute;top:80px;left:50%;transform:translateX(-50%);width:500px;display:none;text-align:center}#boss-name{font-family:'Bungee',cursive;font-size:24px;color:#ff0000;text-shadow:0 0 10px #ff0000;margin-bottom:10px}#boss-health-bar-bg{width:100%;height:25px;background:#333;border:3px solid #ff0000;border-radius:5px;overflow:hidden}#boss-health-bar{height:100%;background:linear-gradient(90deg,#ff0000,#ff6600);transition:width 0.3s}#start-screen{position:absolute;top:0;left:0;width:100%;height:100%;background:linear-gradient(180deg,#0a0015 0%,#1a0a2e 50%,#0f1a3e 100%);display:flex;flex-direction:column;justify-content:center;align-items:center;z-index:100}#start-screen h1{font-family:'Bungee',cursive;font-size:72px;color:#ff3333;text-shadow:0 0 10px #ff3333,0 0 30px #ff3333,0 0 60px #ff3333,5px 5px 0 #00ff88;margin-bottom:20px;animation:titlePulse 2s ease-in-out infinite}#start-screen h2{font-family:'Orbitron',sans-serif;font-size:28px;color:#00ffff;text-shadow:0 0 20px #00ffff;margin-bottom:50px}.enemy-preview{display:flex;gap:60px;margin-bottom:50px}.enemy-card{text-align:center;padding:20px;background:rgba(0,0,0,0.5);border:2px solid #ff6b6b;border-radius:10px}.enemy-card h3{font-family:'Press Start 2P',monospace;font-size:12px;color:#ffcc00;margin-top:10px}#skin-selector{margin:20px 0;padding:20px;background:rgba(0,0,0,0.5);border:2px solid #ffd700;border-radius:15px}#skin-selector h3{font-family:'Orbitron',sans-serif;font-size:18px;color:#ffd700;margin-bottom:15px;text-shadow:0 0 10px rgba(255,215,0,0.5)}#skin-options{display:flex;gap:15px;justify-content:center;flex-wrap:wrap}.skin-option{background:rgba(30,30,50,0.9);border:3px solid #444;border-radius:10px;padding:15px;width:120px;text-align:center;cursor:pointer;transition:all 0.2s}.skin-option:hover{border-color:#ffd700;transform:translateY(-3px)}.skin-option.selected{border-color:#00ff00;box-shadow:0 0 20px rgba(0,255,0,0.4)}.skin-option.locked{opacity:0.6}.skin-option.locked:hover{border-color:#ff4444}.skin-emoji{font-size:50px;margin-bottom:8px}.skin-name{font-family:'Press Start 2P',monospace;font-size:10px;color:#fff;margin-bottom:5px}.skin-price{font-family:'Orbitron',sans-serif;font-size:12px;color:#ffd700}.skin-price.owned{color:#00ff00}#skin-coins-display{margin-top:15px;font-family:'Orbitron',sans-serif;font-size:16px;color:#ffd700}.game-btn{font-family:'Bungee',cursive;font-size:32px;padding:20px 60px;background:linear-gradient(180deg,#ff3333,#cc0000);color:#fff;border:none;border-radius:10px;cursor:pointer;text-shadow:2px 2px 0 #000;box-shadow:0 5px 0 #990000,0 10px 30px rgba(255,0,0,0.5);transition:all 0.1s;pointer-events:auto}.game-btn:hover{transform:translateY(-3px);box-shadow:0 8px 0 #990000,0 15px 40px rgba(255,0,0,0.7)}.game-btn:active{transform:translateY(3px);box-shadow:0 2px 0 #990000,0 5px 20px rgba(255,0,0,0.5)}.game-btn.green{background:linear-gradient(180deg,#00ff88,#00aa55);box-shadow:0 5px 0 #007733,0 10px 30px rgba(0,255,136,0.5)}.game-btn.green:hover{box-shadow:0 8px 0 #007733,0 15px 40px rgba(0,255,136,0.7)}.controls-info{margin-top:40px;font-family:'Press Start 2P',monospace;font-size:10px;color:#888;text-align:center;line-height:2}#shop-screen{position:absolute;top:0;left:0;width:100%;height:100%;background:linear-gradient(180deg,#0a0015 0%,#1a0a2e 100%);display:none;flex-direction:column;align-items:center;padding:40px;z-index:100;overflow-y:auto}#shop-screen h1{font-family:'Bungee',cursive;font-size:48px;color:#ffd700;text-shadow:0 0 20px #ffd700;margin-bottom:10px}#shop-coins{font-family:'Orbitron',sans-serif;font-size:28px;color:#ffd700;margin-bottom:20px}#shopkeeper-container{display:flex;align-items:center;gap:20px;background:linear-gradient(135deg,rgba(40,30,60,0.9),rgba(30,20,50,0.9));border:2px solid #8b7355;border-radius:15px;padding:15px 25px;margin-bottom:25px;max-width:600px;box-shadow:0 0 20px rgba(139,115,85,0.3)}#shopkeeper-emoji{font-size:80px;animation:shopkeeperBob 2s ease-in-out infinite}#shopkeeper-dialogue{font-family:'Press Start 2P',monospace;font-size:14px;color:#ffd700;text-shadow:0 0 10px rgba(255,215,0,0.5);line-height:1.6;max-width:400px}.shop-section{width:100%;max-width:900px;margin-bottom:30px}.shop-section h2{font-family:'Orbitron',sans-serif;font-size:24px;color:#00ffff;margin-bottom:15px;border-bottom:2px solid #00ffff;padding-bottom:10px}.shop-items{display:flex;flex-wrap:wrap;gap:15px}.shop-item{background:rgba(0,0,0,0.6);border:2px solid #444;border-radius:10px;padding:20px;width:200px;text-align:center;cursor:pointer;transition:all 0.2s;pointer-events:auto}.shop-item:hover{border-color:#ffd700;transform:translateY(-5px);box-shadow:0 10px 30px rgba(255,215,0,0.3)}.shop-item.owned{border-color:#00ff88;background:rgba(0,255,136,0.1)}.shop-item.equipped{border-color:#00ffff;box-shadow:0 0 20px #00ffff}.shop-item.maxed{border-color:#888;opacity:0.6;cursor:not-allowed}.shop-item-icon{font-size:48px;margin-bottom:10px}.shop-item-name{font-family:'Orbitron',sans-serif;font-size:14px;color:#fff;margin-bottom:5px}.shop-item-desc{font-size:11px;color:#aaa;margin-bottom:10px}.shop-item-price{font-family:'Bungee',cursive;font-size:18px;color:#ffd700}.shop-item-level{font-size:12px;color:#00ff88;margin-top:5px}#continue-btn{margin-top:20px;font-size:24px;padding:15px 50px}#minigame-screen{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.95);display:none;flex-direction:column;justify-content:center;align-items:center;z-index:150;cursor:crosshair}#minigame-screen h1{font-family:'Bungee',cursive;font-size:36px;color:#ff3333;text-shadow:0 0 20px #ff3333;margin-bottom:20px}#minigame-instructions{font-family:'Press Start 2P',monospace;font-size:14px;color:#ffcc00;margin-bottom:30px;text-align:center}#minigame-area{width:600px;height:400px;background:#111;border:3px solid #ff3333;border-radius:10px;position:relative;overflow:hidden}.minigame-target{position:absolute;width:60px;height:60px;border-radius:50%;background:radial-gradient(circle,#ff0000,#aa0000);border:3px solid #fff;cursor:crosshair;display:flex;justify-content:center;align-items:center;font-size:30px;animation:targetPulse 0.5s ease-in-out infinite;pointer-events:auto}#minigame-timer{font-family:'Bungee',cursive;font-size:48px;color:#00ffff;margin-top:20px}#minigame-hits{font-family:'Orbitron',sans-serif;font-size:24px;color:#00ff88;margin-top:10px}#game-over{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.95);display:none;flex-direction:column;justify-content:center;align-items:center;z-index:100}#death-receipt{background:#111;border:3px solid #ff3333;border-radius:15px;padding:30px 40px;max-width:450px;text-align:center;box-shadow:0 0 30px rgba(255,0,0,0.5),inset 0 0 50px rgba(0,0,0,0.5)}.receipt-header h1{font-family:'Bungee',cursive;font-size:32px;color:#ff3333;text-shadow:0 0 20px #ff3333;margin:0 0 5px 0;animation:gameOverShake 0.5s ease-in-out infinite}.receipt-subtitle{font-family:'Press Start 2P',monospace;font-size:10px;color:#888;letter-spacing:2px}.receipt-divider{font-family:monospace;color:#444;margin:15px 0;font-size:12px}.receipt-stats{text-align:left}.receipt-row{display:flex;justify-content:space-between;font-family:'Orbitron',sans-serif;font-size:14px;color:#ccc;margin:8px 0}.receipt-row span:last-child{color:#00ff88;font-weight:bold}.receipt-rating{margin:20px 0}.rating-label{font-family:'Press Start 2P',monospace;font-size:10px;color:#888;margin-bottom:10px}.rating-value{font-family:'Bungee',cursive;font-size:36px;color:#ffd700;text-shadow:0 0 15px #ffd700}.receipt-lastwords{margin:15px 0}.lastwords-label{font-family:'Press Start 2P',monospace;font-size:10px;color:#888;margin-bottom:8px}.lastwords-text{font-family:'Orbitron',sans-serif;font-size:14px;color:#ff6b6b;font-style:italic}.receipt-buttons{display:flex;gap:15px;justify-content:center;margin-top:20px}@keyframes titlePulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}@keyframes hitMarkerFade{0%{opacity:1;transform:translate(-50%,-50%) scale(1.2)}100%{opacity:0;transform:translate(-50%,-50%) scale(1)}}@keyframes killStreakAnimate{0%{opacity:0;transform:translate(-50%,-50%) scale(0.5)}15%{opacity:1;transform:translate(-50%,-50%) scale(1.3)}30%{transform:translate(-50%,-50%) scale(1)}70%{opacity:1}100%{opacity:0;transform:translate(-50%,-50%) scale(1.1)}}@keyframes achievementSlideIn{0%{opacity:0;transform:translateX(100%)}100%{opacity:1;transform:translateX(0)}}@keyframes achievementSlideOut{0%{opacity:1;transform:translateX(0)}100%{opacity:0;transform:translateX(100%)}}@keyframes bossDarken{0%{background:rgba(0,0,0,0)}100%{background:rgba(0,0,0,0.8)}}@keyframes bossSlideIn{0%{opacity:0;transform:translateY(-200px) scale(0.5)}70%{transform:translateY(20px) scale(1.2)}100%{opacity:1;transform:translateY(0) scale(1)}}@keyframes bossNameReveal{0%{opacity:0;transform:scale(0.5);letter-spacing:20px}100%{opacity:1;transform:scale(1);letter-spacing:5px}}@keyframes bossTitleReveal{0%{opacity:0;transform:translateY(20px)}100%{opacity:1;transform:translateY(0)}}@keyframes bossFlash{0%{opacity:0.8}100%{opacity:0}}@keyframes killSlide{from{transform:translateX(100px);opacity:0}to{transform:translateX(0);opacity:1}}@keyframes gameOverShake{0%,100%{transform:translateX(0)}25%{transform:translateX(-3px)}75%{transform:translateX(3px)}}@keyframes shopkeeperBob{0%,100%{transform:translateY(0)}50%{transform:translateY(-5px)}}@keyframes targetPulse{0%,100%{transform:scale(1)}50%{transform:scale(1.1)}}@keyframes comboPulse{0%{transform:scale(1.3)}100%{transform:scale(1)}}@keyframes womboComboShake{0%,100%{transform:translateX(0) rotate(0deg)}25%{transform:translateX(-3px) rotate(-2deg)}75%{transform:translateX(3px) rotate(2deg)}}@keyframes womboComboAnim{0%{transform:translate(-50%,-50%) scale(0);opacity:0}20%{transform:translate(-50%,-50%) scale(1.3);opacity:1}40%{transform:translate(-50%,-50%) scale(1)}80%{opacity:1}100%{transform:translate(-50%,-50%) scale(1.1);opacity:0}}#deep-fried-toggle{margin:20px 0;text-align:center}.toggle-btn{font-family:'Bungee',cursive;font-size:20px;padding:15px 30px;background:linear-gradient(180deg,#444,#222);color:#fff;border:3px solid #666;border-radius:10px;cursor:pointer;transition:all 0.2s;display:flex;align-items:center;gap:15px;margin:0 auto;pointer-events:auto}.toggle-btn:hover{border-color:#ffd700;transform:translateY(-2px);box-shadow:0 5px 20px rgba(255,215,0,0.3)}.toggle-btn.active{background:linear-gradient(180deg,#ff6600,#cc3300);border-color:#ff8800;box-shadow:0 0 30px rgba(255,136,0,0.5);animation:deepFriedPulse 0.5s ease-in-out infinite}.toggle-emoji{font-size:32px}.toggle-text{text-shadow:2px 2px 0 #000}.toggle-desc{font-family:'Press Start 2P',monospace;font-size:10px;color:#888;margin-top:10px}#game-container.deep-fried{filter:saturate(3) contrast(1.5) brightness(1.2)}#game-container.deep-fried #game-canvas{animation:chromaticAberration 0.1s infinite}#chromatic-overlay{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:5;opacity:0;mix-blend-mode:screen}#game-container.deep-fried #chromatic-overlay{opacity:0.15;background:linear-gradient(90deg,rgba(255,0,0,0.3) 0%,rgba(0,255,0,0.3) 50%,rgba(0,0,255,0.3) 100%);animation:chromaticShift 0.2s infinite}#lens-flare-container{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:55;overflow:hidden}.lens-flare{position:absolute;font-size:48px;pointer-events:none;animation:lensFlareAnim 1s ease-out forwards;text-shadow:0 0 20px #fff,0 0 40px #ff0;filter:saturate(3) brightness(1.5)}#game-container.deep-fried .stat-value,#game-container.deep-fried .stat-label,#game-container.deep-fried #weapon-name,#game-container.deep-fried #wave-display{animation:textDistort 0.1s infinite;text-shadow:2px 0 #ff0000,-2px 0 #00ff00,0 2px #0000ff,0 0 10px currentColor}@keyframes deepFriedPulse{0%,100%{box-shadow:0 0 30px rgba(255,136,0,0.5)}50%{box-shadow:0 0 50px rgba(255,136,0,0.8)}}@keyframes chromaticAberration{0%{transform:translate(0,0)}25%{transform:translate(1px,-1px)}50%{transform:translate(-1px,1px)}75%{transform:translate(1px,1px)}100%{transform:translate(0,0)}}@keyframes chromaticShift{0%{transform:translateX(-2px)}50%{transform:translateX(2px)}100%{transform:translateX(-2px)}}@keyframes textDistort{0%{transform:skewX(0deg)}25%{transform:skewX(1deg)}50%{transform:skewX(-1deg)}75%{transform:skewX(0.5deg)}100%{transform:skewX(0deg)}}@keyframes lensFlareAnim{0%{opacity:1;transform:translate(-50%,-50%) scale(0.5) rotate(0deg)}50%{opacity:1;transform:translate(-50%,-50%) scale(1.5) rotate(180deg)}100%{opacity:0;transform:translate(-50%,-50%) scale(2) rotate(360deg)}}</style>
</head>
<body>
    <div id="game-container">
        <canvas id="game-canvas"></canvas>
        <div id="chromatic-overlay"></div>
        <div id="lens-flare-container"></div>

        <div id="hud">
            <div class="hud-corner top-left">
                <div class="stat-label">SCORE</div>
                <div class="stat-value" id="score">0</div>
                <div style="margin-top: 10px;">
                    <div class="stat-label">COINS</div>
                    <div id="coins-display">ü™ô 0</div>
                </div>
            </div>

            <div class="hud-corner top-right">
                <div class="stat-label">WAVE</div>
                <div id="wave-display">WAVE 1</div>
                <div style="margin-top: 10px;">
                    <div class="stat-label">KILLS</div>
                    <div class="stat-value" id="kills" style="font-size: 24px;">0</div>
                </div>
            </div>

            <div class="hud-corner bottom-left">
                <div class="stat-label">HEALTH</div>
                <div id="health-bar-container">
                    <div id="health-bar" style="width: 100%;"></div>
                </div>
                <div style="margin-top: 15px;">
                    <div class="stat-label">AMMO</div>
                    <div id="ammo-display" style="font-size: 32px; color: #00ffff; text-shadow: 0 0 10px #00ffff;">‚àû</div>
                </div>
                <div style="margin-top: 15px;">
                    <div class="stat-label">HEALING POWER [E]</div>
                    <div id="heal-power-container" style="width: 200px; height: 20px; background: rgba(0,0,0,0.7); border: 2px solid #00ff00; border-radius: 5px; overflow: hidden;">
                        <div id="heal-power-bar" style="height: 100%; width: 0%; background: linear-gradient(90deg, #00ff00, #88ff88); transition: width 0.3s;"></div>
                    </div>
                    <div id="heal-power-text" style="font-size: 14px; color: #00ff00; margin-top: 5px;">0 / 10 kills</div>
                </div>
            </div>

            <div class="hud-corner bottom-right">
                <div class="stat-label">WEAPON</div>
                <div id="weapon-name">üéÅ PRESENT LAUNCHER</div>
                <div id="weapon-stats" style="font-size: 12px; color: #888; margin-top: 5px;"></div>
            </div>

            <div id="crosshair">
                <div class="crosshair-line crosshair-h ch-left"></div>
                <div class="crosshair-line crosshair-h ch-right"></div>
                <div class="crosshair-line crosshair-v ch-top"></div>
                <div class="crosshair-line crosshair-v ch-bottom"></div>
                <div id="crosshair-dot"></div>
            </div>

            <div id="kill-feed"></div>
            <div id="combo-counter"></div>
            <div id="achievement-container"></div>

            <!-- Boss Intro Cutscene Overlay -->
            <div id="boss-intro-overlay">
                <div id="boss-intro-emoji">üëë</div>
                <div id="boss-intro-name">BOSS NAME</div>
                <div id="boss-intro-title">Boss Title</div>
                <div id="boss-intro-flash"></div>
            </div>

            <div id="boss-health-container">
                <div id="boss-name">üíÄ MEGA BOSS üíÄ</div>
                <div id="boss-health-bar-bg">
                    <div id="boss-health-bar" style="width: 100%;"></div>
                </div>
            </div>
        </div>

        <div id="damage-overlay"></div>
        <div id="muzzle-flash"></div>
        <div id="wave-announcement"></div>

        <!-- Start Screen -->
        <div id="start-screen">
            <h1>ü¶ñ DINO DOOM ü¶ñ</h1>
            <h2>üéÖ Santa's Last Stand Against The Buff Dinos! üéÖ</h2>

            <div class="enemy-preview">
                <div class="enemy-card">
                    <div style="font-size: 80px;">ü¶ñ</div>
                    <h3>GIGACHAD DINO</h3>
                    <p style="color: #ff6b6b; font-size: 12px; margin-top: 5px;">ULTRA SWOLE ‚Ä¢ SLOW</p>
                </div>
                <div class="enemy-card">
                    <div style="font-size: 80px;">ü§ìü¶ï</div>
                    <h3>BUFF NERD DINO</h3>
                    <p style="color: #00ffff; font-size: 12px; margin-top: 5px;">BIG BRAIN ‚Ä¢ FAST</p>
                </div>
                <div class="enemy-card">
                    <div style="font-size: 80px;">üëëü¶ñ</div>
                    <h3>MINI BOSS</h3>
                    <p style="color: #ffd700; font-size: 12px; margin-top: 5px;">EVERY 5 WAVES</p>
                </div>
            </div>

            <!-- Santa Skin Selector -->
            <div id="skin-selector">
                <h3>üéÖ SELECT YOUR SANTA üéÖ</h3>
                <div id="skin-options">
                    <!-- Skins populated by JavaScript -->
                </div>
                <div id="skin-coins-display">ü™ô <span id="skin-coins">0</span></div>
            </div>

            <!-- Deep Fried Mode Toggle -->
            <div id="deep-fried-toggle">
                <button id="deep-fried-btn" class="toggle-btn">
                    <span class="toggle-emoji">üçü</span>
                    <span class="toggle-text">DEEP FRIED MODE: OFF</span>
                </button>
                <p class="toggle-desc">Maximum meme saturation for true gamers</p>
            </div>

            <button id="start-btn" class="game-btn">üéÆ START GAME üéÆ</button>

            <div class="controls-info">
                <p>MOUSE - AIM CROSSHAIR</p>
                <p>CLICK or SPACEBAR - SHOOT</p>
                <p>E - USE HEALING POWER (10 KILLS TO CHARGE)</p>
                <p>R - OPEN SHOP (BETWEEN WAVES)</p>
            </div>
        </div>

        <!-- Shop Screen -->
        <div id="shop-screen">
            <h1>üíé THE GRINDSET EMPORIUM üíé</h1>
            <div id="shop-coins">ü™ô 0</div>

            <!-- Shopkeeper -->
            <div id="shopkeeper-container">
                <div id="shopkeeper-emoji">üóø</div>
                <div id="shopkeeper-dialogue">Welcome to the grind...</div>
            </div>

            <div class="shop-section">
                <h2>‚öîÔ∏è WEAPONS</h2>
                <div class="shop-items" id="weapons-list"></div>
            </div>

            <div class="shop-section">
                <h2>‚¨ÜÔ∏è UPGRADES</h2>
                <div class="shop-items" id="upgrades-list"></div>
            </div>

            <button id="continue-btn" class="game-btn green">CONTINUE ‚û°Ô∏è</button>
        </div>

        <!-- Minigame Screen -->
        <div id="minigame-screen">
            <h1>‚öîÔ∏è BOSS VULNERABLE! ‚öîÔ∏è</h1>
            <div id="minigame-instructions">CLICK THE TARGETS TO DAMAGE THE BOSS!</div>
            <div id="minigame-area"></div>
            <div id="minigame-timer">10</div>
            <div id="minigame-hits">HITS: 0 / DAMAGE: 0</div>
        </div>

        <!-- Game Over Screen - Meme Receipt Style -->
        <div id="game-over">
            <div id="death-receipt">
                <div class="receipt-header">
                    <h1>üíÄ SKILL ISSUE DETECTED üíÄ</h1>
                    <div class="receipt-subtitle">DINO DOOM - DEATH RECEIPT</div>
                </div>
                <div class="receipt-divider">‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê</div>
                <div class="receipt-stats">
                    <div class="receipt-row"><span>Waves Survived:</span><span id="stat-waves">0</span></div>
                    <div class="receipt-row"><span>Dinos Eliminated:</span><span id="stat-kills">0</span></div>
                    <div class="receipt-row"><span>Final Score:</span><span id="stat-score">0</span></div>
                    <div class="receipt-row"><span>Coins Earned:</span><span id="stat-coins">0</span></div>
                    <div class="receipt-row"><span>Time Survived:</span><span id="stat-time">0:00</span></div>
                    <div class="receipt-row"><span>Cause of Death:</span><span id="stat-cause">Unknown</span></div>
                </div>
                <div class="receipt-divider">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</div>
                <div class="receipt-rating">
                    <div class="rating-label">PERFORMANCE RATING:</div>
                    <div id="stat-rating" class="rating-value">NPC</div>
                </div>
                <div class="receipt-divider">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</div>
                <div class="receipt-lastwords">
                    <div class="lastwords-label">Last Words:</div>
                    <div id="stat-lastwords" class="lastwords-text">"skill issue"</div>
                </div>
                <div class="receipt-divider">‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê</div>
                <div class="receipt-buttons">
                    <button id="copy-receipt-btn" class="game-btn" style="font-size: 16px; padding: 10px 20px;">üìã SHARE YOUR L</button>
                    <button id="restart-btn" class="game-btn green">üîÑ TRY AGAIN</button>
                </div>
            </div>
        </div>
    </div>

    
    <script>(()=>{var r={PLAYER_MOVE_SPEED:5,PLAYER_BASE_DAMAGE:0,PLAYER_BASE_FIRE_RATE:10,PLAYER_BASE_CRIT_CHANCE:.05,PLAYER_CRIT_MULTIPLIER:2,PLAYER_BASE_HEALTH:100,WAVE_BETWEEN_HEAL_AMOUNT:20,BOSS_WAVE_INTERVAL:5,ENEMIES_BASE_COUNT:3,ENEMIES_PER_WAVE:2,ENEMY_SPAWN_DELAY_MS:500,HEAL_KILLS_REQUIRED:10,HEAL_AMOUNT:50,ENEMY_ATTACK_RANGE:120,ENEMY_MIN_Z:-80,ENEMY_MAX_X:500,PROJECTILE_HIT_RADIUS_BASE:60,PROJECTILE_GRAVITY:.05,BOSS_BASE_HEALTH:500,BOSS_HEALTH_PER_WAVE:50,BOSS_SHOOT_COOLDOWN:90,BOSS_FIREBALL_DAMAGE:5,BOSS_MINIGAME_THRESHOLD:.5,MINIGAME_DURATION_SEC:10,MINIGAME_TARGET_SPAWN_INTERVAL:400,MINIGAME_TARGET_LIFETIME:1500,MINIGAME_DAMAGE_PER_HIT:50,GAMER_RANGED_COOLDOWN:300,GAMER_PROJECTILE_DAMAGE:15,GAMER_PROJECTILE_SPEED:8,SIGMA_DIALOGUE_COOLDOWN_MIN:240,SIGMA_DIALOGUE_COOLDOWN_RANGE:120,SIGMA_ESCAPE_X:600,ENEMY_HEALTH_PER_WAVE:10,KILL_STREAK_TIMEOUT_MS:3e3,PERSPECTIVE_SCALE:400,PERSPECTIVE_MIN_Z:100,SIGMA_SPAWN_X:500,SIGMA_SPAWN_Z_BASE:-400,SIGMA_SPAWN_Z_RANGE:200,ENEMY_SPAWN_X_RANGE:800,ENEMY_SPAWN_Z_BASE:-800,ENEMY_SPAWN_Z_RANGE:500,DIALOGUE_BUBBLE_MAX:2,DIALOGUE_BUBBLE_DURATION:2e3,KILL_FEED_MAX_ENTRIES:5,KILL_FEED_DURATION_MS:3e3,ACHIEVEMENT_TOAST_DURATION_MS:3e3,COMBO_MULTIPLIER_PERCENT:10,WOMBO_COMBO_THRESHOLD:10},b={present:{name:"Present Launcher",emoji:"\u{1F381}",damage:35,fireRate:10,speed:20,color:"#ff0000",price:0,description:"Classic gift-giving weapon"},snowball:{name:"Snowball Blaster",emoji:"\u2744\uFE0F",damage:20,fireRate:5,speed:25,color:"#aaddff",price:500,description:"Rapid-fire frozen fury"},candy_cane:{name:"Candy Cane Rifle",emoji:"\u{1F36C}",damage:50,fireRate:20,speed:30,color:"#ff6699",price:1e3,description:"Sweet and powerful"},ornament:{name:"Ornament Grenade",emoji:"\u{1F52E}",damage:80,fireRate:40,speed:15,color:"#9900ff",price:2e3,description:"Explosive decorations"},star:{name:"North Star Beam",emoji:"\u2B50",damage:100,fireRate:30,speed:40,color:"#ffff00",price:5e3,description:"Ultimate guiding light"},moai:{name:"Moai Cannon",emoji:"\u{1F5FF}",damage:70,fireRate:25,speed:18,color:"#8b7355",price:1500,description:"Yo, Angelo",special:"moai"},doot:{name:"Doot Cannon",emoji:"\u{1F3BA}",damage:45,fireRate:15,speed:22,color:"#daa520",price:800,description:"Spooky scary skeletons",special:"doot"}},L={damage:{name:"Damage+",icon:"\u{1F4AA}",basePrice:200,maxLevel:10,perLevel:10,description:"+10 damage per level"},fireRate:{name:"Fire Rate+",icon:"\u26A1",basePrice:300,maxLevel:5,perLevel:2,description:"-2 cooldown per level"},health:{name:"Max Health+",icon:"\u2764\uFE0F",basePrice:250,maxLevel:10,perLevel:20,description:"+20 max HP per level"},critChance:{name:"Crit Chance+",icon:"\u{1F3AF}",basePrice:400,maxLevel:5,perLevel:.05,description:"+5% crit per level"}},ke={GIGACHAD:{name:"GIGACHAD DINO",emoji:"\u{1F996}",health:150,damage:25,speed:1.5,size:80,color:"#ff4444",points:200,coins:15,traits:["\u{1F4AA}","\u{1F60E}","\u{1F3CB}\uFE0F"]},BUFF_NERD:{name:"BUFF NERD DINO",emoji:"\u{1F995}",health:80,damage:15,speed:3,size:60,color:"#44ff88",points:100,coins:10,traits:["\u{1F913}","\u{1F4DA}","\u{1F9E0}"]},MINI_BOSS:{name:"DINO OVERLORD",emoji:"\u{1F451}",health:500,damage:10,speed:1,size:120,color:"#ffd700",points:1e3,coins:200,traits:["\u{1F451}","\u{1F480}","\u{1F525}"],isBoss:!0},GAMER_DINO:{name:"GAMER DINO",emoji:"\u{1F995}\u{1F3AE}",health:100,damage:20,speed:2.5,size:70,color:"#ff00ff",points:150,coins:12,traits:["\u{1F3AE}","\u2328\uFE0F","\u{1F5B1}\uFE0F"],isGamer:!0,deathMessages:["GG","EZ","GET GOOD","NO RE","GIT GUD","L + RATIO"]},SIGMA_DINO:{name:"SIGMA DINO",emoji:"\u{1F996}\u{1F454}",health:120,damage:0,speed:1,size:75,color:"#1a1a2e",points:300,coins:36,traits:["\u{1F454}","\u{1F4BC}","\u{1F4C8}"],isSigma:!0,deathMessages:["GRINDSET INTERRUPTED","PASSIVE INCOME STOPPED","SIGMA RULE VIOLATED","BACK TO THE MATRIX"]}},z={default:{name:"Default Santa",emoji:"\u{1F385}",price:0,color:"#ff0000",glowColor:"#ff4444",description:"Classic Santa"},drip:{name:"Drip Santa",emoji:"\u{1F385}\u{1F48E}",price:500,color:"#00ffff",glowColor:"#00ffff",description:"Iced out"},tactical:{name:"Tactical Santa",emoji:"\u{1F385}\u{1F3AF}",price:1e3,color:"#556b2f",glowColor:"#6b8e23",description:"Operator mode"},gigachad:{name:"Gigachad Santa",emoji:"\u{1F385}\u{1F4AA}",price:2500,color:"#ffd700",glowColor:"#ffaa00",description:"Built different"},sigma:{name:"Sigma Santa",emoji:"\u{1F385}\u{1F454}",price:5e3,color:"#1a1a2e",glowColor:"#4a4a6e",description:"On the grind"}},Be={FIRST_BLOOD:{id:"first_blood",name:"FIRST BLOOD",description:"First kill of the game",icon:"\u{1FA78}"},WAVE_SURVIVOR:{id:"wave_survivor",name:"WAVE SURVIVOR",description:"Complete a wave without damage",icon:"\u{1F6E1}\uFE0F"},BUILT_DIFFERENT:{id:"built_different",name:"BUILT DIFFERENT",description:"One-shot a Gigachad",icon:"\u{1F4AA}"},SKILL_ISSUE:{id:"skill_issue",name:"SKILL ISSUE",description:"Die on Wave 1",icon:"\u{1F480}"},EASY_MODE:{id:"easy_mode",name:"IS THIS EASY MODE?",description:"Reach Wave 10 without taking damage",icon:"\u{1F60E}"},BIG_SPENDER:{id:"big_spender",name:"BIG SPENDER",description:"Spend 1000 coins in one shop visit",icon:"\u{1F4B0}"},BOSS_SLAYER:{id:"boss_slayer",name:"BOSS SLAYER",description:"Defeat your first boss",icon:"\u{1F451}"},MEME_LORD:{id:"meme_lord",name:"MEME LORD",description:"Use the Moai Cannon",icon:"\u{1F5FF}"}},Ne=[{count:2,name:"DOUBLE KILL",color:"#ffff00"},{count:3,name:"TRIPLE KILL",color:"#ff8800"},{count:4,name:"OVERKILL",color:"#ff4400"},{count:5,name:"KILLTACULAR",color:"#ff00ff"},{count:6,name:"KILLIONAIRE",color:"#00ffff"},{count:7,name:"KILLPOCALYPSE",color:"#ff0000"},{count:10,name:"UNSTOPPABLE",color:"#ffd700"}],ee=[{minScore:0,rating:"Actual NPC",color:"#888888"},{minScore:1e3,rating:"Kinda Mid",color:"#888888"},{minScore:5e3,rating:"Certified Decent",color:"#00ff00"},{minScore:1e4,rating:"Built Different",color:"#00ffff"},{minScore:25e3,rating:"Sigma Energy",color:"#ff00ff"},{minScore:5e4,rating:"GIGACHAD",color:"#ffd700"}],te=['"skill issue"','"I was lagging"','"my mouse died"','"not my fault"','"rigged game"','"built different (negatively)"','"I let them win"','"calculated L"','"gg ez... wait"','"I blame the dinosaurs"','"Santa needed a break"','"tactical defeat"','"we go next"','"ratio"','"at least I tried"'],Y={5:{name:"CHADOSAURUS",title:"Never Skips Leg Day",emoji:"\u{1F996}\u{1F4AA}"},10:{name:"PROFESSOR GAINS",title:"PhD in Lifting",emoji:"\u{1F996}\u{1F393}"},15:{name:"THE RATIO KING",title:"Undefeated in Arguments",emoji:"\u{1F996}\u{1F451}"},20:{name:"ZYZZ-REX",title:"Forever Mirin'",emoji:"\u{1F996}\u2728"},25:{name:"FINAL FORM CHAD",title:"We're All Gonna Make It",emoji:"\u{1F996}\u{1F525}"}},De={GIGACHAD:{spawn:["DO YOU EVEN LIFT, SANTA?","THESE GAINS ARE ETERNAL","MY PROTEIN SHAKE BRINGS ALL THE BOYS","CREATINE-POWERED DESTRUCTION","I'M BUILT DIFFERENT","WITNESS PEAK PERFORMANCE"],attack:["FEEL MY POWER!","GAINS INCOMING!","GET SWOLE'D!","NO PAIN NO GAIN!"]},BUFF_NERD:{spawn:["ACTUALLY...","SKILL ISSUE DETECTED","RATIO + L + NO REINDEER","MY IQ IS OVER 9000","STATISTICALLY, YOU LOSE","I STUDIED THE BLADE"],attack:["CALCULATED!","ACCORDING TO MY DATA...","NERD RAGE!","BRAIN DAMAGE!"]},MINI_BOSS:{spawn:["YOU DARE CHALLENGE ME?!","I'VE BEEN LIFTING SINCE THE JURASSIC","WITNESS TRUE POWER!","YOUR PRESENTS ARE WEAK!","PREPARE TO BE RATIO'D!"],attack:["FEEL MY WRATH!","PATHETIC!","IS THAT ALL?!","BOW BEFORE ME!"]},GAMER_DINO:{spawn:["GAMING TIME! \u{1F3AE}","PRESS F TO PAY RESPECTS","I HAVE RGB EVERYTHING","MY SETUP COST MORE THAN YOUR SLEIGH","TWITCH DROPS INCOMING","SPONSORED BY G-FUEL"],attack:["360 NO SCOPE!","GET REKT NOOB!","HEADSHOT!","SKILL DIFF!"]},SIGMA_DINO:{spawn:["No time for distractions \u{1F454}","I walk my own path","SIGMA RULE #1: Stay on the grind","High value target passing through","The grindset continues...","No one can stop me"],attack:["I don't fight, I profit","Violence is for betas"]}},ie=["On my grind...","Sigma Rule #1: Never chase","Sigma Rule #47: Walk away","Passive income only","I AM the high value target","Built for the grind","Money moves only","No time for fights","Self-improvement arc","I go where I want"],$={rich:["Ah, a person of wealth and taste! \u{1F4B0}","Your grindset is immaculate, my friend.","Now THIS is passive income energy!","I see the market has been good to you.","A fellow high-value individual!"],broke:["Broke? Sounds like a skill issue...","No cap, you need to grind harder.","Have you tried having more money?","The sigma grindset is NOT strong here.","Maybe try dodging more? Just a thought."],normal:["These prices are bussin' fr fr","Buy something or get out of my emporium","No cap, these weapons slap","Welcome to the grind, traveler","Everything here is certified fire \u{1F525}","The moai approves of your presence \u{1F5FF}","I was once like you... before the gains"],purchase:["STONKS! \u{1F4C8}","A wise investment!","That one's fire, no cap","Based purchase","You understand the grind"]},oe=["Sigma escaped! Skill issue...","Sigma got away! Should've grinded harder","The Sigma walks free. L.","Couldn't stop the grindset!"];var{PERSPECTIVE_SCALE:ne,PERSPECTIVE_MIN_Z:ae}=r,K=class{constructor(e,i,o,a){this.x=e,this.y=i,this.z=o,this.vx=(Math.random()-.5)*10,this.vy=(Math.random()-.5)*10-5,this.vz=(Math.random()-.5)*10,this.color=a,this.life=30,this.maxLife=30}update(){this.x+=this.vx,this.y+=this.vy,this.z+=this.vz,this.vy+=.3,this.life--}draw(e,i,o){let a=i.width/2+this.x*(ne/Math.max(ae,-this.z)),l=i.height/2+(this.y+100)*(ne/Math.max(ae,-this.z)),c=ne/Math.max(ae,-this.z),m=this.life/this.maxLife;-this.z<10||(e.globalAlpha=m,e.fillStyle=this.color,e.beginPath(),e.arc(a,l,5*c,0,Math.PI*2),e.fill(),e.globalAlpha=1)}isExpired(){return this.life<=0}reset(e,i,o,a){this.x=e,this.y=i,this.z=o,this.vx=(Math.random()-.5)*10,this.vy=(Math.random()-.5)*10-5,this.vz=(Math.random()-.5)*10,this.color=a,this.life=30,this.maxLife=30}};var n={running:!1,paused:!1,score:0,coins:0,kills:0,wave:1,health:r.PLAYER_BASE_HEALTH,maxHealth:r.PLAYER_BASE_HEALTH,waveInProgress:!1,betweenWaves:!1,bossActive:!1,currentBoss:null,healKills:0,healReady:!1,healKillsRequired:r.HEAL_KILLS_REQUIRED,startTime:0,lastAttacker:"Unknown",totalCoinsEarned:0},h={x:0,y:0,angle:0,moveSpeed:r.PLAYER_MOVE_SPEED,damage:r.PLAYER_BASE_DAMAGE,fireRate:r.PLAYER_BASE_FIRE_RATE,fireCooldown:0,critChance:r.PLAYER_BASE_CRIT_CHANCE,critMultiplier:r.PLAYER_CRIT_MULTIPLIER,damageBonus:0,fireRateBonus:0},f={currentWeapon:"present",weapons:{present:!0,snowball:!1,candy_cane:!1,ornament:!1,star:!1,moai:!1,doot:!1},upgrades:{damage:0,fireRate:0,health:0,critChance:0}},y=[],G=[],w=[],O=[],u=[],se=[],Jt=200,I={x:window.innerWidth/2,y:window.innerHeight/2},re=[],x={count:0,lastKillTime:0,streakTimeout:r.KILL_STREAK_TIMEOUT_MS},S={count:0,showWomboCombo:!1},v=[],j=new Set,T={waveStartHealth:r.PLAYER_BASE_HEALTH,totalDamageTaken:0,shopSpending:0},d={active:!1,hits:0,timeLeft:r.MINIGAME_DURATION_SEC,interval:null,targetInterval:null},g={selected:"default",owned:["default"],totalCoins:0},M={intensity:0,duration:0,startTime:0,active:!1},_={enabled:!1,lensFlares:[]};function Pe(){n.running=!0,n.paused=!1,n.score=0,n.coins=0,n.kills=0,n.wave=1,n.health=r.PLAYER_BASE_HEALTH,n.maxHealth=r.PLAYER_BASE_HEALTH,n.waveInProgress=!1,n.betweenWaves=!1,n.bossActive=!1,n.currentBoss=null,n.healKills=0,n.healReady=!1,n.healKillsRequired=r.HEAL_KILLS_REQUIRED,n.startTime=Date.now(),n.lastAttacker="Unknown",n.totalCoinsEarned=0}function Ge(){h.x=0,h.y=0,h.angle=0,h.moveSpeed=r.PLAYER_MOVE_SPEED,h.damage=r.PLAYER_BASE_DAMAGE,h.fireRate=r.PLAYER_BASE_FIRE_RATE,h.fireCooldown=0,h.critChance=r.PLAYER_BASE_CRIT_CHANCE,h.critMultiplier=r.PLAYER_CRIT_MULTIPLIER,h.damageBonus=0,h.fireRateBonus=0}function He(){f.currentWeapon="present",f.weapons={present:!0,snowball:!1,candy_cane:!1,ornament:!1,star:!1,moai:!1,doot:!1},f.upgrades={damage:0,fireRate:0,health:0,critChance:0}}function Ve(){y.length=0,G.length=0,w.length=0,O.length=0,u.length=0}function We(){re.forEach(clearTimeout),re.length=0}function ze(){x.count=0,x.lastKillTime=0}function Fe(){S.count=0,S.showWomboCombo=!1}function Ue(){v.length=0}function Ye(){j.clear(),T.waveStartHealth=r.PLAYER_BASE_HEALTH,T.totalDamageTaken=0,T.shopSpending=0}function $e(){d.interval&&clearInterval(d.interval),d.targetInterval&&clearInterval(d.targetInterval),d.active=!1,d.hits=0,d.timeLeft=r.MINIGAME_DURATION_SEC,d.interval=null,d.targetInterval=null}function Ke(t,e){I.x=t,I.y=e}function C(t){re.push(t)}function je(){try{let t=localStorage.getItem("santaSkinState");if(t){let e=JSON.parse(t);g.selected=e.selected||"default",g.owned=e.owned||["default"],g.totalCoins=e.totalCoins||0}}catch(t){console.error("Failed to access localStorage:",t)}}function F(){try{localStorage.setItem("santaSkinState",JSON.stringify(g))}catch(t){console.error("Failed to save skin state:",t)}}function qe(){try{let t=localStorage.getItem("deepFriedMode");t!==null&&(_.enabled=JSON.parse(t))}catch{}}function Qt(){try{localStorage.setItem("deepFriedMode",JSON.stringify(_.enabled))}catch{}}function Xe(){return _.enabled=!_.enabled,Qt(),_.enabled}function Ze(){_.lensFlares.length=0}function Je(t,e){let i=["\u{1F4A5}","\u2728","\u{1F525}","\u{1F4AF}","\u{1F44C}","\u{1F602}","\u{1F171}\uFE0F","\u{1F480}"];_.lensFlares.push({x:t,y:e,emoji:i[Math.floor(Math.random()*i.length)],life:60,scale:1+Math.random()*.5,rotation:Math.random()*Math.PI*2})}function le(t,e,i,o){let a=se.pop();return a?a.reset(t,e,i,o):a=new K(t,e,i,o),a}function Qe(t){se.length<Jt&&se.push(t)}var ei=window.AudioContext||window.webkitAudioContext,s=null;function et(){s||(s=new ei),s.state==="suspended"&&s.resume()}function p(t){if(s)try{let e=s.createOscillator(),i=s.createGain();switch(e.connect(i),i.connect(s.destination),t){case"shoot":e.frequency.setValueAtTime(200,s.currentTime),e.frequency.exponentialRampToValueAtTime(50,s.currentTime+.1),i.gain.setValueAtTime(.3,s.currentTime),i.gain.exponentialRampToValueAtTime(.01,s.currentTime+.1),e.start(),e.stop(s.currentTime+.1);break;case"hit":e.frequency.setValueAtTime(400,s.currentTime),e.frequency.exponentialRampToValueAtTime(100,s.currentTime+.15),i.gain.setValueAtTime(.2,s.currentTime),i.gain.exponentialRampToValueAtTime(.01,s.currentTime+.15),e.start(),e.stop(s.currentTime+.15);break;case"kill":e.type="square",e.frequency.setValueAtTime(600,s.currentTime),e.frequency.exponentialRampToValueAtTime(1200,s.currentTime+.1),i.gain.setValueAtTime(.15,s.currentTime),i.gain.exponentialRampToValueAtTime(.01,s.currentTime+.2),e.start(),e.stop(s.currentTime+.2);break;case"damage":e.type="sawtooth",e.frequency.setValueAtTime(100,s.currentTime),e.frequency.exponentialRampToValueAtTime(50,s.currentTime+.2),i.gain.setValueAtTime(.3,s.currentTime),i.gain.exponentialRampToValueAtTime(.01,s.currentTime+.2),e.start(),e.stop(s.currentTime+.2);break;case"buy":e.type="sine",e.frequency.setValueAtTime(800,s.currentTime),e.frequency.setValueAtTime(1e3,s.currentTime+.1),e.frequency.setValueAtTime(1200,s.currentTime+.2),i.gain.setValueAtTime(.2,s.currentTime),i.gain.exponentialRampToValueAtTime(.01,s.currentTime+.3),e.start(),e.stop(s.currentTime+.3);break;case"minigame_hit":e.type="sine",e.frequency.setValueAtTime(1e3,s.currentTime),i.gain.setValueAtTime(.2,s.currentTime),i.gain.exponentialRampToValueAtTime(.01,s.currentTime+.1),e.start(),e.stop(s.currentTime+.1);break;case"boss":e.type="sawtooth",e.frequency.setValueAtTime(100,s.currentTime),e.frequency.linearRampToValueAtTime(50,s.currentTime+.5),i.gain.setValueAtTime(.3,s.currentTime),i.gain.linearRampToValueAtTime(.01,s.currentTime+.5),e.start(),e.stop(s.currentTime+.5);break;case"moai":e.type="sine",e.frequency.setValueAtTime(150,s.currentTime),e.frequency.exponentialRampToValueAtTime(50,s.currentTime+.3),i.gain.setValueAtTime(.4,s.currentTime),i.gain.exponentialRampToValueAtTime(.01,s.currentTime+.3),e.start(),e.stop(s.currentTime+.3);break;case"doot":e.type="sawtooth",e.frequency.setValueAtTime(392,s.currentTime),e.frequency.setValueAtTime(349,s.currentTime+.1),i.gain.setValueAtTime(.25,s.currentTime),i.gain.exponentialRampToValueAtTime(.01,s.currentTime+.2),e.start(),e.stop(s.currentTime+.2);break;case"doot_kill":e.type="square",e.frequency.setValueAtTime(523,s.currentTime),e.frequency.setValueAtTime(659,s.currentTime+.1),e.frequency.setValueAtTime(784,s.currentTime+.2),i.gain.setValueAtTime(.2,s.currentTime),i.gain.exponentialRampToValueAtTime(.01,s.currentTime+.35),e.start(),e.stop(s.currentTime+.35);break;case"achievement":e.type="sine",e.frequency.setValueAtTime(523,s.currentTime),e.frequency.setValueAtTime(659,s.currentTime+.1),e.frequency.setValueAtTime(784,s.currentTime+.2),e.frequency.setValueAtTime(1047,s.currentTime+.3),i.gain.setValueAtTime(.25,s.currentTime),i.gain.exponentialRampToValueAtTime(.01,s.currentTime+.5),e.start(),e.stop(s.currentTime+.5);break;case"gamer_attack":e.type="sawtooth",e.frequency.setValueAtTime(200,s.currentTime),e.frequency.exponentialRampToValueAtTime(800,s.currentTime+.1),e.frequency.exponentialRampToValueAtTime(200,s.currentTime+.2),i.gain.setValueAtTime(.2,s.currentTime),i.gain.exponentialRampToValueAtTime(.01,s.currentTime+.25),e.start(),e.stop(s.currentTime+.25);break;case"heal":e.type="sine",e.frequency.setValueAtTime(400,s.currentTime),e.frequency.linearRampToValueAtTime(800,s.currentTime+.2),e.frequency.linearRampToValueAtTime(600,s.currentTime+.4),i.gain.setValueAtTime(.2,s.currentTime),i.gain.linearRampToValueAtTime(.01,s.currentTime+.4),e.start(),e.stop(s.currentTime+.4);break}}catch{}}function tt(t=!1){if(s)try{let e=s.createOscillator(),i=s.createGain();e.connect(i),i.connect(s.destination),t?(e.type="sine",e.frequency.setValueAtTime(1200,s.currentTime),e.frequency.setValueAtTime(1600,s.currentTime+.05),i.gain.setValueAtTime(.25,s.currentTime),i.gain.exponentialRampToValueAtTime(.01,s.currentTime+.15),e.start(),e.stop(s.currentTime+.15)):(e.type="square",e.frequency.setValueAtTime(800,s.currentTime),i.gain.setValueAtTime(.15,s.currentTime),i.gain.exponentialRampToValueAtTime(.01,s.currentTime+.05),e.start(),e.stop(s.currentTime+.05))}catch{}}function it(t){if(s)try{let e=s.createOscillator(),i=s.createGain();e.connect(i),i.connect(s.destination);let o=400+t*100;e.type="square",e.frequency.setValueAtTime(o,s.currentTime),e.frequency.setValueAtTime(o*1.5,s.currentTime+.1),e.frequency.setValueAtTime(o*2,s.currentTime+.2),i.gain.setValueAtTime(.2,s.currentTime),i.gain.exponentialRampToValueAtTime(.01,s.currentTime+.4),e.start(),e.stop(s.currentTime+.4)}catch{}}function ot(){return z[g.selected]||z.default}function ti(t){let e=z[t];return!e||g.owned.includes(t)||g.totalCoins<e.price?!1:(g.totalCoins-=e.price,g.owned.push(t),g.selected=t,F(),p("buy"),!0)}function ii(t){return g.owned.includes(t)?(g.selected=t,F(),!0):!1}function ce(){let t=document.getElementById("skin-options");t.innerHTML="";for(let[e,i]of Object.entries(z)){let o=g.owned.includes(e),a=g.selected===e,l=g.totalCoins>=i.price,c=document.createElement("div");c.className=`skin-option ${a?"selected":""} ${o?"":"locked"}`,c.innerHTML=`
            <div class="skin-emoji">${i.emoji}</div>
            <div class="skin-name">${i.name}</div>
            <div class="skin-price ${o?"owned":""}">${o?"\u2713 OWNED":`\u{1FA99} ${i.price}`}</div>
        `,c.onclick=()=>{o?(ii(e),ce()):l&&(ti(e),ce())},t.appendChild(c)}document.getElementById("skin-coins").textContent=g.totalCoins}function nt(){je(),ce()}function at(t){let e=ee[0];for(let i of ee)t>=i.minScore&&(e=i);return e}function oi(){return te[Math.floor(Math.random()*te.length)]}function st(t){let e=Math.floor(t/1e3),i=Math.floor(e/60),o=e%60;return`${i}:${o.toString().padStart(2,"0")}`}function rt(){let t=Date.now()-n.startTime,e=at(n.score);document.getElementById("stat-waves").textContent=n.wave,document.getElementById("stat-kills").textContent=n.kills,document.getElementById("stat-score").textContent=n.score.toLocaleString(),document.getElementById("stat-coins").textContent=n.totalCoinsEarned,document.getElementById("stat-time").textContent=st(t),document.getElementById("stat-cause").textContent=n.lastAttacker;let i=document.getElementById("stat-rating");i.textContent=e.rating,i.style.color=e.color,i.style.textShadow=`0 0 15px ${e.color}`,document.getElementById("stat-lastwords").textContent=oi()}function lt(){let t=Date.now()-n.startTime,e=at(n.score),i=`
\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557
\u2551   \u{1F480} SKILL ISSUE DETECTED \u{1F480}      \u2551
\u2551      DINO DOOM - DEATH RECEIPT   \u2551
\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563
\u2551 Waves Survived:    ${String(n.wave).padStart(14)} \u2551
\u2551 Dinos Eliminated:  ${String(n.kills).padStart(14)} \u2551
\u2551 Final Score:       ${String(n.score.toLocaleString()).padStart(14)} \u2551
\u2551 Coins Earned:      ${String(n.totalCoinsEarned).padStart(14)} \u2551
\u2551 Time Survived:     ${st(t).padStart(14)} \u2551
\u2551 Cause of Death:    ${n.lastAttacker.padStart(14)} \u2551
\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563
\u2551 Rating: ${e.rating.padEnd(24)} \u2551
\u255A\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255D
\u{1F996} DINO DOOM: Santa's Last Stand \u{1F385}
    `.trim();navigator.clipboard.writeText(i).then(()=>{let o=document.getElementById("copy-receipt-btn");o.textContent="\u2713 COPIED!",setTimeout(()=>o.textContent="\u{1F4CB} SHARE YOUR L",2e3)})}function ct(){qe();let t=document.getElementById("deep-fried-btn");t&&(t.addEventListener("click",ni),mt()),ht()}function ni(){Xe(),mt(),ht()}function mt(){let t=document.getElementById("deep-fried-btn"),e=t?.querySelector(".toggle-text");!t||!e||(_.enabled?(t.classList.add("active"),e.textContent="DEEP FRIED MODE: ON"):(t.classList.remove("active"),e.textContent="DEEP FRIED MODE: OFF"))}function ht(){let t=document.getElementById("game-container");t&&(_.enabled?t.classList.add("deep-fried"):(t.classList.remove("deep-fried"),Ze(),si()))}function ai(t,e){if(!_.enabled)return;Je(t,e);let i=document.getElementById("lens-flare-container");if(!i)return;let o=["\u{1F4A5}","\u2728","\u{1F525}","\u{1F4AF}","\u{1F44C}","\u{1F602}","\u{1F171}\uFE0F","\u{1F480}"],a=o[Math.floor(Math.random()*o.length)],l=document.createElement("div");l.className="lens-flare",l.textContent=a,l.style.left=t+"px",l.style.top=e+"px",i.appendChild(l),setTimeout(()=>{l.remove()},1e3)}function si(){let t=document.getElementById("lens-flare-container");t&&(t.innerHTML="")}function dt(t){return function(a,l){if(!_.enabled)return;let c=200/Math.max(100,-l),m=t.width/2+a*c,E=t.height/2+100*c;ai(m,E)}}var{PERSPECTIVE_SCALE:me,PERSPECTIVE_MIN_Z:he}=r,q=class{constructor(e,i,o,a){this.x=e,this.y=i,this.z=o,this.vx=(Math.random()-.5)*3,this.vy=0,this.vz=15,this.damage=a,this.life=120,this.emoji="\u{1F525}",this.color="#ff4400",this.attackerName="Boss Fireball"}update(){this.x+=this.vx,this.y+=this.vy,this.z+=this.vz,this.life--}checkPlayerCollision(e){return this.z>-50&&Math.abs(this.x-e.x)<80?(this.life=0,!0):!1}draw(e,i){if(this.z>0||-this.z>2e3)return;let o=i.width/2+this.x*(me/Math.max(he,-this.z)),a=i.height/2+(this.y+100)*(me/Math.max(he,-this.z)),l=me/Math.max(he,-this.z);e.shadowColor=this.color,e.shadowBlur=25,e.font=`${35*l}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(this.emoji,o,a),e.shadowBlur=0}isExpired(){return this.life<=0}};var{PERSPECTIVE_SCALE:de,PERSPECTIVE_MIN_Z:fe}=r,X=class{constructor(e,i,o,a){this.x=e,this.y=i,this.z=o,this.vx=(Math.random()-.5)*2,this.vy=0,this.vz=8,this.damage=a,this.life=180,this.emoji="\u{1F3AF}",this.color="#ff00ff",this.spin=0,this.attackerName="360 NO SCOPE"}update(){this.x+=this.vx,this.y+=this.vy,this.z+=this.vz,this.spin+=.15,this.life--;let e=Math.sin(this.spin)*127+128,i=Math.sin(this.spin+2.094)*127+128,o=Math.sin(this.spin+4.189)*127+128;this.color=`rgb(${Math.floor(e)}, ${Math.floor(i)}, ${Math.floor(o)})`}checkPlayerCollision(e){return this.z>-50&&Math.abs(this.x-e.x)<80?(this.life=0,!0):!1}draw(e,i){if(this.z>0||-this.z>2e3)return;let o=i.width/2+this.x*(de/Math.max(fe,-this.z)),a=i.height/2+(this.y+100)*(de/Math.max(fe,-this.z)),l=de/Math.max(fe,-this.z);e.save(),e.translate(o,a),e.rotate(this.spin),e.shadowColor=this.color,e.shadowBlur=30,e.font=`${40*l}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(this.emoji,0,0),e.shadowBlur=0,e.restore()}isExpired(){return this.life<=0}};var{PERSPECTIVE_SCALE:ue,PERSPECTIVE_MIN_Z:pe}=r,N=class{constructor(e,i,o,a={}){let l=ke[e];this.type=e,this.name=l.name,this.emoji=l.emoji,this.health=l.health+n.wave*r.ENEMY_HEALTH_PER_WAVE,this.maxHealth=this.health,this.damage=l.damage,this.speed=l.speed,this.size=l.size,this.color=l.color,this.points=l.points,this.coins=l.coins,this.traits=l.traits,this.isBoss=l.isBoss||!1,this.x=i,this.y=0,this.z=o,this.wobble=0,this.attackCooldown=0,this.hitFlash=0,this.invulnerable=!1,this.hitCount=0,this.wasOneShot=!0,this.markedForRemoval=!1,this.callbacks=a,this.isGamer=l.isGamer||!1,this.deathMessages=l.deathMessages||null,this.isGamer&&(this.rgbPhase=Math.random()*Math.PI*2,this.rangedCooldown=r.GAMER_RANGED_COOLDOWN,this.shootCooldown=0),this.isSigma=l.isSigma||!1,this.isSigma&&(this.sigmaDirection=i>0?-1:1,this.sigmaPhase=0,this.sigmaDialogueCooldown=180,this.hasEscaped=!1),this.isBoss&&(this.shootCooldown=0)}update(){if(this.invulnerable)return;if(this.isSigma){this.updateSigma();return}let e=h.x-this.x,i=-this.z,o=Math.sqrt(e*e+i*i);o>50&&(this.x+=e/o*this.speed,this.z+=i/o*this.speed),this.z>r.ENEMY_MIN_Z&&(this.z=r.ENEMY_MIN_Z),this.x=Math.max(-r.ENEMY_MAX_X,Math.min(r.ENEMY_MAX_X,this.x)),this.isBoss&&!this.invulnerable&&this.updateBossShooting(),this.isGamer&&this.updateGamer(),Math.sqrt(e*e+this.z*this.z)<r.ENEMY_ATTACK_RANGE&&this.z<-50&&this.attackCooldown<=0&&(this.attack(),this.attackCooldown=60),this.wobble+=.1,this.attackCooldown--,this.hitFlash=Math.max(0,this.hitFlash-.1)}updateSigma(){this.x+=this.sigmaDirection*this.speed,this.z<-200&&(this.z+=.5),this.sigmaPhase+=.05;let e=Math.sin(this.sigmaPhase)*30+100;if(this.color=`rgb(${e+50}, ${e+30}, ${Math.floor(e*.3)})`,this.sigmaDialogueCooldown--,this.sigmaDialogueCooldown<=0&&this.callbacks.showSigmaDialogue&&(this.callbacks.showSigmaDialogue(this),this.sigmaDialogueCooldown=r.SIGMA_DIALOGUE_COOLDOWN_MIN+Math.random()*r.SIGMA_DIALOGUE_COOLDOWN_RANGE),Math.abs(this.x)>r.SIGMA_ESCAPE_X&&!this.hasEscaped){this.hasEscaped=!0,this.callbacks.showSigmaEscapeText&&this.callbacks.showSigmaEscapeText(),this.health=0;return}this.wobble+=.05,this.hitFlash=Math.max(0,this.hitFlash-.1)}updateBossShooting(){this.shootCooldown||(this.shootCooldown=0),this.shootCooldown--,this.shootCooldown<=0&&(w.push(new q(this.x,this.y,this.z,r.BOSS_FIREBALL_DAMAGE)),this.shootCooldown=r.BOSS_SHOOT_COOLDOWN)}updateGamer(){this.rgbPhase+=.1;let e=Math.sin(this.rgbPhase)*127+128,i=Math.sin(this.rgbPhase+2.094)*127+128,o=Math.sin(this.rgbPhase+4.189)*127+128;this.color=`rgb(${Math.floor(e)}, ${Math.floor(i)}, ${Math.floor(o)})`,this.rangedCooldown--,this.rangedCooldown<=0&&(this.callbacks.showGamerAttackText&&this.callbacks.showGamerAttackText(this.x,this.y,this.z),this.callbacks.playSound&&this.callbacks.playSound("gamer_attack"),w.push(new X(this.x,this.y,this.z,r.GAMER_PROJECTILE_DAMAGE)),this.rangedCooldown=r.GAMER_RANGED_COOLDOWN)}attack(){n.health-=this.damage,n.lastAttacker=this.name,T.totalDamageTaken+=this.damage,this.callbacks.playSound&&this.callbacks.playSound("damage"),this.callbacks.showDamageOverlay&&this.callbacks.showDamageOverlay(),this.callbacks.shakeOnDamage&&this.callbacks.shakeOnDamage(),this.callbacks.showEnemyDialogue&&this.callbacks.showEnemyDialogue(this,"attack"),this.callbacks.breakCombo&&this.callbacks.breakCombo(),n.health<=0&&this.callbacks.gameOver&&this.callbacks.gameOver(),this.callbacks.updateHUD&&this.callbacks.updateHUD()}takeDamage(e){if(this.invulnerable)return!1;this.hitCount++,this.hitCount>1&&(this.wasOneShot=!1);let i=e,o=Math.random()<h.critChance;o&&(i*=h.critMultiplier,this.callbacks.shakeOnCrit&&this.callbacks.shakeOnCrit()),this.health-=i,this.hitFlash=1,this.callbacks.playSound&&this.callbacks.playSound("hit"),this.callbacks.showHitMarker&&this.callbacks.showHitMarker(o);for(let a=0;a<5;a++)O.push(le(this.x,this.y,this.z,this.color));if(u.push({text:o?`CRIT ${Math.floor(i)}!`:`-${Math.floor(i)}`,x:this.x+(Math.random()-.5)*30,y:this.y-30,z:this.z,life:40,color:o?"#ff00ff":"#ffffff"}),this.isBoss){let a=document.getElementById("boss-health-bar");a&&(a.style.width=`${Math.max(0,this.health/this.maxHealth*100)}%`);let l=this.health/this.maxHealth;l<=r.BOSS_MINIGAME_THRESHOLD&&l>r.BOSS_MINIGAME_THRESHOLD-.03&&this.callbacks.startMinigame&&this.callbacks.startMinigame()}return this.health<=0?(this.die(),!0):!1}die(){if(this.isSigma&&this.hasEscaped)return;this.callbacks.incrementCombo&&this.callbacks.incrementCombo();let e=this.callbacks.getComboBonus?this.callbacks.getComboBonus(this.points):0;n.score+=this.points+e,n.coins+=this.coins,n.totalCoinsEarned+=this.coins,g.totalCoins+=this.coins,F(),n.kills++,this.callbacks.recordKill&&this.callbacks.recordKill(),this.callbacks.checkAchievements&&this.callbacks.checkAchievements(this),n.healReady||(n.healKills++,n.healKills>=n.healKillsRequired&&(n.healReady=!0)),this.callbacks.playSound&&this.callbacks.playSound("kill"),this.isBoss&&this.callbacks.shakeOnBossDeath?this.callbacks.shakeOnBossDeath():this.callbacks.shakeOnKill&&this.callbacks.shakeOnKill();for(let o=0;o<20;o++)O.push(le(this.x,this.y,this.z,this.color));let i=e>0?`+${this.points+e} (\u{1F525}+${e})`:`+${this.points}`;if(u.push({text:i,x:this.x,y:this.y-50,z:this.z,life:60,color:e>0?"#ff00ff":"#ffcc00"}),u.push({text:`\u{1FA99}+${this.coins}`,x:this.x+30,y:this.y-70,z:this.z,life:60,color:"#ffd700"}),this.deathMessages&&this.deathMessages.length>0){let o=this.deathMessages[Math.floor(Math.random()*this.deathMessages.length)];u.push({text:o,x:this.x,y:this.y-100,z:this.z,life:90,color:"#00ff00"})}if(this.isBoss){let o=document.getElementById("boss-health-container");o&&(o.style.display="none"),n.bossActive=!1,n.currentBoss=null}this.callbacks.addKillFeed&&this.callbacks.addKillFeed(this.name),this.callbacks.updateHUD&&this.callbacks.updateHUD(),this.callbacks.spawnLensFlare&&this.callbacks.spawnLensFlare(this.x,this.z)}draw(e,i){let o=i.width/2+(this.x-h.x)*(ue/Math.max(pe,-this.z)),a=i.height/2+100*(ue/Math.max(pe,-this.z)),l=ue/Math.max(pe,-this.z),c=this.size*l;if(-this.z<50||-this.z>2e3)return;e.fillStyle="rgba(0,0,0,0.3)",e.beginPath(),e.ellipse(o,a+c*.4,c*.5,c*.2,0,0,Math.PI*2),e.fill();let m=Math.sin(this.wobble)*5;e.shadowColor=this.color,e.shadowBlur=this.hitFlash>0?30:15,e.fillStyle=this.hitFlash>0?"#ffffff":this.color,e.beginPath(),e.ellipse(o,a-c*.3+m,c*.4,c*.5,0,0,Math.PI*2),e.fill(),e.shadowBlur=0,e.font=`${c*.8}px Arial`,e.textAlign="center",e.textBaseline="middle",this.isBoss?(e.fillText(this.traits[0],o,a-c*.5+m),e.fillText("\u{1F996}",o,a-c*.1+m)):e.fillText(this.emoji,o,a-c*.3+m);let E=Math.floor(Date.now()/500)%this.traits.length;if(e.font=`${c*.3}px Arial`,e.fillText(this.traits[E],o+c*.4,a-c*.6),!this.isBoss){let D=c*.8,U=8,V=this.health/this.maxHealth;e.fillStyle="#333",e.fillRect(o-D/2,a-c-20,D,U),e.fillStyle=V>.5?"#00ff00":V>.25?"#ffff00":"#ff0000",e.fillRect(o-D/2,a-c-20,D*V,U)}e.font="bold 12px Orbitron",e.fillStyle=this.isBoss?"#ffd700":"#fff",e.fillText(this.name,o,a-c-35),this.invulnerable&&(e.font="bold 16px Orbitron",e.fillStyle="#ff0000",e.fillText("INVULNERABLE",o,a-c-55))}};var{PERSPECTIVE_SCALE:Ee,PERSPECTIVE_MIN_Z:ge}=r,H=class{constructor(e,i,o,a,l,c){this.x=e,this.y=i,this.z=o,this.vx=a,this.vy=l,this.vz=c,this.life=100,this.rotation=0;let m=b[f.currentWeapon];this.emoji=m.emoji,this.damage=m.damage+h.damage+f.upgrades.damage*10,this.color=m.color,this.weaponType=f.currentWeapon,this.special=m.special||null}update(){this.x+=this.vx,this.y+=this.vy,this.z+=this.vz,this.vy+=.05,this.life--,this.special==="moai"&&(this.rotation+=.15)}spawnSkullTrail(){this.special==="doot"&&this.life%5===0&&u.push({text:"\u{1F480}",x:this.x+(Math.random()-.5)*20,y:this.y+(Math.random()-.5)*20,z:this.z,life:30,color:"#ffffff"})}static showYoAngelo(e,i,o){u.push({text:"Yo, Angelo \u{1F5FF}",x:e+(Math.random()-.5)*30,y:i,z:o,life:60,color:"#8b7355"})}static showSkeletonEffect(e,i,o){u.push({text:"\u{1F480}",x:e,y:i-30,z:o,life:60,color:"#ffffff"}),u.push({text:"DOOT!",x:e,y:i-60,z:o,life:45,color:"#daa520"})}draw(e,i){let o=i.width/2+this.x*(Ee/Math.max(ge,-this.z)),a=i.height/2+(this.y+100)*(Ee/Math.max(ge,-this.z)),l=Ee/Math.max(ge,-this.z);-this.z<10||(e.save(),e.shadowColor=this.color,e.shadowBlur=20,e.font=`${30*l}px Arial`,e.textAlign="center",e.textBaseline="middle",this.special==="moai"?(e.translate(o,a),e.rotate(this.rotation),e.fillText(this.emoji,0,0)):e.fillText(this.emoji,o,a),e.shadowBlur=0,e.restore())}isExpired(){return this.life<=0}};function Z(t=10,e=200){(t>=M.intensity||!M.active)&&(M.intensity=t,M.duration=e,M.startTime=Date.now(),M.active=!0)}function ft(){let t=document.getElementById("game-container");if(!M.active){t.style.transform="translate(0, 0)";return}let i=(Date.now()-M.startTime)/M.duration;if(i>=1){M.active=!1,M.intensity=0,t.style.transform="translate(0, 0)";return}let o=M.intensity*(1-i),a=(Math.random()-.5)*2*o,l=(Math.random()-.5)*2*o;t.style.transform=`translate(${a}px, ${l}px)`}function Se(){Z(15,300)}function ut(){Z(5,150)}function pt(){Z(8,200)}function Et(){Z(30,500)}function gt(t=!1){let e=document.createElement("div");e.className="hit-marker"+(t?" crit":""),e.style.left=I.x+"px",e.style.top=I.y+"px",document.getElementById("game-container").appendChild(e),tt(t),setTimeout(()=>e.remove(),200)}function Ae(){let t=document.getElementById("damage-overlay");t.style.opacity="0.7",setTimeout(()=>t.style.opacity="0",200)}function St(){let t=document.getElementById("damage-overlay");t.style.background="radial-gradient(ellipse at center, rgba(0,255,0,0.4) 0%, transparent 70%)",t.style.opacity="1",setTimeout(()=>{t.style.opacity="0",t.style.background="radial-gradient(ellipse at center, transparent 50%, rgba(255,0,0,0.5) 100%)"},300)}function At(){let t=document.getElementById("muzzle-flash");t.style.opacity="1",setTimeout(()=>t.style.opacity="0",50)}function Tt(t,e=!1){let i=document.getElementById("wave-announcement");i.innerHTML=e?`\u26A0\uFE0F BOSS WAVE ${t} \u26A0\uFE0F<br><span style="font-size: 36px;">PREPARE FOR BATTLE!</span>`:`WAVE ${t}`,i.style.color=e?"#ff0000":"#ffcc00",i.style.opacity="1",i.style.transform="translate(-50%, -50%) scale(1.5)",setTimeout(()=>{i.style.opacity="0",i.style.transform="translate(-50%, -50%) scale(1)"},2e3)}function k(t){let e=Be[t];e&&(j.has(e.id)||(j.add(e.id),ri(e),p("achievement")))}function ri(t){let e=document.getElementById("achievement-container"),i=document.createElement("div");i.className="achievement-toast",i.innerHTML=`
        <div class="achievement-icon">${t.icon}</div>
        <div class="achievement-content">
            <div class="achievement-title">\u{1F3C6} ACHIEVEMENT UNLOCKED</div>
            <div class="achievement-name">${t.name}</div>
        </div>
    `,e.appendChild(i),setTimeout(()=>{i.classList.add("hiding"),setTimeout(()=>i.remove(),500)},r.ACHIEVEMENT_TOAST_DURATION_MS)}function yt(){T.waveStartHealth=n.health}function It(){n.health===T.waveStartHealth&&k("WAVE_SURVIVOR"),n.wave>=10&&T.totalDamageTaken===0&&k("EASY_MODE")}function Mt(t){n.kills===1&&k("FIRST_BLOOD"),t.isBoss&&k("BOSS_SLAYER"),t.type==="GIGACHAD"&&t.wasOneShot&&k("BUILT_DIFFERENT")}function _t(){n.wave===1&&k("SKILL_ISSUE")}function Te(t){T.shopSpending+=t,T.shopSpending>=1e3&&k("BIG_SPENDER")}function xt(t){t==="moai"&&k("MEME_LORD")}function Ct(){let t=Date.now();t-x.lastKillTime>x.streakTimeout&&(x.count=0),x.count++,x.lastKillTime=t;let e=Ne.slice().reverse().find(i=>x.count>=i.count);e&&x.count===e.count&&(li(e),it(e.count))}function li(t){let e=document.querySelector(".kill-streak-announcement");e&&e.remove();let i=document.createElement("div");i.className="kill-streak-announcement",i.textContent=t.name,i.style.color=t.color,i.style.textShadow=`0 0 20px ${t.color}, 0 0 40px ${t.color}`,document.getElementById("game-container").appendChild(i),setTimeout(()=>i.remove(),1500)}function Rt(){return S.count++,S.count>=r.WOMBO_COMBO_THRESHOLD&&!S.showWomboCombo?(S.showWomboCombo=!0,mi(),p("achievement")):S.count>1&&p("hit"),J(),S.count}function ye(){S.count>0&&(S.count=0,S.showWomboCombo=!1,J())}function ci(){return S.count<=0?1:1+S.count*r.COMBO_MULTIPLIER_PERCENT/100}function bt(t){let e=ci();return Math.floor(t*(e-1))}function J(){let t=document.getElementById("combo-counter");t&&(S.count>=2?(t.style.display="block",t.textContent=`COMBO x${S.count}`,S.count>=r.WOMBO_COMBO_THRESHOLD?(t.style.color="#ff00ff",t.style.textShadow="0 0 20px #ff00ff, 0 0 40px #ff00ff",t.classList.add("wombo-combo")):S.count>=5?(t.style.color="#ffff00",t.style.textShadow="0 0 15px #ffff00",t.classList.remove("wombo-combo")):(t.style.color="#00ff00",t.style.textShadow="0 0 10px #00ff00",t.classList.remove("wombo-combo"))):(t.style.display="none",t.classList.remove("wombo-combo")))}function mi(){let t=document.querySelector(".wombo-combo-announcement");t&&t.remove();let e=document.createElement("div");e.className="wombo-combo-announcement",e.innerHTML="\u{1F525} WOMBO COMBO! \u{1F525}",e.style.cssText=`
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) scale(0);
        font-family: 'Bungee', cursive;
        font-size: 72px;
        color: #ff00ff;
        text-shadow: 0 0 30px #ff00ff, 0 0 60px #ff00ff, 0 0 90px #ff00ff;
        z-index: 1000;
        pointer-events: none;
        animation: womboComboAnim 1.5s ease-out forwards;
    `;let i=document.getElementById("game-container");if(i){i.appendChild(e);let o=setTimeout(()=>e.remove(),1500);C(o)}}var{PERSPECTIVE_SCALE:Ie,PERSPECTIVE_MIN_Z:Me}=r;function wt(t,e){if(v.length>=r.DIALOGUE_BUBBLE_MAX)return;let i=De[t.type];if(!i||!i[e])return;let o=i[e],a=o[Math.floor(Math.random()*o.length)],l={enemy:t,text:a,life:120,maxLife:120};v.push(l);let c=setTimeout(()=>{let m=v.indexOf(l);m>-1&&v.splice(m,1)},r.DIALOGUE_BUBBLE_DURATION);C(c)}function vt(t){let e=ie[Math.floor(Math.random()*ie.length)];u.push({text:e,x:t.x,y:t.y-80,z:t.z,life:90,color:"#ffd700"})}function Lt(){let t=oe[Math.floor(Math.random()*oe.length)];u.push({text:t,x:0,y:-100,z:-300,life:120,color:"#ff4444"})}function Ot(t,e,i){u.push({text:"360 NO SCOPE!",x:t,y:e-80,z:i,life:60,color:"#ff00ff"})}function kt(t,e,i){for(let o=v.length-1;o>=0;o--){let a=v[o];a.life--;let l=a.enemy;if(!l||l.health<=0){v.splice(o,1);continue}let c=e.width/2+(l.x-i.x)*(Ie/Math.max(Me,-l.z)),m=e.height/2+100*(Ie/Math.max(Me,-l.z)),E=Ie/Math.max(Me,-l.z);if(-l.z<50||-l.z>2e3)continue;let D=Math.min(1,a.life/30);t.globalAlpha=D,t.font=`bold ${Math.max(10,14*E)}px Orbitron, sans-serif`;let U=t.measureText(a.text).width,V=10*E,Oe=Math.min(300,U+V*2),P=30*E,Zt=c-Oe/2,W=m-l.size*E-P-20*E;t.fillStyle="rgba(0, 0, 0, 0.85)",t.beginPath(),t.roundRect(Zt,W,Oe,P,8*E),t.fill(),t.strokeStyle="#ffcc00",t.lineWidth=2*E,t.stroke(),t.fillStyle="rgba(0, 0, 0, 0.85)",t.beginPath(),t.moveTo(c-8*E,W+P),t.lineTo(c,W+P+10*E),t.lineTo(c+8*E,W+P),t.closePath(),t.fill(),t.fillStyle="#ffffff",t.textAlign="center",t.textBaseline="middle",t.fillText(a.text,c,W+P/2),t.globalAlpha=1}}function hi(){let t;n.coins>=2e3?t="rich":n.coins<100?t="broke":t="normal";let e=$[t];return e[Math.floor(Math.random()*e.length)]}function _e(t=null){let e=t==="purchase"?$.purchase[Math.floor(Math.random()*$.purchase.length)]:hi();document.getElementById("shopkeeper-dialogue").textContent=e}function xe(t){!n.betweenWaves||!n.running||(T.shopSpending=0,n.paused=!0,document.getElementById("shop-screen").style.display="flex",document.getElementById("shop-coins").textContent=`\u{1FA99} ${n.coins}`,_e(),Q(t))}function Bt(t){n.paused=!1,document.getElementById("shop-screen").style.display="none",n.betweenWaves&&(n.betweenWaves=!1,t())}function Q(t){let e=document.getElementById("weapons-list"),i=document.getElementById("upgrades-list");e.innerHTML="",i.innerHTML="";for(let[o,a]of Object.entries(b)){let l=f.weapons[o],c=f.currentWeapon===o,m=document.createElement("div");m.className=`shop-item ${l?"owned":""} ${c?"equipped":""}`,m.innerHTML=`
            <div class="shop-item-icon">${a.emoji}</div>
            <div class="shop-item-name">${a.name}</div>
            <div class="shop-item-desc">${a.description}</div>
            <div class="shop-item-desc">DMG: ${a.damage} | RATE: ${a.fireRate}</div>
            <div class="shop-item-price">${l?c?"\u2713 EQUIPPED":"CLICK TO EQUIP":`\u{1FA99} ${a.price}`}</div>
        `,m.onclick=()=>{l?(f.currentWeapon=o,p("buy"),t(),Q(t)):n.coins>=a.price&&(n.coins-=a.price,Te(a.price),f.weapons[o]=!0,f.currentWeapon=o,p("buy"),_e("purchase"),document.getElementById("shop-coins").textContent=`\u{1FA99} ${n.coins}`,t(),Q(t))},e.appendChild(m)}for(let[o,a]of Object.entries(L)){let l=f.upgrades[o],c=l>=a.maxLevel,m=a.basePrice+l*100,E=document.createElement("div");E.className=`shop-item ${c?"maxed":""}`,E.innerHTML=`
            <div class="shop-item-icon">${a.icon}</div>
            <div class="shop-item-name">${a.name}</div>
            <div class="shop-item-desc">${a.description}</div>
            <div class="shop-item-level">Level ${l} / ${a.maxLevel}</div>
            <div class="shop-item-price">${c?"MAXED":`\u{1FA99} ${m}`}</div>
        `,E.onclick=()=>{!c&&n.coins>=m&&(n.coins-=m,Te(m),f.upgrades[o]++,p("buy"),_e("purchase"),di(),document.getElementById("shop-coins").textContent=`\u{1FA99} ${n.coins}`,t(),Q(t))},i.appendChild(E)}}function di(){let t=r.PLAYER_BASE_HEALTH+f.upgrades.health*L.health.perLevel;n.maxHealth=t,h.critChance=r.PLAYER_BASE_CRIT_CHANCE+f.upgrades.critChance*L.critChance.perLevel,h.damageBonus=f.upgrades.damage*L.damage.perLevel,h.fireRateBonus=f.upgrades.fireRate*L.fireRate.perLevel}function fi(t){if(Y[t])return Y[t];let e=[5,10,15,20,25],i=Math.floor((t-1)/5)%e.length,o=e[i],a=Y[o];return{name:a.name+" MK"+Math.floor(t/25+1),title:a.title+" (Ascended)",emoji:a.emoji}}function ui(t,e){let i=fi(n.wave),o=document.getElementById("boss-intro-overlay"),a=document.getElementById("boss-intro-emoji"),l=document.getElementById("boss-intro-name"),c=document.getElementById("boss-intro-title"),m=document.getElementById("boss-intro-flash");if(!o||!a||!l||!c){t&&t(i,e);return}n.paused=!0,a.className="",l.className="",c.className="",m&&(m.className=""),a.textContent=i.emoji,l.textContent=i.name,c.textContent=`"${i.title}"`,o.classList.add("active"),C(setTimeout(()=>{a.classList.add("slide-in")},300)),C(setTimeout(()=>{l.classList.add("show")},800)),C(setTimeout(()=>{c.classList.add("show")},1200)),C(setTimeout(()=>{m&&m.classList.add("flash")},2500)),C(setTimeout(()=>{o.classList.remove("active"),n.running&&(n.paused=!1,t&&t(i,e))},3e3))}function Nt(t){ui((e,i)=>{let o=new N("MINI_BOSS",0,-1e3,i);o.health=r.BOSS_BASE_HEALTH+n.wave*r.BOSS_HEALTH_PER_WAVE,o.maxHealth=o.health,o.shootCooldown=0,o.customName=e.name,y.push(o),n.bossActive=!0,n.currentBoss=o;let a=document.getElementById("boss-health-container"),l=document.getElementById("boss-name"),c=document.getElementById("boss-health-bar");a&&(a.style.display="block"),l&&(l.textContent=`\u{1F451} ${e.name} \u{1F451}`),c&&(c.style.width="100%"),p("boss")},t)}function Dt(){if(d.active)return;d.active=!0,d.hits=0,d.timeLeft=r.MINIGAME_DURATION_SEC,n.paused=!0,n.currentBoss&&(n.currentBoss.invulnerable=!0),document.getElementById("minigame-screen").style.display="flex",document.getElementById("minigame-timer").textContent=d.timeLeft,document.getElementById("minigame-hits").textContent="HITS: 0 | DAMAGE: 0";let t=document.getElementById("minigame-area");t.innerHTML="";function e(){if(!d.active)return;let i=document.createElement("div");i.className="minigame-target",i.innerHTML="\u{1F3AF}",i.style.left=Math.random()*540+"px",i.style.top=Math.random()*340+"px",i.onclick=o=>{o.stopPropagation(),d.hits++,p("minigame_hit"),i.remove(),document.getElementById("minigame-hits").textContent=`HITS: ${d.hits} | DAMAGE: ${d.hits*r.MINIGAME_DAMAGE_PER_HIT}`},t.appendChild(i),setTimeout(()=>i.remove(),r.MINIGAME_TARGET_LIFETIME)}d.targetInterval=setInterval(e,r.MINIGAME_TARGET_SPAWN_INTERVAL),e(),d.interval=setInterval(()=>{d.timeLeft--,document.getElementById("minigame-timer").textContent=d.timeLeft,d.timeLeft<=0&&pi()},1e3)}function pi(){if(clearInterval(d.interval),clearInterval(d.targetInterval),d.active=!1,document.getElementById("minigame-screen").style.display="none",document.getElementById("minigame-area").innerHTML="",n.currentBoss){let t=d.hits*r.MINIGAME_DAMAGE_PER_HIT;n.currentBoss.invulnerable=!1,t>0&&(n.currentBoss.health-=t,document.getElementById("boss-health-bar").style.width=`${Math.max(0,n.currentBoss.health/n.currentBoss.maxHealth*100)}%`,u.push({text:`MINIGAME BONUS: -${t}!`,x:n.currentBoss.x,y:-100,z:n.currentBoss.z,life:90,color:"#ff00ff"}),n.currentBoss.health<=0&&(n.currentBoss.die(),n.currentBoss.markedForRemoval=!0))}n.paused=!1}var{PERSPECTIVE_SCALE:Ce,PERSPECTIVE_MIN_Z:Pt}=r;function B(){document.getElementById("score").textContent=n.score.toLocaleString(),document.getElementById("coins-display").textContent=`\u{1FA99} ${n.coins}`,document.getElementById("kills").textContent=n.kills,document.getElementById("wave-display").textContent=`WAVE ${n.wave}`,document.getElementById("health-bar").style.width=`${Math.max(0,n.health/n.maxHealth*100)}%`;let t=b[f.currentWeapon];document.getElementById("weapon-name").textContent=t.name,document.getElementById("weapon-stats").textContent=`DMG: ${t.damage+h.damage+f.upgrades.damage*10} | CRIT: ${Math.floor(h.critChance*100)}%`;let e=n.healKills/n.healKillsRequired*100;document.getElementById("heal-power-bar").style.width=`${Math.min(100,e)}%`,n.healReady?(document.getElementById("heal-power-text").textContent="\u2728 READY! Press E \u2728",document.getElementById("heal-power-text").style.color="#00ff00",document.getElementById("heal-power-container").style.borderColor="#00ff00",document.getElementById("heal-power-container").style.boxShadow="0 0 15px #00ff00"):(document.getElementById("heal-power-text").textContent=`${n.healKills} / ${n.healKillsRequired} kills`,document.getElementById("heal-power-text").style.color="#888",document.getElementById("heal-power-container").style.borderColor="#444",document.getElementById("heal-power-container").style.boxShadow="none")}function Gt(){let t=document.getElementById("crosshair");if(d.active){t.style.display="none",document.body.style.cursor="crosshair";return}else t.style.display="block",document.body.style.cursor="none";t.style.left=I.x+"px",t.style.top=I.y+"px",t.style.transform="translate(-50%, -50%)"}function Ht(t){let e=document.getElementById("kill-feed"),i=document.createElement("div");for(i.className="kill-entry",i.innerHTML=`\u{1F385} SANTA <span style="color:#ff6b6b">eliminated</span> ${t}`,e.insertBefore(i,e.firstChild);e.children.length>r.KILL_FEED_MAX_ENTRIES;)e.removeChild(e.lastChild);setTimeout(()=>i.remove(),r.KILL_FEED_DURATION_MS)}function Re(t){t.width=window.innerWidth,t.height=window.innerHeight}function Vt(t,e){let i=t.createLinearGradient(0,0,0,e.height);i.addColorStop(0,"#1a0a2e"),i.addColorStop(.5,"#16213e"),i.addColorStop(1,"#0f3460"),t.fillStyle=i,t.fillRect(0,0,e.width,e.height),t.fillStyle="#fff";for(let o=0;o<100;o++){let a=o*137.5%e.width,l=o*73.3%(e.height*.6),c=o%3+1,m=Math.sin(Date.now()/500+o)*.5+.5;t.globalAlpha=m,t.beginPath(),t.arc(a,l,c,0,Math.PI*2),t.fill()}t.globalAlpha=1,t.fillStyle="#ffffd0",t.shadowColor="#ffffd0",t.shadowBlur=50,t.beginPath(),t.arc(e.width-150,150,60,0,Math.PI*2),t.fill(),t.shadowBlur=0,t.fillStyle="#1a1a2e",t.fillRect(0,e.height*.65,e.width,e.height*.35),t.strokeStyle="#333355",t.lineWidth=1;for(let o=100;o<2e3;o+=100){let a=e.height*.65+Ce/o*300;t.globalAlpha=1-o/2e3,t.beginPath(),t.moveTo(0,a),t.lineTo(e.width,a),t.stroke()}t.globalAlpha=1}function Wt(t,e){let i=Math.sin(Date.now()/150)*3,o=b[f.currentWeapon],a=ot();t.strokeStyle=a.glowColor+"50",t.lineWidth=2,t.setLineDash([5,5]),t.beginPath(),t.moveTo(e.width/2,e.height-100),t.lineTo(I.x,I.y),t.stroke(),t.setLineDash([]),t.fillStyle=a.color,t.shadowColor=a.glowColor,t.shadowBlur=10,t.beginPath(),t.ellipse(e.width/2-100,e.height-100+i,40,50,-.3,0,Math.PI*2),t.fill(),t.beginPath(),t.ellipse(e.width/2+100,e.height-100+i,40,50,.3,0,Math.PI*2),t.fill(),t.shadowBlur=0,t.save(),t.translate(e.width/2,e.height-80+i),t.fillStyle="#228b22",t.fillRect(-60,-40,120,80),t.fillStyle=o.color,t.fillRect(-10,-40,20,80),t.fillRect(-60,-10,120,20),t.font="40px Arial",t.textAlign="center",t.textBaseline="middle",t.fillText(o.emoji,0,0),t.fillStyle="#1a5c1a",t.fillRect(50,-20,40,40),t.restore()}function zt(t,e){for(let i=u.length-1;i>=0;i--){let o=u[i];o.y-=2,o.life--;let a=e.width/2+o.x*(Ce/Math.max(Pt,-o.z)),l=e.height/2+o.y*(Ce/Math.max(Pt,-o.z));t.globalAlpha=o.life/60,t.font="bold 24px Bungee",t.fillStyle=o.color,t.textAlign="center",t.fillText(o.text,a,l),t.globalAlpha=1,o.life<=0&&u.splice(i,1)}}var A,R,Ft=null;function be(){return{playSound:p,showDamageOverlay:Ae,shakeOnDamage:Se,shakeOnKill:ut,shakeOnCrit:pt,shakeOnBossDeath:Et,showHitMarker:gt,showEnemyDialogue:wt,showSigmaDialogue:vt,showSigmaEscapeText:Lt,showGamerAttackText:Ot,updateHUD:B,addKillFeed:Ht,recordKill:Ct,incrementCombo:Rt,breakCombo:ye,getComboBonus:bt,startMinigame:Dt,gameOver:Yt,checkAchievements:Mt,spawnLensFlare:Ft}}function Ei(){let t,e=Math.random();if(e<.08){t="SIGMA_DINO";let l=(Math.random()>.5?1:-1)*r.SIGMA_SPAWN_X,c=r.SIGMA_SPAWN_Z_BASE-Math.random()*r.SIGMA_SPAWN_Z_RANGE;y.push(new N(t,l,c,be()));return}else n.wave>=3&&e<.3?t="GAMER_DINO":e<.55?t="BUFF_NERD":t="GIGACHAD";let i=(Math.random()-.5)*r.ENEMY_SPAWN_X_RANGE,o=r.ENEMY_SPAWN_Z_BASE-Math.random()*r.ENEMY_SPAWN_Z_RANGE;y.push(new N(t,i,o,be()))}function we(){n.waveInProgress=!0,yt();let t=n.wave%r.BOSS_WAVE_INTERVAL===0;if(Tt(n.wave,t),t)setTimeout(()=>Nt(be()),1e3);else{let e=r.ENEMIES_BASE_COUNT+n.wave*r.ENEMIES_PER_WAVE;for(let i=0;i<e;i++)setTimeout(()=>Ei(),i*r.ENEMY_SPAWN_DELAY_MS)}}function ve(){if(!n.running||n.paused||h.fireCooldown>0)return;let t=b[f.currentWeapon];xt(t.special),t.special==="doot"?p("doot"):p("shoot"),h.fireCooldown=t.fireRate-f.upgrades.fireRate*L.fireRate.perLevel,h.fireCooldown=Math.max(3,h.fireCooldown);let e=A.width/2,i=A.height/2,o=(I.x-e)/e,a=(I.y-i)/i,l=-t.speed,c=o*t.speed*.8,m=a*t.speed*.5-1;G.push(new H(h.x,0,0,c,m,l)),At()}function Ut(){!n.running||n.paused||n.healReady&&(n.healReady=!1,n.healKills=0,n.health=Math.min(n.maxHealth,n.health+r.HEAL_AMOUNT),p("heal"),St(),u.push({text:`+${r.HEAL_AMOUNT} HP`,x:0,y:-50,z:-200,life:60,color:"#00ff00"}),B())}function Yt(){n.running=!1,_t(),rt(),document.getElementById("game-over").style.display="flex"}function Le(){document.getElementById("start-screen").style.display="none",document.getElementById("game-over").style.display="none",document.getElementById("shop-screen").style.display="none",document.getElementById("boss-health-container").style.display="none",We(),Pe(),Ge(),He(),Ve(),ze(),Fe(),Ue(),Ye(),$e(),J(),B(),we(),et()}function $t(){if(R.clearRect(0,0,A.width,A.height),Vt(R,A),Gt(),ft(),n.running&&!n.paused){h.fireCooldown>0&&h.fireCooldown--;for(let t=G.length-1;t>=0;t--){let e=G[t];e.update(),e.spawnSkullTrail();for(let i=y.length-1;i>=0;i--){let o=y[i],a=e.x-o.x,l=e.y-o.y,c=e.z-o.z,m=Math.sqrt(a*a+l*l+c*c),E=r.PROJECTILE_HIT_RADIUS_BASE+o.size/3;if(m<E){e.special==="moai"&&(H.showYoAngelo(o.x,o.y-50,o.z),p("moai")),o.takeDamage(e.damage)&&(e.special==="doot"&&(H.showSkeletonEffect(o.x,o.y,o.z),p("doot_kill")),o.markedForRemoval=!0),e.life=0;break}}e.draw(R,A),e.isExpired()&&G.splice(t,1)}for(let t=w.length-1;t>=0;t--){let e=w[t];e.update(),e.checkPlayerCollision(h)&&(n.health-=e.damage,n.lastAttacker=e.attackerName,T.totalDamageTaken+=e.damage,p("damage"),Ae(),Se(),ye(),n.health<=0&&Yt(),B()),e.draw(R,A),e.isExpired()&&w.splice(t,1)}y.sort((t,e)=>t.z-e.z),y.forEach(t=>{t.update(),t.draw(R,A)});for(let t=y.length-1;t>=0;t--)y[t].markedForRemoval&&y.splice(t,1);for(let t=O.length-1;t>=0;t--){let e=O[t];e.update(),e.draw(R,A,h),e.isExpired()&&(Qe(e),O.splice(t,1))}if(zt(R,A),kt(R,A,h),y.length===0&&n.waveInProgress){It(),n.waveInProgress=!1,n.wave++,n.betweenWaves=!0,w.length=0,n.health=Math.min(n.maxHealth,n.health+r.WAVE_BETWEEN_HEAL_AMOUNT),B();let t=n.wave%r.BOSS_WAVE_INTERVAL===0;setTimeout(()=>{n.betweenWaves&&(t?(n.betweenWaves=!1,we()):xe(B))},1500)}}Wt(R,A),requestAnimationFrame($t)}function Kt(t){A=t,R=A.getContext("2d"),Ft=dt(A),Re(A),window.addEventListener("resize",()=>Re(A)),$t()}function jt(){xe(B)}function qt(){Bt(we)}function Xt(){let t=document.getElementById("game-canvas");nt(),ct(),Kt(t),gi()}function gi(){document.addEventListener("keydown",t=>{(t.key===" "||t.code==="Space")&&(t.preventDefault(),ve()),(t.key==="e"||t.key==="E")&&Ut(),(t.key==="r"||t.key==="R")&&n.betweenWaves&&jt()}),document.addEventListener("mousemove",t=>{Ke(t.clientX,t.clientY)}),document.addEventListener("click",t=>{n.running&&!n.paused&&ve()}),document.addEventListener("contextmenu",t=>t.preventDefault()),document.getElementById("start-btn").addEventListener("click",Le),document.getElementById("restart-btn").addEventListener("click",Le),document.getElementById("copy-receipt-btn").addEventListener("click",lt),document.getElementById("continue-btn").addEventListener("click",qt)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",Xt):Xt();})();
</script>
</body>
</html>
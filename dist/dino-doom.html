<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DINO DOOM: Santa's Last Stand</title>
    <link href="https://fonts.googleapis.com/css2?family=Bungee&family=Orbitron:wght@700;900&family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>*{margin:0;padding:0;box-sizing:border-box}body{background:#0a0a0f;font-family:'Orbitron',sans-serif;overflow:hidden;cursor:none}#game-container{position:relative;width:100vw;height:100vh;background:linear-gradient(180deg,#1a0a2e 0%,#16213e 50%,#0f3460 100%);transition:transform 0.05s ease-out}#game-canvas{display:block;width:100%;height:100%}#hud{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none}.hud-corner{position:absolute;padding:20px}.top-left{top:0;left:0}.top-right{top:0;right:0;text-align:right}.bottom-left{bottom:0;left:0}.bottom-right{bottom:0;right:0;text-align:right}.top-center{top:0;left:50%;transform:translateX(-50%);text-align:center}.stat-label{font-family:'Press Start 2P',monospace;font-size:10px;color:#ff6b6b;text-transform:uppercase;letter-spacing:2px;text-shadow:0 0 10px #ff6b6b}.stat-value{font-family:'Bungee',cursive;font-size:clamp(20px,5vw,36px);color:#fff;text-shadow:0 0 10px #00ff88,0 0 20px #00ff88,0 0 40px #00ff88}#health-bar-container{width:min(300px,40vw);height:30px;background:rgba(0,0,0,0.7);border:3px solid #ff3333;border-radius:5px;overflow:hidden;box-shadow:0 0 20px rgba(255,51,51,0.5)}#health-bar{height:100%;background:linear-gradient(90deg,#ff0000,#ff6600,#ff3333);transition:width 0.3s ease;box-shadow:inset 0 0 20px rgba(255,255,255,0.3)}#heal-power-container.heal-ready{animation:healReadyPulse 1s ease-in-out infinite}#heal-power-container.heal-ready #heal-power-text{animation:healTextGlow 1s ease-in-out infinite}@keyframes healReadyPulse{0%,100%{box-shadow:0 0 15px #ffd700;border-color:#ffd700}50%{box-shadow:0 0 30px #ffaa00,0 0 50px rgba(255,215,0,0.5);border-color:#ffaa00}}@keyframes healTextGlow{0%,100%{text-shadow:0 0 5px #ffd700}50%{text-shadow:0 0 15px #ffd700,0 0 25px #ffaa00}}#coins-display{font-family:'Orbitron',sans-serif;font-size:28px;font-weight:900;color:#ffd700;text-shadow:0 0 10px #ffd700}#wave-display{font-family:'Bungee',cursive;font-size:24px;color:#ffcc00;text-shadow:0 0 15px #ffcc00}#weapon-name{font-family:'Bungee',cursive;font-size:20px;color:#ff6b6b;text-shadow:0 0 10px #ff6b6b}#kill-feed{position:absolute;top:100px;right:20px;width:min(300px,35vw)}.kill-entry{font-family:'Press Start 2P',monospace;font-size:10px;color:#fff;padding:8px 12px;margin-bottom:5px;background:rgba(0,0,0,0.7);border-left:4px solid #ff0000;animation:killSlide 0.3s ease-out}#damage-overlay{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;background:radial-gradient(ellipse at center,transparent 50%,rgba(255,0,0,0.5) 100%);opacity:0;transition:opacity 0.1s}#wave-announcement{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-family:'Bungee',cursive;font-size:clamp(36px,10vw,72px);color:#ffcc00;text-shadow:0 0 20px #ffcc00,0 0 40px #ffcc00;opacity:0;pointer-events:none;z-index:50;text-align:center;width:90%}#boss-tutorial{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.9);display:none;justify-content:center;align-items:center;z-index:200}#boss-tutorial.visible{display:flex}.boss-tutorial-content{background:linear-gradient(135deg,#1a1a2e,#2d2d44);border:3px solid #ff3333;border-radius:15px;padding:30px 50px;text-align:center;max-width:500px;animation:tutorialPop 0.3s ease-out}@keyframes tutorialPop{0%{transform:scale(0.8);opacity:0}100%{transform:scale(1);opacity:1}}.boss-tutorial-content h2{font-family:'Bungee',cursive;font-size:32px;color:#ff3333;text-shadow:0 0 20px #ff3333;margin-bottom:15px}.boss-tutorial-content .tutorial-icon{font-size:60px;margin-bottom:15px}.boss-tutorial-content .tutorial-text{font-family:'Orbitron',sans-serif;font-size:16px;color:#ffffff;margin-bottom:10px;line-height:1.6}.boss-tutorial-content .highlight{color:#ffcc00;font-weight:bold}.boss-tutorial-content .tutorial-hint{font-family:'Press Start 2P',monospace;font-size:11px;color:#00ff88;margin-top:15px;margin-bottom:20px}#boss-tutorial-btn{font-size:18px;padding:12px 40px}#shop-indicator{position:absolute;bottom:50px;left:50%;transform:translateX(-50%);background:linear-gradient(135deg,rgba(255,215,0,0.95),rgba(255,170,0,0.95));border:3px solid #ffd700;border-radius:15px;padding:15px 30px;display:none;align-items:center;gap:12px;z-index:80;animation:shopIndicatorPulse 1s ease-in-out infinite;box-shadow:0 0 30px rgba(255,215,0,0.6);cursor:pointer;pointer-events:auto}#shop-indicator.visible{display:flex}.shop-indicator-icon{font-size:32px;animation:shopIconBounce 0.5s ease-in-out infinite}.shop-indicator-text{font-family:'Bungee',cursive;font-size:20px;color:#1a1a2e;text-shadow:none}.shop-indicator-key{font-family:'Press Start 2P',monospace;font-size:14px;color:#fff;background:#1a1a2e;padding:5px 10px;border-radius:5px}@keyframes shopIndicatorPulse{0%,100%{transform:translateX(-50%) scale(1);box-shadow:0 0 20px rgba(255,215,0,0.6)}50%{transform:translateX(-50%) scale(1.05);box-shadow:0 0 40px rgba(255,215,0,0.9)}}@keyframes shopIconBounce{0%,100%{transform:translateY(0)}50%{transform:translateY(-5px)}}#muzzle-flash{position:absolute;bottom:100px;left:50%;transform:translateX(-50%);width:100px;height:100px;background:radial-gradient(circle,#ffff00 0%,#ff6600 30%,transparent 70%);opacity:0;pointer-events:none}#crosshair{position:absolute;pointer-events:none;z-index:50}.crosshair-line{position:absolute;background:#ff0000;box-shadow:0 0 10px #ff0000,0 0 20px #ff0000}.crosshair-h{width:20px;height:3px;top:50%;transform:translateY(-50%)}.crosshair-v{width:3px;height:20px;left:50%;transform:translateX(-50%)}.ch-left{left:-35px}.ch-right{right:-35px}.ch-top{top:-35px}.ch-bottom{bottom:-35px}#crosshair-dot{position:absolute;width:6px;height:6px;background:#ff0000;border-radius:50%;top:50%;left:50%;transform:translate(-50%,-50%);box-shadow:0 0 15px #ff0000}.hit-marker{position:absolute;pointer-events:none;z-index:60;width:40px;height:40px;transform:translate(-50%,-50%);animation:hitMarkerFade 0.2s ease-out forwards}.hit-marker::before,.hit-marker::after{content:'';position:absolute;top:50%;left:50%;width:20px;height:3px;background:white;box-shadow:0 0 8px white,0 0 15px white}.hit-marker::before{transform:translate(-50%,-50%) rotate(45deg)}.hit-marker::after{transform:translate(-50%,-50%) rotate(-45deg)}.hit-marker.crit::before,.hit-marker.crit::after{background:#ffd700;box-shadow:0 0 10px #ffd700,0 0 20px #ff8800;width:25px;height:4px}#combo-counter{position:absolute;top:180px;left:20px;font-family:'Bungee',cursive;font-size:32px;color:#00ff00;text-shadow:0 0 10px #00ff00;pointer-events:none;z-index:60;display:none;animation:comboPulse 0.3s ease-out}#combo-counter.wombo-combo{animation:womboComboShake 0.2s infinite}.kill-streak-announcement{position:absolute;top:30%;left:50%;transform:translate(-50%,-50%);font-family:'Bungee',cursive;font-size:64px;font-weight:bold;pointer-events:none;z-index:70;animation:killStreakAnimate 1.5s ease-out forwards;text-transform:uppercase;letter-spacing:4px}#achievement-container{position:absolute;top:20px;right:20px;width:min(320px,40vw);pointer-events:none;z-index:80;display:flex;flex-direction:column;gap:10px}.achievement-toast{background:linear-gradient(135deg,rgba(30,30,30,0.95),rgba(50,50,50,0.95));border:2px solid #ffd700;border-radius:10px;padding:15px 20px;display:flex;align-items:center;gap:15px;animation:achievementSlideIn 0.5s ease-out forwards;box-shadow:0 0 20px rgba(255,215,0,0.3)}.achievement-toast.hiding{animation:achievementSlideOut 0.5s ease-in forwards}.achievement-icon{font-size:32px}.achievement-content{flex:1}.achievement-title{font-family:'Bungee',cursive;font-size:14px;color:#ffd700;text-shadow:0 0 10px #ffd700;margin-bottom:4px}.achievement-name{font-family:'Orbitron',sans-serif;font-size:12px;color:#ffffff}#boss-intro-overlay{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0);display:none;justify-content:center;align-items:center;flex-direction:column;z-index:100;pointer-events:none}#boss-intro-overlay.active{display:flex;animation:bossDarken 0.5s ease-out forwards}#boss-intro-emoji{font-size:clamp(80px,20vw,150px);opacity:0;transform:translateY(-200px) scale(0.5)}#boss-intro-emoji.slide-in{animation:bossSlideIn 0.8s ease-out forwards}#boss-intro-name{font-family:'Orbitron',sans-serif;font-size:clamp(24px,6vw,48px);color:#ffd700;text-shadow:0 0 20px #ffd700,0 0 40px #ff8800;opacity:0;margin-top:20px}#boss-intro-name.show{animation:bossNameReveal 0.5s ease-out forwards}#boss-intro-title{font-family:'Press Start 2P',monospace;font-size:18px;color:#ff4444;text-shadow:0 0 10px #ff0000;opacity:0;margin-top:10px}#boss-intro-title.show{animation:bossTitleReveal 0.4s ease-out forwards}#boss-intro-flash{position:absolute;top:0;left:0;width:100%;height:100%;background:white;opacity:0;pointer-events:none}#boss-intro-flash.flash{animation:bossFlash 0.3s ease-out forwards}#boss-health-container{position:absolute;top:80px;left:50%;transform:translateX(-50%);width:min(500px,80vw);display:none;text-align:center}#boss-name{font-family:'Bungee',cursive;font-size:24px;color:#ff0000;text-shadow:0 0 10px #ff0000;margin-bottom:10px}#boss-health-bar-bg{position:relative;width:100%;height:25px;background:#333;border:3px solid #ff0000;border-radius:5px;overflow:visible}#boss-health-bar{height:100%;background:linear-gradient(90deg,#ff0000,#ff6600);transition:width 0.3s}#boss-phase-marker{position:absolute;top:0;left:50%;width:3px;height:100%;background:#ffd700;box-shadow:0 0 8px #ffd700,0 0 15px #ff8800;z-index:2}#boss-phase-label{position:absolute;top:-22px;left:50%;transform:translateX(-50%);font-family:'Press Start 2P',monospace;font-size:10px;color:#ffd700;text-shadow:0 0 5px #ff8800;white-space:nowrap;animation:phaseIndicatorPulse 1s ease-in-out infinite}@keyframes phaseIndicatorPulse{0%,100%{opacity:0.7}50%{opacity:1}}#boss-phase-3-marker{position:absolute;top:0;left:25%;width:3px;height:100%;background:#ff3333;box-shadow:0 0 8px #ff3333,0 0 15px #ff0000;z-index:2;display:none}#boss-phase-3-label{position:absolute;top:-22px;left:25%;transform:translateX(-50%);font-family:'Press Start 2P',monospace;font-size:10px;color:#ff3333;text-shadow:0 0 5px #ff0000;white-space:nowrap;display:none;animation:phase3LabelPulse 0.5s ease-in-out infinite}@keyframes phase3LabelPulse{0%,100%{opacity:0.8;text-shadow:0 0 5px #ff0000}50%{opacity:1;text-shadow:0 0 15px #ff0000,0 0 25px #ff3300}}#boss-phase-overlay{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0);display:none;justify-content:center;align-items:center;flex-direction:column;z-index:150;pointer-events:none}#boss-phase-overlay.active{display:flex;animation:phaseOverlayDarken 0.5s ease-out forwards}#boss-phase-overlay.phase-2{background:linear-gradient(180deg,rgba(255,136,0,0.2) 0%,rgba(0,0,0,0.7) 100%)}#boss-phase-overlay.phase-3{background:linear-gradient(180deg,rgba(255,0,0,0.3) 0%,rgba(50,0,0,0.8) 100%)}#boss-phase-emoji{font-size:120px;opacity:0;transform:scale(0.5);animation:phaseEmojiPop 0.6s ease-out forwards;filter:drop-shadow(0 0 30px currentColor)}#boss-phase-overlay.phase-3 #boss-phase-emoji{animation:phaseEmojiPop 0.6s ease-out forwards,phaseEmojiFire 0.3s ease-in-out infinite}#boss-phase-number{font-family:'Bungee',cursive;font-size:48px;color:#ffd700;text-shadow:0 0 20px #ffd700,0 0 40px #ff8800;opacity:0;margin-top:20px;animation:phaseTextReveal 0.5s ease-out 0.3s forwards}#boss-phase-overlay.phase-3 #boss-phase-number{color:#ff3333;text-shadow:0 0 20px #ff3333,0 0 40px #ff0000}#boss-phase-title{font-family:'Press Start 2P',monospace;font-size:16px;color:#fff;text-shadow:0 0 10px #ff8800;opacity:0;margin-top:10px;animation:phaseTextReveal 0.4s ease-out 0.5s forwards}#boss-phase-overlay.phase-3 #boss-phase-title{text-shadow:0 0 10px #ff0000;animation:phaseTextReveal 0.4s ease-out 0.5s forwards,phaseTitleFlicker 0.2s ease-in-out infinite}#boss-phase-flash{position:absolute;top:0;left:0;width:100%;height:100%;background:white;opacity:0;pointer-events:none}#boss-phase-overlay.active #boss-phase-flash{animation:phaseFlash 0.3s ease-out}@keyframes phaseOverlayDarken{0%{background:rgba(0,0,0,0)}100%{background:rgba(0,0,0,0.7)}}@keyframes phaseEmojiPop{0%{opacity:0;transform:scale(0.5) rotate(-10deg)}60%{transform:scale(1.3) rotate(5deg)}100%{opacity:1;transform:scale(1) rotate(0deg)}}@keyframes phaseEmojiFire{0%,100%{filter:drop-shadow(0 0 30px #ff3300) brightness(1)}50%{filter:drop-shadow(0 0 50px #ff6600) brightness(1.3)}}@keyframes phaseTextReveal{0%{opacity:0;transform:translateY(20px)}100%{opacity:1;transform:translateY(0)}}@keyframes phaseTitleFlicker{0%,100%{opacity:1}50%{opacity:0.8}}@keyframes phaseFlash{0%{opacity:0.8}100%{opacity:0}}#game-container.phase-3-active{animation:phase3Shake 0.15s ease-in-out infinite}@keyframes phase3Shake{0%,100%{transform:translate(0,0)}25%{transform:translate(-2px,1px)}50%{transform:translate(2px,-1px)}75%{transform:translate(-1px,-2px)}}#game-container.phase-3-active::after{content:'';position:absolute;top:0;left:0;width:100%;height:100%;background:radial-gradient(ellipse at center,transparent 40%,rgba(255,0,0,0.15) 100%);pointer-events:none;z-index:4;animation:phase3Vignette 2s ease-in-out infinite}@keyframes phase3Vignette{0%,100%{opacity:0.5}50%{opacity:1}}#start-screen{position:absolute;top:0;left:0;width:100%;height:100%;background:linear-gradient(180deg,#0a0015 0%,#1a0a2e 50%,#0f1a3e 100%);display:flex;flex-direction:column;justify-content:center;align-items:center;z-index:100}#start-screen h1{font-family:'Bungee',cursive;font-size:clamp(32px,10vw,72px);color:#ff3333;text-shadow:0 0 10px #ff3333,0 0 30px #ff3333,0 0 60px #ff3333,5px 5px 0 #00ff88;margin-bottom:20px;animation:titlePulse 2s ease-in-out infinite;padding:0 10px}#start-screen h2{font-family:'Orbitron',sans-serif;font-size:clamp(14px,3.5vw,28px);color:#00ffff;text-shadow:0 0 20px #00ffff;margin-bottom:50px;padding:0 10px}.enemy-preview{display:flex;gap:clamp(15px,4vw,60px);margin-bottom:50px;flex-wrap:wrap;justify-content:center;padding:0 10px}.enemy-card{text-align:center;padding:clamp(10px,2vw,20px);background:rgba(0,0,0,0.5);border:2px solid #ff6b6b;border-radius:10px;flex:0 1 auto;min-width:100px;max-width:180px}.enemy-card-emoji{font-size:clamp(40px,10vw,80px)}.enemy-card h3{font-family:'Press Start 2P',monospace;font-size:clamp(8px,1.5vw,12px);color:#ffcc00;margin-top:10px}#skin-selector{margin:20px 0;padding:20px;background:rgba(0,0,0,0.5);border:2px solid #ffd700;border-radius:15px}#skin-selector h3{font-family:'Orbitron',sans-serif;font-size:18px;color:#ffd700;margin-bottom:15px;text-shadow:0 0 10px rgba(255,215,0,0.5)}#skin-options{display:flex;gap:15px;justify-content:center;flex-wrap:wrap}.skin-option{background:rgba(30,30,50,0.9);border:3px solid #444;border-radius:10px;padding:15px;width:120px;text-align:center;cursor:pointer;transition:all 0.2s}.skin-option:hover{border-color:#ffd700;transform:translateY(-3px)}.skin-option.selected{border-color:#00ff00;box-shadow:0 0 20px rgba(0,255,0,0.4)}.skin-option.locked{opacity:0.6}.skin-option.locked:hover{border-color:#ff4444}.skin-emoji{font-size:50px;margin-bottom:8px}.skin-name{font-family:'Press Start 2P',monospace;font-size:10px;color:#fff;margin-bottom:5px}.skin-price{font-family:'Orbitron',sans-serif;font-size:12px;color:#ffd700}.skin-price.owned{color:#00ff00}#skin-coins-display{margin-top:15px;font-family:'Orbitron',sans-serif;font-size:16px;color:#ffd700}#volume-control{margin:20px 0;padding:15px 25px;background:rgba(0,0,0,0.5);border:2px solid #00ffff;border-radius:10px;display:flex;align-items:center;gap:15px}#volume-control label{font-family:'Press Start 2P',monospace;font-size:12px;color:#00ffff;text-shadow:0 0 10px rgba(0,255,255,0.5)}#volume-slider{width:150px;height:10px;-webkit-appearance:none;appearance:none;background:#333;border-radius:5px;outline:none;cursor:pointer}#volume-slider::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:20px;height:20px;background:#00ffff;border-radius:50%;cursor:pointer;box-shadow:0 0 10px #00ffff}#volume-slider::-moz-range-thumb{width:20px;height:20px;background:#00ffff;border-radius:50%;cursor:pointer;box-shadow:0 0 10px #00ffff;border:none}#volume-value{font-family:'Orbitron',sans-serif;font-size:14px;color:#00ffff;min-width:50px}.game-btn{font-family:'Bungee',cursive;font-size:32px;padding:20px 60px;background:linear-gradient(180deg,#ff3333,#cc0000);color:#fff;border:none;border-radius:10px;cursor:pointer;text-shadow:2px 2px 0 #000;box-shadow:0 5px 0 #990000,0 10px 30px rgba(255,0,0,0.5);transition:all 0.1s;pointer-events:auto}.game-btn:hover{transform:translateY(-3px);box-shadow:0 8px 0 #990000,0 15px 40px rgba(255,0,0,0.7)}.game-btn:active{transform:translateY(3px);box-shadow:0 2px 0 #990000,0 5px 20px rgba(255,0,0,0.5)}.game-btn.green{background:linear-gradient(180deg,#00ff88,#00aa55);box-shadow:0 5px 0 #007733,0 10px 30px rgba(0,255,136,0.5)}.game-btn.green:hover{box-shadow:0 8px 0 #007733,0 15px 40px rgba(0,255,136,0.7)}.controls-info{margin-top:40px;font-family:'Press Start 2P',monospace;font-size:10px;color:#888;text-align:center;line-height:2}#shop-screen{position:absolute;top:0;left:0;width:100%;height:100%;background:linear-gradient(180deg,#0a0015 0%,#1a0a2e 100%);display:none;flex-direction:column;align-items:center;padding:40px;z-index:100;overflow-y:auto}#shop-screen h1{font-family:'Bungee',cursive;font-size:48px;color:#ffd700;text-shadow:0 0 20px #ffd700;margin-bottom:10px}#shop-coins{font-family:'Orbitron',sans-serif;font-size:28px;color:#ffd700;margin-bottom:20px}#shopkeeper-container{display:flex;align-items:center;gap:20px;background:linear-gradient(135deg,rgba(40,30,60,0.9),rgba(30,20,50,0.9));border:2px solid #8b7355;border-radius:15px;padding:15px 25px;margin-bottom:25px;max-width:600px;box-shadow:0 0 20px rgba(139,115,85,0.3)}#shopkeeper-emoji{font-size:80px;animation:shopkeeperBob 2s ease-in-out infinite}#shopkeeper-dialogue{font-family:'Press Start 2P',monospace;font-size:14px;color:#ffd700;text-shadow:0 0 10px rgba(255,215,0,0.5);line-height:1.6;max-width:400px}.shop-section{width:100%;max-width:900px;margin-bottom:30px}.shop-section h2{font-family:'Orbitron',sans-serif;font-size:24px;color:#00ffff;margin-bottom:15px;border-bottom:2px solid #00ffff;padding-bottom:10px}.shop-items{display:flex;flex-wrap:wrap;gap:15px}.shop-item{background:rgba(0,0,0,0.6);border:2px solid #444;border-radius:10px;padding:clamp(10px,2vw,20px);width:clamp(140px,20vw,200px);text-align:center;cursor:pointer;transition:all 0.2s;pointer-events:auto}.shop-item:hover{border-color:#ffd700;transform:translateY(-5px);box-shadow:0 10px 30px rgba(255,215,0,0.3)}.shop-item.owned{border-color:#00ff88;background:rgba(0,255,136,0.1)}.shop-item.equipped{border-color:#00ffff;box-shadow:0 0 20px #00ffff}.shop-item.maxed{border-color:#888;opacity:0.6;cursor:not-allowed}.shop-item-icon{font-size:48px;margin-bottom:10px}.shop-item-name{font-family:'Orbitron',sans-serif;font-size:14px;color:#fff;margin-bottom:5px}.shop-item-desc{font-size:11px;color:#aaa;margin-bottom:10px}.shop-item-price{font-family:'Bungee',cursive;font-size:18px;color:#ffd700}.shop-item-level{font-size:12px;color:#00ff88;margin-top:5px}.prestige-section{background:linear-gradient(135deg,rgba(255,100,0,0.15),rgba(255,50,0,0.1));border:2px solid #ff6600;border-radius:15px;padding:20px;box-shadow:0 0 30px rgba(255,100,0,0.3);animation:prestigeGlow 2s ease-in-out infinite}@keyframes prestigeGlow{0%,100%{box-shadow:0 0 30px rgba(255,100,0,0.3)}50%{box-shadow:0 0 50px rgba(255,100,0,0.5)}}.prestige-section h2{color:#ff6600 !important;text-shadow:0 0 15px #ff6600 !important}.prestige-info{font-family:'Press Start 2P',monospace;font-size:10px;color:#ff9900;text-align:center;margin-bottom:15px;animation:prestigePulse 1.5s ease-in-out infinite}@keyframes prestigePulse{0%,100%{opacity:0.7}50%{opacity:1}}.shop-item.prestige-item{border-color:#ff6600;background:rgba(255,100,0,0.15)}.shop-item.prestige-item:hover{border-color:#ff9900;box-shadow:0 0 25px rgba(255,150,0,0.5);transform:translateY(-5px) scale(1.02)}.shop-item.prestige-item .shop-item-icon{filter:drop-shadow(0 0 5px #ff6600)}.shop-item.prestige-item .shop-item-level{color:#ff9900}.equip-toast{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:linear-gradient(135deg,rgba(0,255,136,0.95),rgba(0,200,100,0.95));border:3px solid #00ff88;border-radius:15px;padding:20px 40px;font-family:'Bungee',cursive;font-size:28px;color:#fff;text-shadow:2px 2px 4px rgba(0,0,0,0.5);box-shadow:0 0 30px rgba(0,255,136,0.6);z-index:200;animation:equipToastIn 0.3s ease-out forwards;display:flex;align-items:center;gap:15px}.equip-toast.hiding{animation:equipToastOut 0.3s ease-in forwards}.equip-emoji{font-size:40px;animation:equipEmojiPulse 0.5s ease-in-out infinite}@keyframes equipToastIn{0%{opacity:0;transform:translate(-50%,-50%) scale(0.5)}100%{opacity:1;transform:translate(-50%,-50%) scale(1)}}@keyframes equipToastOut{0%{opacity:1;transform:translate(-50%,-50%) scale(1)}100%{opacity:0;transform:translate(-50%,-50%) scale(1.2)}}@keyframes equipEmojiPulse{0%,100%{transform:scale(1)}50%{transform:scale(1.2)}}#continue-btn{margin-top:20px;font-size:24px;padding:15px 50px}#minigame-screen{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.95);display:none;flex-direction:column;justify-content:center;align-items:center;z-index:150;cursor:crosshair;pointer-events:none}#minigame-screen.hud-mode{background:transparent;justify-content:flex-start;padding-top:80px;pointer-events:none}#minigame-screen.hud-mode h1{font-size:28px;margin-bottom:10px;animation:vulnerablePulse 0.5s ease-in-out infinite}#minigame-screen.hud-mode #minigame-instructions{margin-bottom:10px;font-size:12px}#minigame-screen.hud-mode #minigame-timer{font-size:36px;margin-top:5px}#minigame-screen.hud-mode #minigame-hits{font-size:18px;margin-top:5px}@keyframes vulnerablePulse{0%,100%{text-shadow:0 0 20px #ff3333,0 0 40px #ff3333}50%{text-shadow:0 0 40px #ff3333,0 0 80px #ff3333}}#minigame-screen h1{font-family:'Bungee',cursive;font-size:36px;color:#ff3333;text-shadow:0 0 20px #ff3333;margin-bottom:20px}#minigame-instructions{font-family:'Press Start 2P',monospace;font-size:14px;color:#ffcc00;margin-bottom:30px;text-align:center;text-shadow:0 0 10px #000,0 0 20px #000}#minigame-area{width:min(600px,90vw);height:min(400px,50vh);background:#111;border:3px solid #ff3333;border-radius:10px;position:relative;overflow:hidden}.minigame-target{position:absolute;width:60px;height:60px;border-radius:50%;background:radial-gradient(circle,#ff0000,#aa0000);border:3px solid #fff;cursor:crosshair;display:flex;justify-content:center;align-items:center;font-size:30px;animation:targetPulse 0.5s ease-in-out infinite;pointer-events:auto}#minigame-timer{font-family:'Bungee',cursive;font-size:48px;color:#00ffff;margin-top:20px;text-shadow:0 0 10px #000,0 0 20px #00ffff}#minigame-hits{font-family:'Orbitron',sans-serif;font-size:24px;color:#00ff88;margin-top:10px;text-shadow:0 0 10px #000,0 0 15px #00ff88}#game-over{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.95);display:none;flex-direction:column;justify-content:center;align-items:center;z-index:100}#death-receipt{background:#111;border:3px solid #ff3333;border-radius:15px;padding:30px 40px;max-width:450px;text-align:center;box-shadow:0 0 30px rgba(255,0,0,0.5),inset 0 0 50px rgba(0,0,0,0.5)}.receipt-header h1{font-family:'Bungee',cursive;font-size:32px;color:#ff3333;text-shadow:0 0 20px #ff3333;margin:0 0 5px 0;animation:gameOverShake 0.5s ease-in-out infinite}.receipt-subtitle{font-family:'Press Start 2P',monospace;font-size:10px;color:#888;letter-spacing:2px}.receipt-divider{font-family:monospace;color:#444;margin:15px 0;font-size:12px}.receipt-stats{text-align:left}.receipt-row{display:flex;justify-content:space-between;font-family:'Orbitron',sans-serif;font-size:14px;color:#ccc;margin:8px 0}.receipt-row span:last-child{color:#00ff88;font-weight:bold}.receipt-rating{margin:20px 0}.rating-label{font-family:'Press Start 2P',monospace;font-size:10px;color:#888;margin-bottom:10px}.rating-value{font-family:'Bungee',cursive;font-size:36px;color:#ffd700;text-shadow:0 0 15px #ffd700}.receipt-lastwords{margin:15px 0}.lastwords-label{font-family:'Press Start 2P',monospace;font-size:10px;color:#888;margin-bottom:8px}.lastwords-text{font-family:'Orbitron',sans-serif;font-size:14px;color:#ff6b6b;font-style:italic}.receipt-tip{margin:15px 0;padding:10px;background:linear-gradient(135deg,rgba(0,255,136,0.1),rgba(0,200,100,0.05));border-radius:8px;border:1px solid rgba(0,255,136,0.3)}.tip-label{font-family:'Press Start 2P',monospace;font-size:10px;color:#00ff88;margin-bottom:8px;text-shadow:0 0 5px #00ff88}.tip-text{font-family:'Orbitron',sans-serif;font-size:13px;color:#88ffbb;line-height:1.4}.receipt-buttons{display:flex;gap:15px;justify-content:center;margin-top:20px}@keyframes titlePulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}@keyframes hitMarkerFade{0%{opacity:1;transform:translate(-50%,-50%) scale(1.2)}100%{opacity:0;transform:translate(-50%,-50%) scale(1)}}@keyframes killStreakAnimate{0%{opacity:0;transform:translate(-50%,-50%) scale(0.5)}15%{opacity:1;transform:translate(-50%,-50%) scale(1.3)}30%{transform:translate(-50%,-50%) scale(1)}70%{opacity:1}100%{opacity:0;transform:translate(-50%,-50%) scale(1.1)}}@keyframes achievementSlideIn{0%{opacity:0;transform:translateX(100%)}100%{opacity:1;transform:translateX(0)}}@keyframes achievementSlideOut{0%{opacity:1;transform:translateX(0)}100%{opacity:0;transform:translateX(100%)}}@keyframes bossDarken{0%{background:rgba(0,0,0,0)}100%{background:rgba(0,0,0,0.8)}}@keyframes bossSlideIn{0%{opacity:0;transform:translateY(-200px) scale(0.5)}70%{transform:translateY(20px) scale(1.2)}100%{opacity:1;transform:translateY(0) scale(1)}}@keyframes bossNameReveal{0%{opacity:0;transform:scale(0.5);letter-spacing:20px}100%{opacity:1;transform:scale(1);letter-spacing:5px}}@keyframes bossTitleReveal{0%{opacity:0;transform:translateY(20px)}100%{opacity:1;transform:translateY(0)}}@keyframes bossFlash{0%{opacity:0.8}100%{opacity:0}}@keyframes killSlide{from{transform:translateX(100px);opacity:0}to{transform:translateX(0);opacity:1}}@keyframes gameOverShake{0%,100%{transform:translateX(0)}25%{transform:translateX(-3px)}75%{transform:translateX(3px)}}@keyframes shopkeeperBob{0%,100%{transform:translateY(0)}50%{transform:translateY(-5px)}}@keyframes targetPulse{0%,100%{transform:scale(1)}50%{transform:scale(1.1)}}@keyframes comboPulse{0%{transform:scale(1.3)}100%{transform:scale(1)}}@keyframes womboComboShake{0%,100%{transform:translateX(0) rotate(0deg)}25%{transform:translateX(-3px) rotate(-2deg)}75%{transform:translateX(3px) rotate(2deg)}}@keyframes womboComboAnim{0%{transform:translate(-50%,-50%) scale(0);opacity:0}20%{transform:translate(-50%,-50%) scale(1.3);opacity:1}40%{transform:translate(-50%,-50%) scale(1)}80%{opacity:1}100%{transform:translate(-50%,-50%) scale(1.1);opacity:0}}#deep-fried-toggle{margin:20px 0;text-align:center}.toggle-btn{font-family:'Bungee',cursive;font-size:20px;padding:15px 30px;background:linear-gradient(180deg,#444,#222);color:#fff;border:3px solid #666;border-radius:10px;cursor:pointer;transition:all 0.2s;display:flex;align-items:center;gap:15px;margin:0 auto;pointer-events:auto}.toggle-btn:hover{border-color:#ffd700;transform:translateY(-2px);box-shadow:0 5px 20px rgba(255,215,0,0.3)}.toggle-btn.active{background:linear-gradient(180deg,#ff6600,#cc3300);border-color:#ff8800;box-shadow:0 0 30px rgba(255,136,0,0.5);animation:deepFriedPulse 0.5s ease-in-out infinite}.toggle-emoji{font-size:32px}.toggle-text{text-shadow:2px 2px 0 #000}.toggle-desc{font-family:'Press Start 2P',monospace;font-size:10px;color:#888;margin-top:10px}#background-memes-toggle{margin:10px 0;text-align:center}#background-memes-btn.active{background:linear-gradient(180deg,#6b5b95,#4a4063);border-color:#9b89b3;box-shadow:0 0 20px rgba(107,91,149,0.5)}#game-container.deep-fried{filter:saturate(3) contrast(1.5) brightness(1.2)}#game-container.deep-fried #game-canvas{animation:chromaticAberration 0.1s infinite}#chromatic-overlay{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:5;opacity:0;mix-blend-mode:screen}#game-container.deep-fried #chromatic-overlay{opacity:0.15;background:linear-gradient(90deg,rgba(255,0,0,0.3) 0%,rgba(0,255,0,0.3) 50%,rgba(0,0,255,0.3) 100%);animation:chromaticShift 0.2s infinite}#lens-flare-container{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:55;overflow:hidden}.lens-flare{position:absolute;font-size:48px;pointer-events:none;animation:lensFlareAnim 1s ease-out forwards;text-shadow:0 0 20px #fff,0 0 40px #ff0;filter:saturate(3) brightness(1.5)}#game-container.deep-fried .stat-value,#game-container.deep-fried .stat-label,#game-container.deep-fried #weapon-name,#game-container.deep-fried #wave-display{animation:textDistort 0.1s infinite;text-shadow:2px 0 #ff0000,-2px 0 #00ff00,0 2px #0000ff,0 0 10px currentColor}@keyframes deepFriedPulse{0%,100%{box-shadow:0 0 30px rgba(255,136,0,0.5)}50%{box-shadow:0 0 50px rgba(255,136,0,0.8)}}@keyframes chromaticAberration{0%{transform:translate(0,0)}25%{transform:translate(1px,-1px)}50%{transform:translate(-1px,1px)}75%{transform:translate(1px,1px)}100%{transform:translate(0,0)}}@keyframes chromaticShift{0%{transform:translateX(-2px)}50%{transform:translateX(2px)}100%{transform:translateX(-2px)}}@keyframes textDistort{0%{transform:skewX(0deg)}25%{transform:skewX(1deg)}50%{transform:skewX(-1deg)}75%{transform:skewX(0.5deg)}100%{transform:skewX(0deg)}}@keyframes lensFlareAnim{0%{opacity:1;transform:translate(-50%,-50%) scale(0.5) rotate(0deg)}50%{opacity:1;transform:translate(-50%,-50%) scale(1.5) rotate(180deg)}100%{opacity:0;transform:translate(-50%,-50%) scale(2) rotate(360deg)}}#twitch-chat-container{position:absolute;bottom:180px;right:20px;width:min(280px,35vw);max-height:250px;background:rgba(24,24,27,0.85);border:2px solid #9147ff;border-radius:8px;display:flex;flex-direction:column;pointer-events:none;z-index:65;overflow:hidden;box-shadow:0 0 15px rgba(145,71,255,0.3)}#twitch-chat-header{display:flex;align-items:center;gap:8px;padding:8px 12px;background:linear-gradient(90deg,#9147ff,#772ce8);border-bottom:1px solid #9147ff}.twitch-icon{font-size:16px}.twitch-title{font-family:'Press Start 2P',monospace;font-size:10px;color:#fff;flex:1;text-shadow:0 0 5px rgba(255,255,255,0.5)}.twitch-viewers{font-family:'Orbitron',sans-serif;font-size:11px;color:#efeff1}#twitch-chat{flex:1;overflow-y:hidden;padding:8px;display:flex;flex-direction:column;gap:4px}.twitch-chat-message{font-family:'Orbitron',sans-serif;font-size:12px;color:#efeff1;padding:4px 6px;background:rgba(0,0,0,0.3);border-radius:4px;animation:chatMessageSlide 0.3s ease-out;word-wrap:break-word;line-height:1.4}.twitch-chat-message.fading{animation:chatMessageFade 0.5s ease-out forwards}.twitch-chat-username{font-weight:bold;margin-right:4px}.twitch-chat-text{color:#fff}@keyframes chatMessageSlide{0%{opacity:0;transform:translateX(20px)}100%{opacity:1;transform:translateX(0)}}@keyframes chatMessageFade{0%{opacity:1;transform:translateY(0)}100%{opacity:0;transform:translateY(-10px)}}@media screen and (max-width:1024px){.hud-corner{padding:15px}.stat-label{font-size:8px;letter-spacing:1px}#coins-display{font-size:22px}#wave-display{font-size:20px}#weapon-name{font-size:16px}.kill-entry{font-size:8px;padding:6px 10px}#combo-counter{font-size:24px;top:140px}.kill-streak-announcement{font-size:48px}.achievement-toast{padding:10px 15px}.achievement-title{font-size:12px}.achievement-name{font-size:10px}#boss-name{font-size:18px}.boss-tutorial-content{padding:20px 30px;max-width:90vw}.boss-tutorial-content h2{font-size:24px}.boss-tutorial-content .tutorial-text{font-size:14px}#shop-screen{padding:20px}#shop-screen h1{font-size:36px}#shopkeeper-container{padding:12px 18px;max-width:90vw}#shopkeeper-emoji{font-size:60px}#shopkeeper-dialogue{font-size:12px}.shop-section h2{font-size:20px}.game-btn{font-size:24px;padding:15px 40px}#twitch-chat-container{bottom:140px;max-height:180px}.twitch-chat-message{font-size:10px}}@media screen and (max-width:768px){.hud-corner{padding:10px}.top-right{top:60px}.stat-label{font-size:7px}#coins-display{font-size:18px}#wave-display{font-size:16px}#weapon-name{font-size:14px}#weapon-stats{font-size:10px !important}#kill-feed{display:none}#combo-counter{font-size:20px;top:120px;left:10px}.kill-streak-announcement{font-size:36px;letter-spacing:2px}#achievement-container{top:10px;right:10px}.achievement-toast{padding:8px 12px;gap:10px}.achievement-icon{font-size:24px}.achievement-title{font-size:10px}.achievement-name{font-size:8px}#boss-health-container{top:60px}#boss-name{font-size:14px}#boss-health-bar-bg{height:18px}#boss-phase-label,#boss-phase-3-label{font-size:8px;top:-18px}.boss-tutorial-content{padding:15px 20px}.boss-tutorial-content h2{font-size:20px}.boss-tutorial-content .tutorial-icon{font-size:40px}.boss-tutorial-content .tutorial-text{font-size:12px}.boss-tutorial-content .tutorial-hint{font-size:9px}#boss-tutorial-btn{font-size:14px;padding:10px 30px}#shop-indicator{padding:10px 20px;bottom:40px}.shop-indicator-icon{font-size:24px}.shop-indicator-text{font-size:16px}.shop-indicator-key{font-size:12px}.enemy-card div[style*="font-size:80px"]{font-size:50px !important}.enemy-card h3{font-size:10px}#skin-selector{padding:15px;margin:15px 0}#skin-selector h3{font-size:14px}.skin-option{padding:10px;width:90px}.skin-emoji{font-size:35px}.skin-name{font-size:8px}#volume-control{padding:10px 15px;flex-wrap:wrap;justify-content:center}#volume-slider{width:120px}.toggle-btn{font-size:16px;padding:12px 20px}.toggle-emoji{font-size:24px}.toggle-desc{font-size:8px}.game-btn{font-size:20px;padding:12px 30px}.controls-info{font-size:8px;line-height:1.8}#shop-screen{padding:15px}#shop-screen h1{font-size:28px}#shop-coins{font-size:22px}#shopkeeper-container{flex-direction:column;text-align:center;gap:10px}#shopkeeper-emoji{font-size:50px}#shopkeeper-dialogue{font-size:11px;max-width:100%}.shop-section{margin-bottom:20px}.shop-section h2{font-size:18px}.shop-items{justify-content:center}.shop-item-icon{font-size:36px}.shop-item-name{font-size:12px}.shop-item-desc{font-size:9px}.shop-item-price{font-size:14px}#continue-btn{font-size:20px;padding:12px 40px}#minigame-screen h1{font-size:28px}#minigame-instructions{font-size:11px}#minigame-timer{font-size:36px}#minigame-hits{font-size:18px}#death-receipt{padding:20px 25px;max-width:90vw}.receipt-header h1{font-size:24px}.receipt-subtitle{font-size:8px}.receipt-row{font-size:12px}.rating-value{font-size:28px}.receipt-buttons{flex-direction:column;gap:10px}.receipt-buttons .game-btn{width:100%}#twitch-chat-container{display:none}#boss-phase-emoji{font-size:80px}#boss-phase-number{font-size:32px}#boss-phase-title{font-size:12px}}@media screen and (max-width:480px){.hud-corner{padding:8px}.stat-value{font-size:18px !important}.stat-label{font-size:6px}#health-bar-container{height:22px}#coins-display{font-size:16px}#wave-display{font-size:14px}.bottom-left{max-width:45vw}.bottom-right{max-width:45vw}#weapon-name{font-size:12px}#combo-counter{font-size:16px}.kill-streak-announcement{font-size:28px}#achievement-container{width:min(200px,50vw)}.achievement-toast{padding:6px 10px;gap:8px}.achievement-icon{font-size:20px}.enemy-preview{gap:10px}.enemy-card{min-width:80px;padding:8px}#start-screen h1{margin-bottom:10px}#start-screen h2{margin-bottom:20px}.controls-info{margin-top:20px}#shop-screen h1{font-size:22px}.prestige-info{font-size:8px}#death-receipt{padding:15px 18px}.receipt-header h1{font-size:20px}.receipt-row{font-size:11px}.rating-value{font-size:24px}.tip-text{font-size:11px}}#santa-hat-easter{position:absolute;top:20px;right:20px;font-size:60px;cursor:pointer;user-select:none;transition:transform 0.1s,filter 0.3s;z-index:100;filter:drop-shadow(0 0 5px rgba(255,0,0,0.5))}#santa-hat-easter:hover{filter:drop-shadow(0 0 15px rgba(255,215,0,0.8))}@keyframes dripUnlock{0%{transform:scale(1);filter:drop-shadow(0 0 5px rgba(255,0,0,0.5))}25%{transform:scale(1.5);filter:drop-shadow(0 0 30px rgba(0,255,255,1)) hue-rotate(90deg)}50%{transform:scale(1.2);filter:drop-shadow(0 0 20px rgba(255,0,255,1)) hue-rotate(180deg)}75%{transform:scale(1.4);filter:drop-shadow(0 0 25px rgba(0,255,255,1)) hue-rotate(270deg)}100%{transform:scale(1);filter:drop-shadow(0 0 15px rgba(0,255,255,0.8))}}.easter-egg-toast{display:flex;gap:15px;background:linear-gradient(135deg,#6b1d5c 0%,#3d0f3d 100%);border:3px solid #ff69b4;border-radius:10px;padding:15px 20px;margin-bottom:10px;animation:easterEggSlide 0.5s ease-out,easterEggGlow 1s ease-in-out infinite;box-shadow:0 0 30px rgba(255,105,180,0.5)}.easter-egg-toast.hiding{animation:achievementFade 0.5s ease-out forwards}.easter-egg-icon{font-size:40px;display:flex;align-items:center;animation:easterEggIconSpin 1s ease-in-out infinite}.easter-egg-content{display:flex;flex-direction:column;justify-content:center}.easter-egg-title{font-family:'Press Start 2P',monospace;font-size:10px;color:#ff69b4;text-shadow:0 0 10px #ff69b4;margin-bottom:5px}.easter-egg-name{font-family:'Bungee',cursive;font-size:18px;color:#fff;text-shadow:2px 2px 0 #000}.easter-egg-effect{font-family:'Orbitron',sans-serif;font-size:12px;color:#ffb6c1;margin-top:5px}@keyframes easterEggSlide{0%{transform:translateX(100px) scale(0.5);opacity:0}100%{transform:translateX(0) scale(1);opacity:1}}@keyframes easterEggGlow{0%,100%{box-shadow:0 0 30px rgba(255,105,180,0.5)}50%{box-shadow:0 0 50px rgba(255,105,180,0.8),0 0 80px rgba(255,105,180,0.3)}}@keyframes easterEggIconSpin{0%,100%{transform:rotate(-5deg) scale(1)}50%{transform:rotate(5deg) scale(1.1)}}.morbin-announcement{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);z-index:1000;pointer-events:none;animation:morbinEntry 0.5s ease-out}.morbin-announcement.fade-out{animation:morbinExit 0.5s ease-out forwards}.morbin-text{font-family:'Bungee',cursive;font-size:72px;color:#8b0000;text-shadow:4px 4px 0 #000,-2px -2px 0 #500,0 0 30px #800,0 0 60px #600;animation:morbinPulse 0.3s ease-in-out infinite}@keyframes morbinEntry{0%{transform:translate(-50%,-50%) scale(0) rotate(-20deg);opacity:0}100%{transform:translate(-50%,-50%) scale(1) rotate(0deg);opacity:1}}@keyframes morbinExit{0%{transform:translate(-50%,-50%) scale(1);opacity:1}100%{transform:translate(-50%,-50%) scale(2);opacity:0}}@keyframes morbinPulse{0%,100%{text-shadow:4px 4px 0 #000,-2px -2px 0 #500,0 0 30px #800,0 0 60px #600}50%{text-shadow:4px 4px 0 #000,-2px -2px 0 #500,0 0 50px #a00,0 0 100px #800}}.nice-announcement{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);z-index:1000;pointer-events:none;animation:niceEntry 0.3s ease-out}.nice-announcement.fade-out{animation:niceExit 0.5s ease-out forwards}.nice-text{font-family:'Bungee',cursive;font-size:96px;color:#ff69b4;text-shadow:4px 4px 0 #000,0 0 20px #ff69b4,0 0 40px #ff1493;animation:niceWiggle 0.5s ease-in-out infinite}@keyframes niceEntry{0%{transform:translate(-50%,-50%) scale(0);opacity:0}50%{transform:translate(-50%,-50%) scale(1.2)}100%{transform:translate(-50%,-50%) scale(1);opacity:1}}@keyframes niceExit{0%{transform:translate(-50%,-50%) scale(1);opacity:1}100%{transform:translate(-50%,-50%) scale(0.5);opacity:0}}@keyframes niceWiggle{0%,100%{transform:rotate(-2deg)}50%{transform:rotate(2deg)}}#mobile-controls{display:none;position:absolute;bottom:20px;left:0;right:0;padding:0 20px;pointer-events:none;z-index:90;justify-content:space-between;align-items:flex-end}#mobile-controls.visible{display:flex}.mobile-btn{display:flex;flex-direction:column;align-items:center;justify-content:center;width:80px;height:80px;background:rgba(0,0,0,0.7);border:3px solid #ff6b6b;border-radius:50%;pointer-events:auto;touch-action:manipulation;user-select:none;-webkit-user-select:none;transition:transform 0.1s,box-shadow 0.1s,background 0.1s}.mobile-btn:active,.mobile-btn.active{transform:scale(0.95);background:rgba(255,107,107,0.5);box-shadow:0 0 20px rgba(255,107,107,0.8)}.mobile-btn-icon{font-size:32px;line-height:1}.mobile-btn-label{font-family:'Press Start 2P',monospace;font-size:8px;color:#fff;margin-top:4px;text-shadow:1px 1px 0 #000}#mobile-fire-btn{width:100px;height:100px;border-color:#ff3333;background:linear-gradient(135deg,rgba(255,51,51,0.6),rgba(200,0,0,0.4));box-shadow:0 0 15px rgba(255,51,51,0.5)}#mobile-fire-btn:active,#mobile-fire-btn.active{background:linear-gradient(135deg,rgba(255,100,100,0.8),rgba(255,51,51,0.6));box-shadow:0 0 30px rgba(255,51,51,1)}#mobile-fire-btn .mobile-btn-icon{font-size:40px}#mobile-fire-btn .mobile-btn-label{font-size:10px}#mobile-heal-btn{border-color:#00ff88;background:linear-gradient(135deg,rgba(0,255,136,0.3),rgba(0,150,80,0.2))}#mobile-heal-btn.ready{box-shadow:0 0 20px rgba(0,255,136,0.8);animation:healBtnPulse 1s ease-in-out infinite}#mobile-heal-btn.disabled{opacity:0.5;border-color:#444;background:rgba(0,0,0,0.5)}#mobile-heal-btn:active,#mobile-heal-btn.active{background:rgba(0,255,136,0.5)}@keyframes healBtnPulse{0%,100%{box-shadow:0 0 15px rgba(0,255,136,0.6)}50%{box-shadow:0 0 30px rgba(0,255,136,1)}}#mobile-shop-btn{border-color:#ffd700;background:linear-gradient(135deg,rgba(255,215,0,0.3),rgba(200,160,0,0.2))}#mobile-shop-btn.ready{box-shadow:0 0 20px rgba(255,215,0,0.8);animation:shopBtnPulse 1s ease-in-out infinite}#mobile-shop-btn.disabled{opacity:0.5;border-color:#444;background:rgba(0,0,0,0.5)}#mobile-shop-btn:active,#mobile-shop-btn.active{background:rgba(255,215,0,0.5)}@keyframes shopBtnPulse{0%,100%{box-shadow:0 0 15px rgba(255,215,0,0.6)}50%{box-shadow:0 0 30px rgba(255,215,0,1)}}body.touch-device{cursor:default;touch-action:manipulation;-webkit-touch-callout:none;-webkit-user-select:none;user-select:none}body.touch-device #crosshair{transform:translate(-50%,-50%) scale(1.2)}body.touch-device *{-webkit-tap-highlight-color:transparent}@media screen and (max-width:768px){#mobile-controls.visible{display:flex}.mobile-btn{width:70px;height:70px}.mobile-btn-icon{font-size:28px}.mobile-btn-label{font-size:7px}#mobile-fire-btn{width:85px;height:85px}#mobile-fire-btn .mobile-btn-icon{font-size:35px}#mobile-fire-btn .mobile-btn-label{font-size:9px}.bottom-left{bottom:110px}.bottom-right{bottom:110px}}@media screen and (max-width:480px){#mobile-controls{padding:0 10px;bottom:15px}.mobile-btn{width:60px;height:60px}.mobile-btn-icon{font-size:24px}.mobile-btn-label{font-size:6px}#mobile-fire-btn{width:75px;height:75px}#mobile-fire-btn .mobile-btn-icon{font-size:30px}#mobile-fire-btn .mobile-btn-label{font-size:8px}.bottom-left{bottom:90px}.bottom-right{bottom:90px}}@media screen and (max-height:500px) and (orientation:landscape){#mobile-controls{bottom:10px;padding:0 15px}.mobile-btn{width:55px;height:55px}.mobile-btn-icon{font-size:22px}.mobile-btn-label{display:none}#mobile-fire-btn{width:65px;height:65px}#mobile-fire-btn .mobile-btn-icon{font-size:28px}.bottom-left,.bottom-right{bottom:75px}.hud-corner{padding:8px}.stat-value{font-size:16px !important}}.dank-flash{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,255,0,0.5);z-index:999;pointer-events:none;animation:dankFlash 3s ease-out forwards}.dank-announcement{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);z-index:1000;pointer-events:none;text-align:center;animation:dankEntry 0.5s ease-out}.dank-announcement.fade-out{animation:dankExit 0.5s ease-out forwards}.dank-text{font-family:'Bungee',cursive;font-size:120px;color:#00ff00;text-shadow:4px 4px 0 #000,0 0 30px #0f0,0 0 60px #0a0,0 0 90px #080;animation:dankPulse 0.2s ease-in-out infinite}.dank-subtext{font-family:'Press Start 2P',monospace;font-size:16px;color:#90EE90;text-shadow:0 0 10px #0f0;margin-top:20px}@keyframes dankFlash{0%{background:rgba(0,255,0,0.8)}20%{background:rgba(0,255,0,0.3)}40%{background:rgba(0,255,0,0.5)}100%{background:rgba(0,255,0,0)}}@keyframes dankEntry{0%{transform:translate(-50%,-50%) scale(0) rotate(-180deg);opacity:0}100%{transform:translate(-50%,-50%) scale(1) rotate(0deg);opacity:1}}@keyframes dankExit{0%{transform:translate(-50%,-50%) scale(1);opacity:1}100%{transform:translate(-50%,-50%) scale(3);opacity:0}}@keyframes dankPulse{0%,100%{filter:hue-rotate(0deg)}50%{filter:hue-rotate(30deg)}}</style>
</head>
<body>
    <div id="game-container">
        <canvas id="game-canvas"></canvas>
        <div id="chromatic-overlay"></div>
        <div id="lens-flare-container"></div>

        <div id="hud">
            <div class="hud-corner top-left">
                <div class="stat-label">SCORE</div>
                <div class="stat-value" id="score">0</div>
                <div style="margin-top: 10px;">
                    <div class="stat-label">COINS</div>
                    <div id="coins-display">ü™ô 0</div>
                </div>
            </div>

            <div class="hud-corner top-right">
                <div class="stat-label">WAVE</div>
                <div id="wave-display">WAVE 1</div>
                <div style="margin-top: 10px;">
                    <div class="stat-label">KILLS</div>
                    <div class="stat-value" id="kills" style="font-size: 24px;">0</div>
                </div>
            </div>

            <div class="hud-corner bottom-left">
                <div class="stat-label">HEALTH</div>
                <div id="health-bar-container">
                    <div id="health-bar" style="width: 100%;"></div>
                </div>
                <div style="margin-top: 15px;">
                    <div class="stat-label">AMMO</div>
                    <div id="ammo-display" style="font-size: clamp(20px, 5vw, 32px); color: #00ffff; text-shadow: 0 0 10px #00ffff;">‚àû</div>
                </div>
                <div style="margin-top: 15px;">
                    <div class="stat-label">HEALING POWER [E]</div>
                    <div id="heal-power-container" style="width: min(200px, 35vw); height: 20px; background: rgba(0,0,0,0.7); border: 2px solid #00ff00; border-radius: 5px; overflow: hidden;">
                        <div id="heal-power-bar" style="height: 100%; width: 0%; background: linear-gradient(90deg, #00ff00, #88ff88); transition: width 0.3s;"></div>
                    </div>
                    <div id="heal-power-text" style="font-size: clamp(10px, 2vw, 14px); color: #00ff00; margin-top: 5px;">0 / 10 kills</div>
                </div>
            </div>

            <div class="hud-corner bottom-right">
                <div class="stat-label">WEAPON</div>
                <div id="weapon-name">üéÅ PRESENT LAUNCHER</div>
                <div id="weapon-stats" style="font-size: 12px; color: #888; margin-top: 5px;"></div>
            </div>

            <div id="crosshair">
                <div class="crosshair-line crosshair-h ch-left"></div>
                <div class="crosshair-line crosshair-h ch-right"></div>
                <div class="crosshair-line crosshair-v ch-top"></div>
                <div class="crosshair-line crosshair-v ch-bottom"></div>
                <div id="crosshair-dot"></div>
            </div>

            <div id="kill-feed"></div>
            <div id="combo-counter"></div>
            <div id="achievement-container"></div>

            <!-- Mobile Touch Controls -->
            <div id="mobile-controls">
                <div id="mobile-fire-btn" class="mobile-btn">
                    <span class="mobile-btn-icon">üéØ</span>
                    <span class="mobile-btn-label">FIRE</span>
                </div>
                <div id="mobile-heal-btn" class="mobile-btn">
                    <span class="mobile-btn-icon">üíö</span>
                    <span class="mobile-btn-label">HEAL</span>
                </div>
                <div id="mobile-shop-btn" class="mobile-btn">
                    <span class="mobile-btn-icon">üõí</span>
                    <span class="mobile-btn-label">SHOP</span>
                </div>
            </div>

            <!-- Fake Twitch Chat -->
            <div id="twitch-chat-container">
                <div id="twitch-chat-header">
                    <span class="twitch-icon">üì∫</span>
                    <span class="twitch-title">LIVE CHAT</span>
                    <span class="twitch-viewers">üëÅÔ∏è <span id="viewer-count">420</span></span>
                </div>
                <div id="twitch-chat"></div>
            </div>

            <!-- Boss Intro Cutscene Overlay -->
            <div id="boss-intro-overlay">
                <div id="boss-intro-emoji">üëë</div>
                <div id="boss-intro-name">BOSS NAME</div>
                <div id="boss-intro-title">Boss Title</div>
                <div id="boss-intro-flash"></div>
            </div>

            <div id="boss-health-container">
                <div id="boss-name">üíÄ MEGA BOSS üíÄ</div>
                <div id="boss-health-bar-bg">
                    <div id="boss-health-bar" style="width: 100%;"></div>
                    <!-- TASK-020: Phase markers at 50% and 25% -->
                    <div id="boss-phase-marker" title="Phase 2 at 50%"></div>
                    <div id="boss-phase-label">‚ö†Ô∏è PHASE 2</div>
                    <div id="boss-phase-3-marker" title="Final Phase at 25%"></div>
                    <div id="boss-phase-3-label">üî• FINAL</div>
                </div>
            </div>

            <!-- TASK-020: Boss Phase Transition Overlay -->
            <div id="boss-phase-overlay">
                <div id="boss-phase-emoji">üòé</div>
                <div id="boss-phase-number">PHASE 2</div>
                <div id="boss-phase-title">SUNGLASSES MODE ACTIVATED</div>
                <div id="boss-phase-flash"></div>
            </div>
        </div>

        <div id="damage-overlay"></div>
        <div id="muzzle-flash"></div>
        <div id="wave-announcement"></div>

        <!-- Boss Tutorial (UX-004) -->
        <div id="boss-tutorial">
            <div class="boss-tutorial-content">
                <h2>BOSS INCOMING!</h2>
                <div class="tutorial-icon">üëëü¶ñ</div>
                <p class="tutorial-text">At <span class="highlight">50% HP</span>, the boss becomes <span class="highlight">VULNERABLE</span>!</p>
                <p class="tutorial-text">Shoot the <span class="highlight">üéØ WEAK POINTS</span> that appear to deal bonus damage!</p>
                <p class="tutorial-hint">Keep shooting - the game won't pause!</p>
                <button id="boss-tutorial-btn" class="game-btn">GOT IT!</button>
            </div>
        </div>

        <!-- Shop Available Indicator (UX-003) -->
        <div id="shop-indicator">
            <span class="shop-indicator-icon">üõí</span>
            <span class="shop-indicator-text">SHOP AVAILABLE!</span>
            <span class="shop-indicator-key">[R]</span>
        </div>

        <!-- Start Screen -->
        <div id="start-screen">
            <h1>ü¶ñ DINO DOOM ü¶ñ</h1>
            <h2>üéÖ Santa's Last Stand Against The Buff Dinos! üéÖ</h2>

            <div class="enemy-preview">
                <div class="enemy-card">
                    <div class="enemy-card-emoji">ü¶ñ</div>
                    <h3>GIGACHAD DINO</h3>
                    <p style="color: #ff6b6b; font-size: clamp(9px, 1.5vw, 12px); margin-top: 5px;">ULTRA SWOLE ‚Ä¢ SLOW</p>
                </div>
                <div class="enemy-card">
                    <div class="enemy-card-emoji">ü§ìü¶ï</div>
                    <h3>BUFF NERD DINO</h3>
                    <p style="color: #00ffff; font-size: clamp(9px, 1.5vw, 12px); margin-top: 5px;">BIG BRAIN ‚Ä¢ FAST</p>
                </div>
                <div class="enemy-card">
                    <div class="enemy-card-emoji">üëëü¶ñ</div>
                    <h3>MINI BOSS</h3>
                    <p style="color: #ffd700; font-size: clamp(9px, 1.5vw, 12px); margin-top: 5px;">EVERY 5 WAVES</p>
                </div>
            </div>

            <!-- Santa Skin Selector -->
            <div id="skin-selector">
                <h3>üéÖ SELECT YOUR SANTA üéÖ</h3>
                <div id="skin-options">
                    <!-- Skins populated by JavaScript -->
                </div>
                <div id="skin-coins-display">ü™ô <span id="skin-coins">0</span></div>
            </div>

<!-- Volume Slider -->
            <div id="volume-control">
                <label for="volume-slider">üîä VOLUME</label>
                <input type="range" id="volume-slider" min="0" max="100" value="100">
                <span id="volume-value">100%</span>
            </div>

            <!-- Deep Fried Mode Toggle -->
            <div id="deep-fried-toggle">
                <button id="deep-fried-btn" class="toggle-btn">
                    <span class="toggle-emoji">üçü</span>
                    <span class="toggle-text">DEEP FRIED MODE: OFF</span>
                </button>
                <p class="toggle-desc">Maximum meme saturation for true gamers</p>
            </div>

            <!-- Background Memes Toggle (TASK-019) -->
            <div id="background-memes-toggle">
                <button id="background-memes-btn" class="toggle-btn">
                    <span class="toggle-emoji">üêï</span>
                    <span class="toggle-text">BACKGROUND MEMES: ON</span>
                </button>
                <p class="toggle-desc">Floating meme elements in the background</p>
            </div>

            <button id="start-btn" class="game-btn">üéÆ START GAME üéÆ</button>

            <div class="controls-info" id="desktop-controls">
                <p>MOUSE - AIM CROSSHAIR</p>
                <p>CLICK or SPACEBAR - SHOOT</p>
                <p>E - USE HEALING POWER (10 KILLS TO CHARGE)</p>
                <p>R - OPEN SHOP (BETWEEN WAVES)</p>
            </div>
            <div class="controls-info" id="touch-controls" style="display: none;">
                <p>DRAG ANYWHERE - AIM CROSSHAIR</p>
                <p>TAP FIRE BUTTON - SHOOT</p>
                <p>TAP HEAL BUTTON - USE HEALING POWER</p>
                <p>TAP SHOP BUTTON - OPEN SHOP (BETWEEN WAVES)</p>
            </div>
        </div>

        <!-- Shop Screen -->
        <div id="shop-screen">
            <h1>üíé THE GRINDSET EMPORIUM üíé</h1>
            <div id="shop-coins">ü™ô 0</div>

            <!-- Shopkeeper -->
            <div id="shopkeeper-container">
                <div id="shopkeeper-emoji">üóø</div>
                <div id="shopkeeper-dialogue">Welcome to the grind...</div>
            </div>

            <div class="shop-section">
                <h2>‚öîÔ∏è WEAPONS</h2>
                <div class="shop-items" id="weapons-list"></div>
            </div>

            <div class="shop-section">
                <h2>‚¨ÜÔ∏è UPGRADES</h2>
                <div class="shop-items" id="upgrades-list"></div>
            </div>

            <div class="shop-section prestige-section" id="prestige-upgrades" style="display: none;">
                <h2>üî• PRESTIGE UPGRADES üî•</h2>
                <div class="prestige-info">All basic upgrades maxed! Unlock infinite scaling.</div>
                <div class="shop-items" id="prestige-list"></div>
            </div>

            <button id="continue-btn" class="game-btn green">CONTINUE ‚û°Ô∏è</button>
        </div>

        <!-- Minigame Screen -->
        <div id="minigame-screen">
            <h1>‚öîÔ∏è BOSS VULNERABLE! ‚öîÔ∏è</h1>
            <div id="minigame-instructions">CLICK THE TARGETS TO DAMAGE THE BOSS!</div>
            <div id="minigame-area"></div>
            <div id="minigame-timer">10</div>
            <div id="minigame-hits">HITS: 0 / DAMAGE: 0</div>
        </div>

        <!-- Game Over Screen - Meme Receipt Style -->
        <div id="game-over">
            <div id="death-receipt">
                <div class="receipt-header">
                    <h1>üíÄ SKILL ISSUE DETECTED üíÄ</h1>
                    <div class="receipt-subtitle">DINO DOOM - DEATH RECEIPT</div>
                </div>
                <div class="receipt-divider">‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê</div>
                <div class="receipt-stats">
                    <div class="receipt-row"><span>Waves Survived:</span><span id="stat-waves">0</span></div>
                    <div class="receipt-row"><span>Dinos Eliminated:</span><span id="stat-kills">0</span></div>
                    <div class="receipt-row"><span>Final Score:</span><span id="stat-score">0</span></div>
                    <div class="receipt-row"><span>Coins Earned:</span><span id="stat-coins">0</span></div>
                    <div class="receipt-row"><span>Time Survived:</span><span id="stat-time">0:00</span></div>
                    <div class="receipt-row"><span>Cause of Death:</span><span id="stat-cause">Unknown</span></div>
                </div>
                <div class="receipt-divider">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</div>
                <div class="receipt-rating">
                    <div class="rating-label">PERFORMANCE RATING:</div>
                    <div id="stat-rating" class="rating-value">NPC</div>
                </div>
                <div class="receipt-divider">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</div>
                <div class="receipt-lastwords">
                    <div class="lastwords-label">Last Words:</div>
                    <div id="stat-lastwords" class="lastwords-text">"skill issue"</div>
                </div>
                <div class="receipt-divider">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</div>
                <div class="receipt-tip">
                    <div class="tip-label">üí° PRO TIP:</div>
                    <div id="stat-tip" class="tip-text">Keep moving!</div>
                </div>
                <div class="receipt-divider">‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê</div>
                <div class="receipt-buttons">
                    <button id="copy-receipt-btn" class="game-btn" style="font-size: 16px; padding: 10px 20px;">üìã SHARE YOUR L</button>
                    <button id="restart-btn" class="game-btn green">üîÑ TRY AGAIN</button>
                </div>
            </div>
        </div>
    </div>

    
    <script>(()=>{var c={PLAYER_MOVE_SPEED:5,PLAYER_BASE_DAMAGE:0,PLAYER_BASE_FIRE_RATE:10,PLAYER_BASE_CRIT_CHANCE:.05,PLAYER_CRIT_MULTIPLIER:2,PLAYER_BASE_HEALTH:100,WAVE_BETWEEN_HEAL_AMOUNT:20,BOSS_WAVE_INTERVAL:5,ENEMIES_BASE_COUNT:3,ENEMIES_PER_WAVE:2,ENEMY_SPAWN_DELAY_MS:500,HEAL_KILLS_REQUIRED:10,HEAL_AMOUNT:50,ENEMY_ATTACK_RANGE:120,ENEMY_MIN_Z:-80,ENEMY_MAX_X:500,PROJECTILE_HIT_RADIUS_BASE:60,PROJECTILE_GRAVITY:.05,BOSS_BASE_HEALTH:500,BOSS_HEALTH_PER_WAVE:50,BOSS_SHOOT_COOLDOWN:90,BOSS_FIREBALL_DAMAGE:5,BOSS_MINIGAME_THRESHOLD:.5,MINIGAME_DURATION_SEC:10,MINIGAME_TARGET_SPAWN_INTERVAL:400,MINIGAME_TARGET_LIFETIME:1500,MINIGAME_DAMAGE_PER_HIT:50,BOSS_PHASE_2_THRESHOLD:.5,BOSS_PHASE_3_THRESHOLD:.25,BOSS_PHASE_2_DAMAGE_MULT:1.5,BOSS_PHASE_3_DAMAGE_MULT:2,BOSS_PHASE_2_COOLDOWN_MULT:.75,BOSS_PHASE_3_COOLDOWN_MULT:.5,BOSS_METEOR_DAMAGE:20,BOSS_METEOR_COOLDOWN:60,BOSS_ASCEND_HEIGHT:-60,BOSS_PHASE_TRANSITION_DURATION:2e3,GAMER_RANGED_COOLDOWN:300,GAMER_PROJECTILE_DAMAGE:15,GAMER_PROJECTILE_SPEED:8,SIGMA_DIALOGUE_COOLDOWN_MIN:240,SIGMA_DIALOGUE_COOLDOWN_RANGE:120,SIGMA_ESCAPE_X:600,SIGMA_MAX_PER_WAVE:2,SIGMA_BASE_SPAWN_CHANCE:.04,SIGMA_SPAWN_CHANCE_PER_WAVE:.01,SIGMA_MAX_SPAWN_CHANCE:.12,ENEMY_HEALTH_PER_WAVE:10,KILL_STREAK_TIMEOUT_MS:3e3,PERSPECTIVE_SCALE:400,PERSPECTIVE_MIN_Z:100,SIGMA_SPAWN_X:500,SIGMA_SPAWN_Z_BASE:-400,SIGMA_SPAWN_Z_RANGE:200,ENEMY_SPAWN_X_RANGE:800,ENEMY_SPAWN_Z_BASE:-800,ENEMY_SPAWN_Z_RANGE:500,DIALOGUE_BUBBLE_MAX:2,DIALOGUE_BUBBLE_DURATION:2e3,KILL_FEED_MAX_ENTRIES:5,KILL_FEED_DURATION_MS:3e3,ACHIEVEMENT_TOAST_DURATION_MS:3e3,COMBO_MULTIPLIER_PERCENT:10,WOMBO_COMBO_THRESHOLD:10,COMBO_DECAY_BASE_PERCENT:50,COMBO_DECAY_HIGH_PERCENT:40,COMBO_DECAY_VERY_HIGH_PERCENT:30,COMBO_HIGH_THRESHOLD:10,COMBO_VERY_HIGH_THRESHOLD:20,COMBO_DAMAGE_COOLDOWN_MS:1e3},F={present:{name:"Present Launcher",emoji:"\u{1F381}",damage:35,fireRate:10,speed:20,color:"#ff0000",price:0,description:"Classic gift-giving weapon"},snowball:{name:"Snowball Blaster",emoji:"\u2744\uFE0F",damage:20,fireRate:5,speed:25,color:"#aaddff",price:500,description:"Rapid-fire frozen fury"},candy_cane:{name:"Candy Cane Rifle",emoji:"\u{1F36C}",damage:50,fireRate:20,speed:30,color:"#ff6699",price:1e3,description:"Sweet and powerful"},ornament:{name:"Ornament Grenade",emoji:"\u{1F52E}",damage:80,fireRate:40,speed:15,color:"#9900ff",price:2e3,description:"Explosive decorations"},star:{name:"North Star Beam",emoji:"\u2B50",damage:100,fireRate:30,speed:40,color:"#ffff00",price:5e3,description:"Ultimate guiding light"},moai:{name:"Moai Cannon",emoji:"\u{1F5FF}",damage:70,fireRate:25,speed:18,color:"#8b7355",price:1500,description:"Yo, Angelo",special:"moai"},doot:{name:"Doot Cannon",emoji:"\u{1F3BA}",damage:45,fireRate:15,speed:22,color:"#daa520",price:800,description:"Spooky scary skeletons",special:"doot"}},Z={damage:{name:"Damage+",icon:"\u{1F4AA}",basePrice:200,maxLevel:10,perLevel:10,description:"+10 damage per level"},fireRate:{name:"Fire Rate+",icon:"\u26A1",basePrice:300,maxLevel:5,perLevel:2,description:"-2 cooldown per level"},health:{name:"Max Health+",icon:"\u2764\uFE0F",basePrice:250,maxLevel:10,perLevel:20,description:"+20 max HP per level"},critChance:{name:"Crit Chance+",icon:"\u{1F3AF}",basePrice:400,maxLevel:5,perLevel:.05,description:"+5% crit per level"}},$={overkill:{name:"Overkill",icon:"\u{1F4AA}\u{1F525}",basePrice:2e3,priceIncrease:500,perLevel:.05,description:"+5% damage per level (stacks)"},bulletHell:{name:"Bullet Hell",icon:"\u26A1\u{1F525}",basePrice:2500,priceIncrease:600,perLevel:.05,description:"+5% fire rate per level"},titanHealth:{name:"Titan Health",icon:"\u2764\uFE0F\u{1F525}",basePrice:2e3,priceIncrease:500,perLevel:.1,description:"+10% max HP per level"},criticalMass:{name:"Critical Mass",icon:"\u{1F3AF}\u{1F525}",basePrice:3e3,priceIncrease:700,perLevel:.02,description:"+2% crit chance per level"},coinMagnet:{name:"Coin Magnet",icon:"\u{1FA99}\u2728",basePrice:1500,priceIncrease:400,perLevel:.1,description:"+10% coins per level"}},ft={GIGACHAD:{name:"GIGACHAD DINO",emoji:"\u{1F996}",health:150,damage:25,speed:1.5,size:80,color:"#ff4444",points:200,coins:15,traits:["\u{1F4AA}","\u{1F60E}","\u{1F3CB}\uFE0F"]},BUFF_NERD:{name:"BUFF NERD DINO",emoji:"\u{1F995}",health:80,damage:15,speed:3,size:60,color:"#44ff88",points:100,coins:10,traits:["\u{1F913}","\u{1F4DA}","\u{1F9E0}"]},MINI_BOSS:{name:"DINO OVERLORD",emoji:"\u{1F451}",health:500,damage:10,speed:1,size:120,color:"#ffd700",points:1e3,coins:200,traits:["\u{1F451}","\u{1F480}","\u{1F525}"],isBoss:!0},GAMER_DINO:{name:"GAMER DINO",emoji:"\u{1F995}\u{1F3AE}",health:100,damage:20,speed:2.5,size:70,color:"#ff00ff",points:150,coins:12,traits:["\u{1F3AE}","\u2328\uFE0F","\u{1F5B1}\uFE0F"],isGamer:!0,deathMessages:["GG","EZ","GET GOOD","NO RE","GIT GUD","L + RATIO"]},SIGMA_DINO:{name:"SIGMA DINO",emoji:"\u{1F996}\u{1F454}",health:120,damage:0,speed:1,size:75,color:"#1a1a2e",points:300,coins:36,traits:["\u{1F454}","\u{1F4BC}","\u{1F4C8}"],isSigma:!0,deathMessages:["GRINDSET INTERRUPTED","PASSIVE INCOME STOPPED","SIGMA RULE VIOLATED","BACK TO THE MATRIX"]}},se={default:{name:"Default Santa",emoji:"\u{1F385}",price:0,color:"#ff0000",glowColor:"#ff4444",description:"Classic Santa"},drip:{name:"Drip Santa",emoji:"\u{1F385}\u{1F48E}",price:500,color:"#00ffff",glowColor:"#00ffff",description:"Iced out"},tactical:{name:"Tactical Santa",emoji:"\u{1F385}\u{1F3AF}",price:1e3,color:"#556b2f",glowColor:"#6b8e23",description:"Operator mode"},gigachad:{name:"Gigachad Santa",emoji:"\u{1F385}\u{1F4AA}",price:2500,color:"#ffd700",glowColor:"#ffaa00",description:"Built different"},sigma:{name:"Sigma Santa",emoji:"\u{1F385}\u{1F454}",price:5e3,color:"#1a1a2e",glowColor:"#4a4a6e",description:"On the grind"}},pt={FIRST_BLOOD:{id:"first_blood",name:"FIRST BLOOD",description:"First kill of the game",icon:"\u{1FA78}"},WAVE_SURVIVOR:{id:"wave_survivor",name:"WAVE SURVIVOR",description:"Complete a wave without damage",icon:"\u{1F6E1}\uFE0F"},BUILT_DIFFERENT:{id:"built_different",name:"BUILT DIFFERENT",description:"One-shot a Gigachad",icon:"\u{1F4AA}"},SKILL_ISSUE:{id:"skill_issue",name:"SKILL ISSUE",description:"Die on Wave 1",icon:"\u{1F480}"},EASY_MODE:{id:"easy_mode",name:"IS THIS EASY MODE?",description:"Reach Wave 10 without taking damage",icon:"\u{1F60E}"},BIG_SPENDER:{id:"big_spender",name:"BIG SPENDER",description:"Spend 1000 coins in one shop visit",icon:"\u{1F4B0}"},BOSS_SLAYER:{id:"boss_slayer",name:"BOSS SLAYER",description:"Defeat your first boss",icon:"\u{1F451}"},MEME_LORD:{id:"meme_lord",name:"MEME LORD",description:"Use the Moai Cannon",icon:"\u{1F5FF}"}},Et=[{count:2,name:"DOUBLE KILL",color:"#ffff00"},{count:3,name:"TRIPLE KILL",color:"#ff8800"},{count:4,name:"OVERKILL",color:"#ff4400"},{count:5,name:"KILLTACULAR",color:"#ff00ff"},{count:6,name:"KILLIONAIRE",color:"#00ffff"},{count:7,name:"KILLPOCALYPSE",color:"#ff0000"},{count:10,name:"UNSTOPPABLE",color:"#ffd700"}],ke=[{minScore:0,rating:"Actual NPC",color:"#888888"},{minScore:1e3,rating:"Kinda Mid",color:"#888888"},{minScore:5e3,rating:"Certified Decent",color:"#00ff00"},{minScore:1e4,rating:"Built Different",color:"#00ffff"},{minScore:25e3,rating:"Sigma Energy",color:"#ff00ff"},{minScore:5e4,rating:"GIGACHAD",color:"#ffd700"}],Be=['"skill issue"','"I was lagging"','"my mouse died"','"not my fault"','"rigged game"','"built different (negatively)"','"I let them win"','"calculated L"','"gg ez... wait"','"I blame the dinosaurs"','"Santa needed a break"','"tactical defeat"','"we go next"','"ratio"','"at least I tried"'],Ee={5:{name:"CHADOSAURUS",title:"Never Skips Leg Day",emoji:"\u{1F996}\u{1F4AA}"},10:{name:"PROFESSOR GAINS",title:"PhD in Lifting",emoji:"\u{1F996}\u{1F393}"},15:{name:"THE RATIO KING",title:"Undefeated in Arguments",emoji:"\u{1F996}\u{1F451}"},20:{name:"ZYZZ-REX",title:"Forever Mirin'",emoji:"\u{1F996}\u2728"},25:{name:"FINAL FORM CHAD",title:"We're All Gonna Make It",emoji:"\u{1F996}\u{1F525}"}},gt={GIGACHAD:{spawn:["DO YOU EVEN LIFT, SANTA?","THESE GAINS ARE ETERNAL","MY PROTEIN SHAKE BRINGS ALL THE BOYS","CREATINE-POWERED DESTRUCTION","I'M BUILT DIFFERENT","WITNESS PEAK PERFORMANCE"],attack:["FEEL MY POWER!","GAINS INCOMING!","GET SWOLE'D!","NO PAIN NO GAIN!"]},BUFF_NERD:{spawn:["ACTUALLY...","SKILL ISSUE DETECTED","RATIO + L + NO REINDEER","MY IQ IS OVER 9000","STATISTICALLY, YOU LOSE","I STUDIED THE BLADE"],attack:["CALCULATED!","ACCORDING TO MY DATA...","NERD RAGE!","BRAIN DAMAGE!"]},MINI_BOSS:{spawn:["YOU DARE CHALLENGE ME?!","I'VE BEEN LIFTING SINCE THE JURASSIC","WITNESS TRUE POWER!","YOUR PRESENTS ARE WEAK!","PREPARE TO BE RATIO'D!"],attack:["FEEL MY WRATH!","PATHETIC!","IS THAT ALL?!","BOW BEFORE ME!"]},GAMER_DINO:{spawn:["GAMING TIME! \u{1F3AE}","PRESS F TO PAY RESPECTS","I HAVE RGB EVERYTHING","MY SETUP COST MORE THAN YOUR SLEIGH","TWITCH DROPS INCOMING","SPONSORED BY G-FUEL"],attack:["360 NO SCOPE!","GET REKT NOOB!","HEADSHOT!","SKILL DIFF!"]},SIGMA_DINO:{spawn:["No time for distractions \u{1F454}","I walk my own path","SIGMA RULE #1: Stay on the grind","High value target passing through","The grindset continues...","No one can stop me"],attack:["I don't fight, I profit","Violence is for betas"]}},Le=["On my grind...","Sigma Rule #1: Never chase","Sigma Rule #47: Walk away","Passive income only","I AM the high value target","Built for the grind","Money moves only","No time for fights","Self-improvement arc","I go where I want"],ge={rich:["Ah, a person of wealth and taste! \u{1F4B0}","Your grindset is immaculate, my friend.","Now THIS is passive income energy!","I see the market has been good to you.","A fellow high-value individual!"],broke:["Broke? Sounds like a skill issue...","No cap, you need to grind harder.","Have you tried having more money?","The sigma grindset is NOT strong here.","Maybe try dodging more? Just a thought."],normal:["These prices are bussin' fr fr","Buy something or get out of my emporium","No cap, these weapons slap","Welcome to the grind, traveler","Everything here is certified fire \u{1F525}","The moai approves of your presence \u{1F5FF}","I was once like you... before the gains"],purchase:["STONKS! \u{1F4C8}","A wise investment!","That one's fire, no cap","Based purchase","You understand the grind"]},Ne=["Sigma escaped! Skill issue...","Sigma got away! Should've grinded harder","The Sigma walks free. L.","Couldn't stop the grindset!"],re={MAX_MESSAGES:8,MESSAGE_DURATION_MS:5e3,MESSAGE_FADE_DURATION_MS:500},Tt=["xX_DinoSlayer_Xx","GigaChadFan69","SantaSimp420","BuffDinoHater","MLG_Snowball","CritsForDays","PresentWarlord","Poggers_Pete","NoobDestroyer99","EpicGamer2024","StreamSniper42","TwitchChatter","DonationAndy","SubGifter9000","LurkKing","ModAbuser","BitsMillionaire","EmoteSpammer","KappaKid","OMEGALUL_Larry","Sadge_Sam","copium_carl","ratJAM_Randy","PogChamp_Paul","monkaS_Mike","Weirdge_Will"],At={kill:["POG","POGGIES","NICE","CLEAN","EZ Clap","GET REKT","SHEEEESH","W","GG","SKILL","NO MISS","DIFF","too easy","aimbot?","hes gaming","built different","HES CRACKED"],death:["F","RIP","NOOO","LMAO","skill issue","L + ratio","KEKW","unlucky","sadge","WASTED","get good","RIPBOZO","pack watch","should have dodged","Sadge","widepeepoSad"],bossSpawn:["monkaS","HERE WE GO","BOSS TIME","monkaW","oh no no no","PauseChamp","ITS HAPPENING","BIGBOSS","ABSOLUTE UNIT","WE LIVE","peepoRun","PogU BOSS"],waveComplete:["GGEZ","TOO EASY","LETS GO","PogChamp","W wave","FREE","next","EZ GAME","CLEAN WAVE","GGWP","nice wave","no sweat"],bossKill:["LETS GOOOO","HE DID IT","PogU","BOSS DOWN","VICTORY","GIGACHAD","WE WON","ratJAM VICTORY","ABSOLUTE GAMING","WHAT A GAMER"]},N={KONAMI_CODE:["ArrowUp","ArrowUp","ArrowDown","ArrowDown","ArrowLeft","ArrowRight","ArrowLeft","ArrowRight","KeyB","KeyA"],NICE_WAVE:69,DANK_WAVE:420,HAT_CLICKS_REQUIRED:10,SHRINK_SCALE:.5,MORBIN_CODE:"MORBIN"},ee={KONAMI:{id:"konami",name:"KONAMI SUPREMACY",description:"Enter the Konami code",effect:"All enemies shrink for one wave!",icon:"\u2B06\uFE0F\u2B06\uFE0F\u2B07\uFE0F\u2B07\uFE0F"},DRIP_MODE:{id:"drip_mode",name:"DRIP CHECK",description:"Click Santa's hat 10 times",effect:"Unlock secret DRIP MODE skin!",icon:"\u{1F48E}"},NICE:{id:"nice",name:"Nice.",description:"Reach wave 69",effect:"Nice.",icon:"\u{1F60F}"},DANK:{id:"dank",name:"DANK",description:"Reach wave 420",effect:"Dank screen flash!",icon:"\u{1F33F}"},MORBIN:{id:"morbin",name:"IT'S MORBIN' TIME",description:"Type MORBIN during gameplay",effect:"All enemies become bats for one wave!",icon:"\u{1F987}"}},te={KONAMI_MASTER:{id:"konami_master",name:"KONAMI MASTER",description:"Discovered the Konami code",icon:"\u{1F3AE}"},DRIP_LORD:{id:"drip_lord",name:"DRIP LORD",description:"Unlocked DRIP MODE",icon:"\u{1F48E}"},NICE_GUY:{id:"nice_guy",name:"Nice.",description:"Reached wave 69",icon:"\u{1F60F}"},DANK_MASTER:{id:"dank_master",name:"DANK MASTER",description:"Reached wave 420 (legend)",icon:"\u{1F33F}"},MORBIN_TIME:{id:"morbin_time",name:"IT'S MORBIN' TIME",description:"Activated bat mode",icon:"\u{1F987}"}},De={DOGE_MOON:{emoji:"\u{1F415}",x:.85,y:.12,size:50,parallaxFactor:.1},FLOATING_ELEMENTS:[{emoji:"\u{1F576}\uFE0F",name:"MLG Glasses",spawnChance:.002,speed:.5,size:40},{emoji:"\u{1F53A}",name:"Doritos",spawnChance:.002,speed:.3,size:35},{emoji:"\u{1F964}",name:"Mountain Dew",spawnChance:.002,speed:.25,size:38},{emoji:"\u2708\uFE0F",name:"Airplane",spawnChance:.001,speed:.8,size:45}],AIRPLANE_BANNERS:["SUBSCRIBE!","GIT GUD","NO CAP","BUSSIN","SIGMA MODE","BASED","POG","W RIZZ"],MAX_FLOATING_ELEMENTS:8,PARALLAX_INTENSITY:15},z={byKiller:{"GIGACHAD DINO":["Gigachads are slow but hit HARD. Keep your distance!","Try kiting Gigachads - shoot while backing away.","Upgrade damage to take down Gigachads faster."],"BUFF NERD DINO":["Buff Nerds are fast! Prioritize them before they close in.","Fire rate upgrades help against speedy Buff Nerds.","Buff Nerds have low HP - focus fire to drop them quick."],"DINO OVERLORD":["Boss fights require patience. Save your heal for phase 2!","At 50% HP, the boss becomes vulnerable to the minigame.","Keep moving during boss fights - their attacks are telegraphed."],"GAMER DINO":["Gamer Dinos shoot back! Take them out first.","Strafe side to side to dodge Gamer Dino projectiles.","Gamer attacks hurt your combo - prioritize them!"],"SIGMA DINO":["Sigma Dinos don't attack - they drop bonus coins when killed!","You can safely ignore Sigmas, but the coins are worth it."],"Boss Fireball":["Watch for the boss fireball wind-up animation.","Boss fireballs do splash damage - keep moving!","Stay mobile during boss fights to avoid ranged attacks."],"360 NO SCOPE":['Gamer Dinos do "360 no scopes" - prioritize killing them!',"The best defense against Gamer projectiles is offense.","Fire rate helps you eliminate Gamers before they can shoot."]},byMostDamage:{"GIGACHAD DINO":["You took the most damage from Gigachads - try keeping distance!","Gigachads wrecked you. Consider upgrading max health."],"BUFF NERD DINO":["Buff Nerds swarmed you! Fire rate upgrades help clear them fast.","Those speedy nerds got you. Try the Candy Cane for faster shots."],"GAMER DINO":["Gamer Dinos dealt tons of damage - prioritize shooting them first!","You got out-gamed. Kill Gamers before they can attack."],"DINO OVERLORD":["Boss damage adds up. Make sure to use your heal (E) wisely!","Practice the vulnerable phase minigame - it's key to boss fights."]},byWave:{early:["Early waves are for learning - focus on aim practice!","Don't forget to open the shop between waves! [R]","Save coins for key upgrades like damage and fire rate."],mid:["Mid-game is about efficiency - keep your combo going!","Healing power (E) is crucial - get those 10 kills!","Consider buying a new weapon from the shop."],late:["Late-game is brutal - every upgrade counts!","Prestige upgrades unlock after maxing basic stats.","Keep your combo alive for huge score multipliers!"],boss:["Boss waves are tough! Make sure you're upgraded first.","The minigame at 50% HP is crucial - practice clicking fast!","Boss fights reward patience - don't panic shoot."]},generic:["Keep moving! Standing still makes you an easy target.","Open the shop between waves with [R] to spend coins.","Build up your combo for score multipliers!","Healing power (E) fully restores HP - save it for emergencies.","Critical hits deal 2x damage - upgrade crit chance for big numbers!","Different weapons have different fire rates and damage.","Watch the heal bar - it charges with every kill!","Bosses appear every 5 waves - prepare accordingly!"]};var{PERSPECTIVE_SCALE:Pe,PERSPECTIVE_MIN_Z:Ge}=c,Te=class{constructor(e,i,n,a){this.x=e,this.y=i,this.z=n,this.vx=(Math.random()-.5)*10,this.vy=(Math.random()-.5)*10-5,this.vz=(Math.random()-.5)*10,this.color=a,this.life=30,this.maxLife=30}update(){this.x+=this.vx,this.y+=this.vy,this.z+=this.vz,this.vy+=.3,this.life--}draw(e,i,n){let a=i.width/2+this.x*(Pe/Math.max(Ge,-this.z)),r=i.height/2+(this.y+100)*(Pe/Math.max(Ge,-this.z)),l=Pe/Math.max(Ge,-this.z),m=this.life/this.maxLife;-this.z<10||(e.globalAlpha=m,e.fillStyle=this.color,e.beginPath(),e.arc(a,r,5*l,0,Math.PI*2),e.fill(),e.globalAlpha=1)}isExpired(){return this.life<=0}reset(e,i,n,a){this.x=e,this.y=i,this.z=n,this.vx=(Math.random()-.5)*10,this.vy=(Math.random()-.5)*10-5,this.vz=(Math.random()-.5)*10,this.color=a,this.life=30,this.maxLife=30}};var s={running:!1,paused:!1,score:0,coins:0,kills:0,wave:1,health:c.PLAYER_BASE_HEALTH,maxHealth:c.PLAYER_BASE_HEALTH,waveInProgress:!1,waveSpawningComplete:!1,betweenWaves:!1,bossActive:!1,currentBoss:null,healKills:0,healReady:!1,healKillsRequired:c.HEAL_KILLS_REQUIRED,sigmaSpawnedThisWave:0,startTime:0,lastAttacker:"Unknown",totalCoinsEarned:0},h={x:0,y:0,angle:0,moveSpeed:c.PLAYER_MOVE_SPEED,damage:c.PLAYER_BASE_DAMAGE,fireRate:c.PLAYER_BASE_FIRE_RATE,fireCooldown:0,critChance:c.PLAYER_BASE_CRIT_CHANCE,critMultiplier:c.PLAYER_CRIT_MULTIPLIER,damageBonus:0,fireRateBonus:0,damageMultiplier:1,fireRateMultiplier:1,healthMultiplier:1,coinMultiplier:1},f={currentWeapon:"present",weapons:{present:!0,snowball:!1,candy_cane:!1,ornament:!1,star:!1,moai:!1,doot:!1},upgrades:{damage:0,fireRate:0,health:0,critChance:0},prestigeUpgrades:{overkill:0,bulletHell:0,titanHealth:0,criticalMass:0,coinMagnet:0}},O=[],ie=[],G=[],H=[],T=[],V=[],He=[],fn=200,v={x:window.innerWidth/2,y:window.innerHeight/2},L={isTouchDevice:!1,isAiming:!1,lastTouchX:window.innerWidth/2,lastTouchY:window.innerHeight/2};function St(){return L.isTouchDevice="ontouchstart"in window||navigator.maxTouchPoints>0||window.matchMedia("(pointer: coarse)").matches,L.isTouchDevice}function ne(){return L.isTouchDevice}var Ve=[],P={count:0,lastKillTime:0,streakTimeout:c.KILL_STREAK_TIMEOUT_MS},S={count:0,showWomboCombo:!1,lastDamageTime:0},K=[],Ae=new Set,b={waveStartHealth:c.PLAYER_BASE_HEALTH,totalDamageTaken:0,shopSpending:0},D={byEnemyType:{},hitsByEnemyType:{}},E={active:!1,hits:0,timeLeft:c.MINIGAME_DURATION_SEC,interval:null,targetInterval:null},M={selected:"default",owned:["default"],totalCoins:0},w={intensity:0,duration:0,startTime:0,active:!1},x={enabled:!1,lensFlares:[]},p={discoveredEggs:new Set,activeEffects:{shrinkEnemies:!1,batMode:!1},konamiProgress:0,morbinProgress:"",hatClickCount:0,dripModeUnlocked:!1},k={enabled:!0,floatingElements:[]};function yt(){s.running=!0,s.paused=!1,s.score=0,s.coins=0,s.kills=0,s.wave=1,s.health=c.PLAYER_BASE_HEALTH,s.maxHealth=c.PLAYER_BASE_HEALTH,s.waveInProgress=!1,s.waveSpawningComplete=!1,s.betweenWaves=!1,s.bossActive=!1,s.currentBoss=null,s.healKills=0,s.healReady=!1,s.healKillsRequired=c.HEAL_KILLS_REQUIRED,s.sigmaSpawnedThisWave=0,s.startTime=Date.now(),s.lastAttacker="Unknown",s.totalCoinsEarned=0}function Mt(){h.x=0,h.y=0,h.angle=0,h.moveSpeed=c.PLAYER_MOVE_SPEED,h.damage=c.PLAYER_BASE_DAMAGE,h.fireRate=c.PLAYER_BASE_FIRE_RATE,h.fireCooldown=0,h.critChance=c.PLAYER_BASE_CRIT_CHANCE,h.critMultiplier=c.PLAYER_CRIT_MULTIPLIER,h.damageBonus=0,h.fireRateBonus=0,h.damageMultiplier=1,h.fireRateMultiplier=1,h.healthMultiplier=1,h.coinMultiplier=1}function It(){f.currentWeapon="present",f.weapons={present:!0,snowball:!1,candy_cane:!1,ornament:!1,star:!1,moai:!1,doot:!1},f.upgrades={damage:0,fireRate:0,health:0,critChance:0},f.prestigeUpgrades={overkill:0,bulletHell:0,titanHealth:0,criticalMass:0,coinMagnet:0}}function _t(){O.length=0,ie.length=0,G.length=0,H.length=0,T.length=0,V.length=0}function bt(){Ve.forEach(clearTimeout),Ve.length=0}function vt(){P.count=0,P.lastKillTime=0}function Ct(){S.count=0,S.showWomboCombo=!1,S.lastDamageTime=0}function Ot(){K.length=0}function Rt(){Ae.clear(),b.waveStartHealth=c.PLAYER_BASE_HEALTH,b.totalDamageTaken=0,b.shopSpending=0}function wt(){D.byEnemyType={},D.hitsByEnemyType={}}function Se(t,e){D.byEnemyType[t]||(D.byEnemyType[t]=0,D.hitsByEnemyType[t]=0),D.byEnemyType[t]+=e,D.hitsByEnemyType[t]++}function xt(){E.interval&&clearInterval(E.interval),E.targetInterval&&clearInterval(E.targetInterval),E.active=!1,E.hits=0,E.timeLeft=c.MINIGAME_DURATION_SEC,E.interval=null,E.targetInterval=null}function ye(t,e){v.x=t,v.y=e}function R(t){Ve.push(t)}function kt(){try{let t=localStorage.getItem("santaSkinState");if(t){let e=JSON.parse(t);M.selected=e.selected||"default",M.owned=e.owned||["default"],M.totalCoins=e.totalCoins||0}}catch(t){console.error("Failed to access localStorage:",t)}}function J(){try{localStorage.setItem("santaSkinState",JSON.stringify(M))}catch(t){console.error("Failed to save skin state:",t)}}function Bt(){try{let t=localStorage.getItem("deepFriedMode");t!==null&&(x.enabled=JSON.parse(t))}catch{}}function pn(){try{localStorage.setItem("deepFriedMode",JSON.stringify(x.enabled))}catch{}}function Lt(){return x.enabled=!x.enabled,pn(),x.enabled}function Nt(){x.lensFlares.length=0}function Dt(){try{let t=localStorage.getItem("easterEggsDiscovered");if(t){let e=JSON.parse(t);p.discoveredEggs=new Set(e.discovered||[]),p.dripModeUnlocked=e.dripModeUnlocked||!1}}catch{}}function En(){try{localStorage.setItem("easterEggsDiscovered",JSON.stringify({discovered:Array.from(p.discoveredEggs),dripModeUnlocked:p.dripModeUnlocked}))}catch{}}function W(t){p.discoveredEggs.add(t),En()}function le(t){return p.discoveredEggs.has(t)}function We(){p.activeEffects.shrinkEnemies=!1,p.activeEffects.batMode=!1}function Pt(){p.konamiProgress=0,p.morbinProgress="",p.hatClickCount=0}function Gt(t,e){let i=["\u{1F4A5}","\u2728","\u{1F525}","\u{1F4AF}","\u{1F44C}","\u{1F602}","\u{1F171}\uFE0F","\u{1F480}"];x.lensFlares.push({x:t,y:e,emoji:i[Math.floor(Math.random()*i.length)],life:60,scale:1+Math.random()*.5,rotation:Math.random()*Math.PI*2})}function ce(t,e,i,n){let a=He.pop();return a?a.reset(t,e,i,n):a=new Te(t,e,i,n),a}function Ht(t){He.length<fn&&He.push(t)}function Vt(){try{let t=localStorage.getItem("backgroundMemesEnabled");t!==null&&(k.enabled=JSON.parse(t))}catch{}}function gn(){try{localStorage.setItem("backgroundMemesEnabled",JSON.stringify(k.enabled))}catch{}}function Wt(){return k.enabled=!k.enabled,gn(),k.enabled}function Ut(){k.floatingElements.length=0}function Ue(){return k.enabled}var Tn=window.AudioContext||window.webkitAudioContext,o=null,u=1;function Ft(){o||(o=new Tn),o.state==="suspended"&&o.resume()}function g(t){if(o)try{let e=o.createOscillator(),i=o.createGain();switch(e.connect(i),i.connect(o.destination),t){case"shoot":e.frequency.setValueAtTime(200,o.currentTime),e.frequency.exponentialRampToValueAtTime(50,o.currentTime+.1),i.gain.setValueAtTime(.3*u,o.currentTime),i.gain.exponentialRampToValueAtTime(.01,o.currentTime+.1),e.start(),e.stop(o.currentTime+.1);break;case"hit":e.frequency.setValueAtTime(400,o.currentTime),e.frequency.exponentialRampToValueAtTime(100,o.currentTime+.15),i.gain.setValueAtTime(.2*u,o.currentTime),i.gain.exponentialRampToValueAtTime(.01,o.currentTime+.15),e.start(),e.stop(o.currentTime+.15);break;case"kill":e.type="square",e.frequency.setValueAtTime(600,o.currentTime),e.frequency.exponentialRampToValueAtTime(1200,o.currentTime+.1),i.gain.setValueAtTime(.15*u,o.currentTime),i.gain.exponentialRampToValueAtTime(.01,o.currentTime+.2),e.start(),e.stop(o.currentTime+.2);break;case"damage":e.type="sawtooth",e.frequency.setValueAtTime(100,o.currentTime),e.frequency.exponentialRampToValueAtTime(50,o.currentTime+.2),i.gain.setValueAtTime(.3*u,o.currentTime),i.gain.exponentialRampToValueAtTime(.01,o.currentTime+.2),e.start(),e.stop(o.currentTime+.2);break;case"buy":e.type="sine",e.frequency.setValueAtTime(800,o.currentTime),e.frequency.setValueAtTime(1e3,o.currentTime+.1),e.frequency.setValueAtTime(1200,o.currentTime+.2),i.gain.setValueAtTime(.2*u,o.currentTime),i.gain.exponentialRampToValueAtTime(.01,o.currentTime+.3),e.start(),e.stop(o.currentTime+.3);break;case"minigame_hit":e.type="sine",e.frequency.setValueAtTime(1e3,o.currentTime),i.gain.setValueAtTime(.2*u,o.currentTime),i.gain.exponentialRampToValueAtTime(.01,o.currentTime+.1),e.start(),e.stop(o.currentTime+.1);break;case"boss":e.type="sawtooth",e.frequency.setValueAtTime(100,o.currentTime),e.frequency.linearRampToValueAtTime(50,o.currentTime+.5),i.gain.setValueAtTime(.3*u,o.currentTime),i.gain.linearRampToValueAtTime(.01,o.currentTime+.5),e.start(),e.stop(o.currentTime+.5);break;case"moai":e.type="sine",e.frequency.setValueAtTime(150,o.currentTime),e.frequency.exponentialRampToValueAtTime(50,o.currentTime+.3),i.gain.setValueAtTime(.4*u,o.currentTime),i.gain.exponentialRampToValueAtTime(.01,o.currentTime+.3),e.start(),e.stop(o.currentTime+.3);break;case"doot":e.type="sawtooth",e.frequency.setValueAtTime(392,o.currentTime),e.frequency.setValueAtTime(349,o.currentTime+.1),i.gain.setValueAtTime(.25*u,o.currentTime),i.gain.exponentialRampToValueAtTime(.01,o.currentTime+.2),e.start(),e.stop(o.currentTime+.2);break;case"doot_kill":e.type="square",e.frequency.setValueAtTime(523,o.currentTime),e.frequency.setValueAtTime(659,o.currentTime+.1),e.frequency.setValueAtTime(784,o.currentTime+.2),i.gain.setValueAtTime(.2*u,o.currentTime),i.gain.exponentialRampToValueAtTime(.01,o.currentTime+.35),e.start(),e.stop(o.currentTime+.35);break;case"achievement":e.type="sine",e.frequency.setValueAtTime(523,o.currentTime),e.frequency.setValueAtTime(659,o.currentTime+.1),e.frequency.setValueAtTime(784,o.currentTime+.2),e.frequency.setValueAtTime(1047,o.currentTime+.3),i.gain.setValueAtTime(.25*u,o.currentTime),i.gain.exponentialRampToValueAtTime(.01,o.currentTime+.5),e.start(),e.stop(o.currentTime+.5);break;case"gamer_attack":e.type="sawtooth",e.frequency.setValueAtTime(200,o.currentTime),e.frequency.exponentialRampToValueAtTime(800,o.currentTime+.1),e.frequency.exponentialRampToValueAtTime(200,o.currentTime+.2),i.gain.setValueAtTime(.2*u,o.currentTime),i.gain.exponentialRampToValueAtTime(.01,o.currentTime+.25),e.start(),e.stop(o.currentTime+.25);break;case"heal":e.type="sine",e.frequency.setValueAtTime(400,o.currentTime),e.frequency.linearRampToValueAtTime(800,o.currentTime+.2),e.frequency.linearRampToValueAtTime(600,o.currentTime+.4),i.gain.setValueAtTime(.2*u,o.currentTime),i.gain.linearRampToValueAtTime(.01,o.currentTime+.4),e.start(),e.stop(o.currentTime+.4);break;case"equip":e.type="sine",e.frequency.setValueAtTime(600,o.currentTime),e.frequency.exponentialRampToValueAtTime(1200,o.currentTime+.08),e.frequency.exponentialRampToValueAtTime(800,o.currentTime+.15),i.gain.setValueAtTime(.25*u,o.currentTime),i.gain.exponentialRampToValueAtTime(.01,o.currentTime+.2),e.start(),e.stop(o.currentTime+.2);break;case"heal_ready":e.type="sine",e.frequency.setValueAtTime(523,o.currentTime),e.frequency.setValueAtTime(659,o.currentTime+.1),e.frequency.setValueAtTime(784,o.currentTime+.2),i.gain.setValueAtTime(.2*u,o.currentTime),i.gain.exponentialRampToValueAtTime(.01,o.currentTime+.35),e.start(),e.stop(o.currentTime+.35);break;case"shop_available":e.type="triangle",e.frequency.setValueAtTime(1e3,o.currentTime),e.frequency.setValueAtTime(1500,o.currentTime+.1),i.gain.setValueAtTime(.2*u,o.currentTime),i.gain.exponentialRampToValueAtTime(.01,o.currentTime+.25),e.start(),e.stop(o.currentTime+.25);break;case"boss_phase2":e.type="sawtooth",e.frequency.setValueAtTime(80,o.currentTime),e.frequency.linearRampToValueAtTime(200,o.currentTime+.3),e.frequency.linearRampToValueAtTime(150,o.currentTime+.5),i.gain.setValueAtTime(.3*u,o.currentTime),i.gain.linearRampToValueAtTime(.4*u,o.currentTime+.3),i.gain.exponentialRampToValueAtTime(.01,o.currentTime+.8),e.start(),e.stop(o.currentTime+.8),An();break;case"boss_phase3":e.type="sawtooth",e.frequency.setValueAtTime(60,o.currentTime),e.frequency.linearRampToValueAtTime(400,o.currentTime+.5),e.frequency.linearRampToValueAtTime(300,o.currentTime+.8),e.frequency.linearRampToValueAtTime(500,o.currentTime+1),i.gain.setValueAtTime(.35*u,o.currentTime),i.gain.linearRampToValueAtTime(.45*u,o.currentTime+.5),i.gain.exponentialRampToValueAtTime(.01,o.currentTime+1.2),e.start(),e.stop(o.currentTime+1.2),Sn();break}}catch{}}function zt(t=!1){if(o)try{let e=o.createOscillator(),i=o.createGain();e.connect(i),i.connect(o.destination),t?(e.type="sine",e.frequency.setValueAtTime(1200,o.currentTime),e.frequency.setValueAtTime(1600,o.currentTime+.05),i.gain.setValueAtTime(.25*u,o.currentTime),i.gain.exponentialRampToValueAtTime(.01,o.currentTime+.15),e.start(),e.stop(o.currentTime+.15)):(e.type="square",e.frequency.setValueAtTime(800,o.currentTime),i.gain.setValueAtTime(.15*u,o.currentTime),i.gain.exponentialRampToValueAtTime(.01,o.currentTime+.05),e.start(),e.stop(o.currentTime+.05))}catch{}}function Kt(t){if(o)try{let e=o.createOscillator(),i=o.createGain();e.connect(i),i.connect(o.destination);let n=400+t*100;e.type="square",e.frequency.setValueAtTime(n,o.currentTime),e.frequency.setValueAtTime(n*1.5,o.currentTime+.1),e.frequency.setValueAtTime(n*2,o.currentTime+.2),i.gain.setValueAtTime(.2*u,o.currentTime),i.gain.exponentialRampToValueAtTime(.01,o.currentTime+.4),e.start(),e.stop(o.currentTime+.4)}catch{}}function qt(t){u=Math.max(0,Math.min(1,t))}function Yt(){if(o)try{let t=[{freq:300,dur:.15},{freq:400,dur:.15},{freq:350,dur:.15},{freq:280,dur:.15},{freq:500,dur:.12},{freq:450,dur:.12},{freq:400,dur:.25}],e=o.currentTime;t.forEach(i=>{let n=o.createOscillator(),a=o.createGain();n.connect(a),a.connect(o.destination),n.type="sawtooth",n.frequency.setValueAtTime(i.freq,e),n.frequency.linearRampToValueAtTime(i.freq*.9,e+i.dur*.8),a.gain.setValueAtTime(.25*u,e),a.gain.exponentialRampToValueAtTime(.01,e+i.dur),n.start(e),n.stop(e+i.dur),e+=i.dur*.9})}catch{}}function $t(){if(o)try{let t=o.createOscillator(),e=o.createOscillator(),i=o.createOscillator(),n=o.createGain();t.connect(n),e.connect(n),i.connect(n),n.connect(o.destination),t.type="sawtooth",t.frequency.setValueAtTime(440,o.currentTime),e.type="sawtooth",e.frequency.setValueAtTime(554,o.currentTime),i.type="sawtooth",i.frequency.setValueAtTime(659,o.currentTime),n.gain.setValueAtTime(.3*u,o.currentTime),n.gain.setValueAtTime(.35*u,o.currentTime+.05),n.gain.exponentialRampToValueAtTime(.01,o.currentTime+.8),t.start(),e.start(),i.start(),t.stop(o.currentTime+.8),e.stop(o.currentTime+.8),i.stop(o.currentTime+.8)}catch{}}function jt(){if(o)try{let t=[{freq:350,dur:.12},{freq:400,dur:.1},{freq:380,dur:.1},{freq:450,dur:.12},{freq:500,dur:.1},{freq:550,dur:.15},{freq:600,dur:.3}],e=o.currentTime;t.forEach((i,n)=>{let a=o.createOscillator(),r=o.createGain();a.connect(r),r.connect(o.destination),a.type="square",a.frequency.setValueAtTime(i.freq+n*20,e),a.frequency.linearRampToValueAtTime(i.freq*1.1+n*25,e+i.dur),r.gain.setValueAtTime(.2*u,e),r.gain.exponentialRampToValueAtTime(.01,e+i.dur),a.start(e),a.stop(e+i.dur),e+=i.dur*.85})}catch{}}function Xt(){if(o)try{let t=[{freq:659,dur:.4},{freq:587,dur:.4},{freq:523,dur:.4},{freq:494,dur:.6},{freq:440,dur:.8}],e=o.currentTime;t.forEach(i=>{let n=o.createOscillator(),a=o.createGain(),r=o.createOscillator(),l=o.createGain();r.frequency.setValueAtTime(5,e),l.gain.setValueAtTime(8,e),r.connect(l),l.connect(n.frequency),n.connect(a),a.connect(o.destination),n.type="sine",n.frequency.setValueAtTime(i.freq,e),n.frequency.linearRampToValueAtTime(i.freq*.98,e+i.dur),a.gain.setValueAtTime(0,e),a.gain.linearRampToValueAtTime(.2*u,e+.05),a.gain.exponentialRampToValueAtTime(.15*u,e+i.dur*.3),a.gain.exponentialRampToValueAtTime(.01,e+i.dur),r.start(e),n.start(e),r.stop(e+i.dur),n.stop(e+i.dur),e+=i.dur*.9})}catch{}}function Zt(){if(o)try{let t=o.createOscillator(),e=o.createOscillator(),i=o.createGain();t.connect(i),e.connect(i),i.connect(o.destination),t.type="sawtooth",t.frequency.setValueAtTime(200,o.currentTime),t.frequency.linearRampToValueAtTime(300,o.currentTime+.2),t.frequency.linearRampToValueAtTime(250,o.currentTime+.4),t.frequency.linearRampToValueAtTime(200,o.currentTime+.6),e.type="sine",e.frequency.setValueAtTime(400,o.currentTime),e.frequency.linearRampToValueAtTime(600,o.currentTime+.2),e.frequency.linearRampToValueAtTime(500,o.currentTime+.4),e.frequency.linearRampToValueAtTime(400,o.currentTime+.6),i.gain.setValueAtTime(.25*u,o.currentTime),i.gain.exponentialRampToValueAtTime(.01,o.currentTime+.7),t.start(),e.start(),t.stop(o.currentTime+.7),e.stop(o.currentTime+.7)}catch{}}function An(){if(o)try{let t=o.createOscillator(),e=o.createGain();t.connect(e),e.connect(o.destination),t.type="square",t.frequency.setValueAtTime(880,o.currentTime),t.frequency.setValueAtTime(0,o.currentTime+.1),t.frequency.setValueAtTime(880,o.currentTime+.2),t.frequency.setValueAtTime(0,o.currentTime+.3),t.frequency.setValueAtTime(880,o.currentTime+.4),e.gain.setValueAtTime(.2*u,o.currentTime),e.gain.exponentialRampToValueAtTime(.01,o.currentTime+.6),t.start(),t.stop(o.currentTime+.6)}catch{}}function Sn(){if(o)try{let t=o.createOscillator(),e=o.createOscillator(),i=o.createOscillator(),n=o.createGain();t.connect(n),e.connect(n),i.connect(n),n.connect(o.destination),t.type="sawtooth",t.frequency.setValueAtTime(147,o.currentTime),t.frequency.linearRampToValueAtTime(294,o.currentTime+.8),e.type="sawtooth",e.frequency.setValueAtTime(175,o.currentTime),e.frequency.linearRampToValueAtTime(349,o.currentTime+.8),i.type="sawtooth",i.frequency.setValueAtTime(220,o.currentTime),i.frequency.linearRampToValueAtTime(440,o.currentTime+.8),n.gain.setValueAtTime(.25*u,o.currentTime),n.gain.linearRampToValueAtTime(.35*u,o.currentTime+.4),n.gain.exponentialRampToValueAtTime(.01,o.currentTime+1),t.start(),e.start(),i.start(),t.stop(o.currentTime+1),e.stop(o.currentTime+1),i.stop(o.currentTime+1)}catch{}}function Jt(){return se[M.selected]||se.default}function yn(t){let e=se[t];return!e||M.owned.includes(t)||M.totalCoins<e.price?!1:(M.totalCoins-=e.price,M.owned.push(t),M.selected=t,J(),g("buy"),!0)}function Mn(t){return M.owned.includes(t)?(M.selected=t,J(),!0):!1}function Fe(){let t=document.getElementById("skin-options");t.innerHTML="";for(let[e,i]of Object.entries(se)){let n=M.owned.includes(e),a=M.selected===e,r=M.totalCoins>=i.price,l=document.createElement("div");l.className=`skin-option ${a?"selected":""} ${n?"":"locked"}`,l.innerHTML=`
            <div class="skin-emoji">${i.emoji}</div>
            <div class="skin-name">${i.name}</div>
            <div class="skin-price ${n?"owned":""}">${n?"\u2713 OWNED":`\u{1FA99} ${i.price}`}</div>
        `,l.onclick=()=>{n?(Mn(e),Fe()):r&&(yn(e),Fe())},t.appendChild(l)}document.getElementById("skin-coins").textContent=M.totalCoins}function Qt(){kt(),Fe()}function ei(t){let e=ke[0];for(let i of ke)t>=i.minScore&&(e=i);return e}function In(){return Be[Math.floor(Math.random()*Be.length)]}function ti(t){let e=Math.floor(t/1e3),i=Math.floor(e/60),n=e%60;return`${i}:${n.toString().padStart(2,"0")}`}function _n(){let t=D.byEnemyType,e=0,i=null;for(let[n,a]of Object.entries(t))a>e&&(e=a,i=n);return i}function bn(t){return t%5===0&&t>0?"boss":t<=3?"early":t<=7?"mid":"late"}function ii(){let t=s.lastAttacker,e=s.wave,i=_n(),n=bn(e);if(t&&z.byKiller[t]){let a=z.byKiller[t];return a[Math.floor(Math.random()*a.length)]}if(i&&z.byMostDamage[i]){let a=z.byMostDamage[i];return a[Math.floor(Math.random()*a.length)]}if(z.byWave[n]){let a=z.byWave[n];return a[Math.floor(Math.random()*a.length)]}return z.generic[Math.floor(Math.random()*z.generic.length)]}function vn(){let t=D.hitsByEnemyType,e=Object.entries(t).sort((n,a)=>a[1]-n[1]);return e.length===0?"":e.slice(0,2).map(([n,a])=>`${n}: ${a}x`).join(", ")}function ni(){let t=Date.now()-s.startTime,e=ei(s.score);document.getElementById("stat-waves").textContent=s.wave,document.getElementById("stat-kills").textContent=s.kills,document.getElementById("stat-score").textContent=s.score.toLocaleString(),document.getElementById("stat-coins").textContent=s.totalCoinsEarned,document.getElementById("stat-time").textContent=ti(t),document.getElementById("stat-cause").textContent=s.lastAttacker;let i=document.getElementById("stat-rating");i.textContent=e.rating,i.style.color=e.color,i.style.textShadow=`0 0 15px ${e.color}`,document.getElementById("stat-lastwords").textContent=In();let n=document.getElementById("stat-tip");n&&(n.textContent=ii());let a=document.getElementById("stat-damage-summary");if(a){let r=vn();r?(a.textContent=r,a.parentElement.style.display="block"):a.parentElement.style.display="none"}}function ai(){let t=Date.now()-s.startTime,e=ei(s.score),i=ii(),n=`
\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557
\u2551   \u{1F480} SKILL ISSUE DETECTED \u{1F480}      \u2551
\u2551      DINO DOOM - DEATH RECEIPT   \u2551
\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563
\u2551 Waves Survived:    ${String(s.wave).padStart(14)} \u2551
\u2551 Dinos Eliminated:  ${String(s.kills).padStart(14)} \u2551
\u2551 Final Score:       ${String(s.score.toLocaleString()).padStart(14)} \u2551
\u2551 Coins Earned:      ${String(s.totalCoinsEarned).padStart(14)} \u2551
\u2551 Time Survived:     ${ti(t).padStart(14)} \u2551
\u2551 Cause of Death:    ${s.lastAttacker.padStart(14)} \u2551
\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563
\u2551 Rating: ${e.rating.padEnd(24)} \u2551
\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563
\u2551 \u{1F4A1} TIP: ${i.substring(0,24).padEnd(24)} \u2551
\u255A\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255D
\u{1F996} DINO DOOM: Santa's Last Stand \u{1F385}
    `.trim();navigator.clipboard.writeText(n).then(()=>{let a=document.getElementById("copy-receipt-btn");a.textContent="\u2713 COPIED!",setTimeout(()=>a.textContent="\u{1F4CB} SHARE YOUR L",2e3)})}function oi(){Bt();let t=document.getElementById("deep-fried-btn");t&&(t.addEventListener("click",Cn),si()),ri()}function Cn(){Lt(),si(),ri()}function si(){let t=document.getElementById("deep-fried-btn"),e=t?.querySelector(".toggle-text");!t||!e||(x.enabled?(t.classList.add("active"),e.textContent="DEEP FRIED MODE: ON"):(t.classList.remove("active"),e.textContent="DEEP FRIED MODE: OFF"))}function ri(){let t=document.getElementById("game-container");t&&(x.enabled?t.classList.add("deep-fried"):(t.classList.remove("deep-fried"),Nt(),Rn()))}function On(t,e){if(!x.enabled)return;Gt(t,e);let i=document.getElementById("lens-flare-container");if(!i)return;let n=["\u{1F4A5}","\u2728","\u{1F525}","\u{1F4AF}","\u{1F44C}","\u{1F602}","\u{1F171}\uFE0F","\u{1F480}"],a=n[Math.floor(Math.random()*n.length)],r=document.createElement("div");r.className="lens-flare",r.textContent=a,r.style.left=t+"px",r.style.top=e+"px",i.appendChild(r),setTimeout(()=>{r.remove()},1e3)}function Rn(){let t=document.getElementById("lens-flare-container");t&&(t.innerHTML="")}function li(t){return function(a,r){if(!x.enabled)return;let l=200/Math.max(100,-r),m=t.width/2+a*l,d=t.height/2+100*l;On(m,d)}}var q={messages:[],enabled:!0};function ze(t){return t[Math.floor(Math.random()*t.length)]}function wn(){let t=["#ff6b6b","#ffd93d","#6bcb77","#4d96ff","#ff6bcb","#c8a2c8","#87ceeb","#ff8c00","#00ff7f","#ff1493","#00bfff","#ffa500"];return{name:ze(Tt),color:ze(t)}}function xn(t,e,i){if(!q.enabled)return;let n=document.getElementById("twitch-chat");if(!n)return;let a=e?{name:e,color:i||"#fff"}:wn(),r=document.createElement("div");r.className="twitch-chat-message";let l=document.createElement("span");l.className="twitch-chat-username",l.textContent=a.name+":",l.style.color=a.color;let m=document.createElement("span");for(m.className="twitch-chat-text",m.textContent=" "+t,r.appendChild(l),r.appendChild(m),n.appendChild(r),q.messages.push({element:r,time:Date.now()});q.messages.length>re.MAX_MESSAGES;){let d=q.messages.shift();d.element&&d.element.parentNode&&(d.element.classList.add("fading"),setTimeout(()=>{d.element.parentNode&&d.element.remove()},re.MESSAGE_FADE_DURATION_MS))}setTimeout(()=>{let d=q.messages.findIndex(A=>A.element===r);d!==-1&&q.messages.splice(d,1),r.parentNode&&(r.classList.add("fading"),setTimeout(()=>{r.parentNode&&r.remove()},re.MESSAGE_FADE_DURATION_MS))},re.MESSAGE_DURATION_MS)}function me(t,e=1){let i=At[t];if(!(!i||i.length===0))for(let n=0;n<e;n++){let a=n*(100+Math.random()*200);setTimeout(()=>{xn(ze(i))},a)}}function ci(){Math.random()<.3&&me("kill",1+Math.floor(Math.random()*2))}function mi(){me("death",3+Math.floor(Math.random()*3))}function hi(){me("bossSpawn",3+Math.floor(Math.random()*2))}function di(){me("waveComplete",2+Math.floor(Math.random()*2))}function ui(){me("bossKill",4+Math.floor(Math.random()*3))}function fi(){let t=document.getElementById("twitch-chat");t&&(t.innerHTML=""),q.messages=[]}function pi(){q.messages=[],q.enabled=!0}function j(t){let e=pt[t];e&&(Ae.has(e.id)||(Ae.add(e.id),Ke(e),g("achievement")))}function Ke(t){let e=document.getElementById("achievement-container"),i=document.createElement("div");i.className="achievement-toast",i.innerHTML=`
        <div class="achievement-icon">${t.icon}</div>
        <div class="achievement-content">
            <div class="achievement-title">\u{1F3C6} ACHIEVEMENT UNLOCKED</div>
            <div class="achievement-name">${t.name}</div>
        </div>
    `,e.appendChild(i),setTimeout(()=>{i.classList.add("hiding"),setTimeout(()=>i.remove(),500)},c.ACHIEVEMENT_TOAST_DURATION_MS)}function Ei(){b.waveStartHealth=s.health}function gi(){$t(),di(),s.health===b.waveStartHealth&&j("WAVE_SURVIVOR"),s.wave>=10&&b.totalDamageTaken===0&&j("EASY_MODE")}function Ti(t){s.kills===1&&j("FIRST_BLOOD"),t.isBoss&&(j("BOSS_SLAYER"),Zt()),t.type==="GIGACHAD"&&t.wasOneShot&&j("BUILT_DIFFERENT")}function Ai(){s.wave===1&&j("SKILL_ISSUE")}function Me(t){b.shopSpending+=t,b.shopSpending>=1e3&&j("BIG_SPENDER")}function Si(t){t==="moai"&&j("MEME_LORD")}function yi(){Dt(),kn()}function kn(){let t=document.getElementById("start-screen");if(!t)return;let e=document.getElementById("santa-hat-easter");e||(e=document.createElement("div"),e.id="santa-hat-easter",e.innerHTML="\u{1F385}",e.style.cssText=`
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 60px;
            cursor: pointer;
            user-select: none;
            transition: transform 0.1s;
            z-index: 100;
        `,t.appendChild(e)),e.addEventListener("click",Bn)}function Bn(){if(p.dripModeUnlocked)return;p.hatClickCount++;let t=document.getElementById("santa-hat-easter");t&&(t.style.transform="scale(1.2)",setTimeout(()=>{t.style.transform="scale(1)"},100)),g("click"),p.hatClickCount>=N.HAT_CLICKS_REQUIRED&&Ln()}function Ln(){if(p.dripModeUnlocked)return;p.dripModeUnlocked=!0,W("drip_mode"),M.owned.includes("drip")||(M.owned.push("drip"),J()),he(ee.DRIP_MODE),de(te.DRIP_LORD);let t=document.getElementById("santa-hat-easter");t&&(t.innerHTML="\u{1F48E}\u{1F385}\u{1F48E}",t.style.animation="dripUnlock 1s ease-in-out")}function Mi(t){let e=N.KONAMI_CODE[p.konamiProgress];if((t.code||t.key)===e){if(p.konamiProgress++,p.konamiProgress===N.KONAMI_CODE.length)return Nn(),p.konamiProgress=0,!0}else p.konamiProgress=0;return!1}function Nn(){p.activeEffects.shrinkEnemies=!0,W("konami"),he(ee.KONAMI),le("konami_achievement")||(W("konami_achievement"),de(te.KONAMI_MASTER)),g("achievement")}function Ii(t){let e=t.toUpperCase(),i=p.morbinProgress.length;if(N.MORBIN_CODE[i]===e){if(p.morbinProgress+=e,p.morbinProgress===N.MORBIN_CODE)return Dn(),p.morbinProgress="",!0}else N.MORBIN_CODE[0]===e?p.morbinProgress=e:p.morbinProgress="";return!1}function Dn(){p.activeEffects.batMode=!0,W("morbin"),he(ee.MORBIN),le("morbin_achievement")||(W("morbin_achievement"),de(te.MORBIN_TIME)),g("achievement"),Pn()}function Pn(){let t=document.createElement("div");t.className="morbin-announcement",t.innerHTML=`
        <div class="morbin-text">\u{1F987} IT'S MORBIN' TIME \u{1F987}</div>
    `,document.body.appendChild(t),setTimeout(()=>{t.classList.add("fade-out"),setTimeout(()=>t.remove(),500)},2e3)}function _i(t){t===N.NICE_WAVE?Gn():t===N.DANK_WAVE&&Vn()}function Gn(){W("nice"),he(ee.NICE),le("nice_achievement")||(W("nice_achievement"),de(te.NICE_GUY)),Hn()}function Hn(){let t=document.createElement("div");t.className="nice-announcement",t.innerHTML='<div class="nice-text">Nice.</div>',document.body.appendChild(t),setTimeout(()=>{t.classList.add("fade-out"),setTimeout(()=>t.remove(),500)},2500)}function Vn(){W("dank"),he(ee.DANK),le("dank_achievement")||(W("dank_achievement"),de(te.DANK_MASTER)),Wn()}function Wn(){let t=document.createElement("div");t.className="dank-flash",document.body.appendChild(t);let e=document.createElement("div");e.className="dank-announcement",e.innerHTML=`
        <div class="dank-text">\u{1F33F} DANK \u{1F33F}</div>
        <div class="dank-subtext">Wave 420 - Legendary Status</div>
    `,document.body.appendChild(e),setTimeout(()=>{t.remove(),e.classList.add("fade-out"),setTimeout(()=>e.remove(),500)},3e3)}function he(t){let e=document.getElementById("achievement-container");if(!e)return;let i=document.createElement("div");i.className="easter-egg-toast",i.innerHTML=`
        <div class="easter-egg-icon">${t.icon}</div>
        <div class="easter-egg-content">
            <div class="easter-egg-title">\u{1F95A} EASTER EGG FOUND!</div>
            <div class="easter-egg-name">${t.name}</div>
            <div class="easter-egg-effect">${t.effect}</div>
        </div>
    `,e.appendChild(i),setTimeout(()=>{i.classList.add("hiding"),setTimeout(()=>i.remove(),500)},4e3)}function de(t){Ke({...t,name:`\u{1F512} SECRET: ${t.name}`})}function ue(t){p.activeEffects.shrinkEnemies&&(t.size*=N.SHRINK_SCALE,t.shrunk=!0),p.activeEffects.batMode&&(t.batMode=!0,t.originalEmoji=t.emoji,t.emoji="\u{1F987}")}var{PERSPECTIVE_SCALE:qe,PERSPECTIVE_MIN_Z:Ye}=c,fe=class{constructor(e,i,n,a,r=!1){this.x=e,this.y=i,this.z=n,this.damage=a,this.isMeteor=r,r?(this.vx=(Math.random()-.5)*2,this.vy=8,this.vz=8,this.life=150,this.emoji="\u2604\uFE0F",this.color="#ff6600",this.attackerName="Meteor"):(this.vx=(Math.random()-.5)*3,this.vy=0,this.vz=15,this.life=120,this.emoji="\u{1F525}",this.color="#ff4400",this.attackerName="Boss Fireball")}update(){this.x+=this.vx,this.y+=this.vy,this.z+=this.vz,this.life--}checkPlayerCollision(e){return this.z>-50&&Math.abs(this.x-e.x)<80?(this.life=0,!0):!1}draw(e,i){if(this.z>0||-this.z>2e3)return;let n=i.width/2+this.x*(qe/Math.max(Ye,-this.z)),a=i.height/2+(this.y+100)*(qe/Math.max(Ye,-this.z)),r=qe/Math.max(Ye,-this.z);e.shadowColor=this.color,e.shadowBlur=25,e.font=`${35*r}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(this.emoji,n,a),e.shadowBlur=0}isExpired(){return this.life<=0}};var{PERSPECTIVE_SCALE:$e,PERSPECTIVE_MIN_Z:je}=c,Ie=class{constructor(e,i,n,a){this.x=e,this.y=i,this.z=n,this.vx=(Math.random()-.5)*2,this.vy=0,this.vz=8,this.damage=a,this.life=180,this.emoji="\u{1F3AF}",this.color="#ff00ff",this.spin=0,this.attackerName="360 NO SCOPE"}update(){this.x+=this.vx,this.y+=this.vy,this.z+=this.vz,this.spin+=.15,this.life--;let e=Math.sin(this.spin)*127+128,i=Math.sin(this.spin+2.094)*127+128,n=Math.sin(this.spin+4.189)*127+128;this.color=`rgb(${Math.floor(e)}, ${Math.floor(i)}, ${Math.floor(n)})`}checkPlayerCollision(e){return this.z>-50&&Math.abs(this.x-e.x)<80?(this.life=0,!0):!1}draw(e,i){if(this.z>0||-this.z>2e3)return;let n=i.width/2+this.x*($e/Math.max(je,-this.z)),a=i.height/2+(this.y+100)*($e/Math.max(je,-this.z)),r=$e/Math.max(je,-this.z);e.save(),e.translate(n,a),e.rotate(this.spin),e.shadowColor=this.color,e.shadowBlur=30,e.font=`${40*r}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(this.emoji,0,0),e.shadowBlur=0,e.restore()}isExpired(){return this.life<=0}};var{PERSPECTIVE_SCALE:_e,PERSPECTIVE_MIN_Z:be}=c,Q=class{constructor(e,i,n,a={}){let r=ft[e];this.type=e,this.name=r.name,this.emoji=r.emoji,this.health=r.health+s.wave*c.ENEMY_HEALTH_PER_WAVE,this.maxHealth=this.health,this.damage=r.damage,this.speed=r.speed,this.size=r.size,this.color=r.color,this.points=r.points,this.coins=r.coins,this.traits=r.traits,this.isBoss=r.isBoss||!1,this.x=i,this.y=0,this.z=n,this.wobble=0,this.attackCooldown=0,this.hitFlash=0,this.invulnerable=!1,this.stunned=!1,this.hitCount=0,this.wasOneShot=!0,this.markedForRemoval=!1,this.callbacks=a,this.isGamer=r.isGamer||!1,this.deathMessages=r.deathMessages||null,this.isGamer&&(this.rgbPhase=Math.random()*Math.PI*2,this.rangedCooldown=c.GAMER_RANGED_COOLDOWN,this.shootCooldown=0),this.isSigma=r.isSigma||!1,this.isSigma&&(this.sigmaDirection=i>0?-1:1,this.sigmaPhase=0,this.sigmaDialogueCooldown=180,this.hasEscaped=!1),this.isBoss&&(this.shootCooldown=0,this.bossPhase=1,this.phaseTransitioning=!1,this.meteorCooldown=0,this.ascendOffset=0,this.targetAscendOffset=0,this.minigameTriggered=!1)}update(){if(this.invulnerable)return;if(this.stunned){this.wobble+=.15,this.hitFlash=Math.max(0,this.hitFlash-.1);return}if(this.isSigma){this.updateSigma();return}let e=h.x-this.x,i=-this.z,n=Math.sqrt(e*e+i*i);n>50&&(this.x+=e/n*this.speed,this.z+=i/n*this.speed),this.z>c.ENEMY_MIN_Z&&(this.z=c.ENEMY_MIN_Z),this.x=Math.max(-c.ENEMY_MAX_X,Math.min(c.ENEMY_MAX_X,this.x)),this.isBoss&&!this.invulnerable&&this.updateBossShooting(),this.isGamer&&this.updateGamer(),Math.sqrt(e*e+this.z*this.z)<c.ENEMY_ATTACK_RANGE&&this.z<-50&&this.attackCooldown<=0&&(this.attack(),this.attackCooldown=60),this.wobble+=.1,this.attackCooldown--,this.hitFlash=Math.max(0,this.hitFlash-.1)}updateSigma(){this.x+=this.sigmaDirection*this.speed,this.z<-200&&(this.z+=.5),this.sigmaPhase+=.05;let e=Math.sin(this.sigmaPhase)*30+100;if(this.color=`rgb(${e+50}, ${e+30}, ${Math.floor(e*.3)})`,this.sigmaDialogueCooldown--,this.sigmaDialogueCooldown<=0&&this.callbacks.showSigmaDialogue&&(this.callbacks.showSigmaDialogue(this),this.sigmaDialogueCooldown=c.SIGMA_DIALOGUE_COOLDOWN_MIN+Math.random()*c.SIGMA_DIALOGUE_COOLDOWN_RANGE),Math.abs(this.x)>c.SIGMA_ESCAPE_X&&!this.hasEscaped){this.hasEscaped=!0,this.callbacks.showSigmaEscapeText&&this.callbacks.showSigmaEscapeText(),this.health=0;return}this.wobble+=.05,this.hitFlash=Math.max(0,this.hitFlash-.1)}updateBossShooting(){if(this.shootCooldown||(this.shootCooldown=0),this.phaseTransitioning)return;this.shootCooldown--;let e=1,i=1;if(this.bossPhase===2?(e=c.BOSS_PHASE_2_COOLDOWN_MULT,i=c.BOSS_PHASE_2_DAMAGE_MULT):this.bossPhase===3&&(e=c.BOSS_PHASE_3_COOLDOWN_MULT,i=c.BOSS_PHASE_3_DAMAGE_MULT),this.shootCooldown<=0&&(G.push(new fe(this.x,this.y+this.ascendOffset,this.z,Math.floor(c.BOSS_FIREBALL_DAMAGE*i))),this.shootCooldown=Math.floor(c.BOSS_SHOOT_COOLDOWN*e)),this.bossPhase===3&&this.updateMeteorRain(i),this.ascendOffset!==this.targetAscendOffset){let n=this.targetAscendOffset-this.ascendOffset;this.ascendOffset+=n*.05}}updateMeteorRain(e){if(this.meteorCooldown||(this.meteorCooldown=0),this.meteorCooldown--,this.meteorCooldown<=0){let i=(Math.random()-.5)*600,n=-200-Math.random()*300;G.push(new fe(i,-200,n,Math.floor(c.BOSS_METEOR_DAMAGE*e),!0)),this.meteorCooldown=c.BOSS_METEOR_COOLDOWN}}checkPhaseTransition(){if(!this.isBoss||this.phaseTransitioning)return null;let e=this.health/this.maxHealth;return this.bossPhase===1&&e<=c.BOSS_PHASE_2_THRESHOLD?2:this.bossPhase===2&&e<=c.BOSS_PHASE_3_THRESHOLD?3:null}transitionToPhase(e){this.bossPhase=e,e===3&&(this.targetAscendOffset=c.BOSS_ASCEND_HEIGHT)}updateGamer(){this.rgbPhase+=.1;let e=Math.sin(this.rgbPhase)*127+128,i=Math.sin(this.rgbPhase+2.094)*127+128,n=Math.sin(this.rgbPhase+4.189)*127+128;this.color=`rgb(${Math.floor(e)}, ${Math.floor(i)}, ${Math.floor(n)})`,this.rangedCooldown--,this.rangedCooldown<=0&&(this.callbacks.showGamerAttackText&&this.callbacks.showGamerAttackText(this.x,this.y,this.z),this.callbacks.playSound&&this.callbacks.playSound("gamer_attack"),G.push(new Ie(this.x,this.y,this.z,c.GAMER_PROJECTILE_DAMAGE)),this.rangedCooldown=c.GAMER_RANGED_COOLDOWN)}attack(){s.health-=this.damage,s.lastAttacker=this.name,b.totalDamageTaken+=this.damage,Se(this.name,this.damage),this.callbacks.playSound&&this.callbacks.playSound("damage"),this.callbacks.showDamageOverlay&&this.callbacks.showDamageOverlay(),this.callbacks.shakeOnDamage&&this.callbacks.shakeOnDamage(),this.callbacks.showEnemyDialogue&&this.callbacks.showEnemyDialogue(this,"attack"),this.callbacks.breakCombo&&this.callbacks.breakCombo(),s.health<=0&&this.callbacks.gameOver&&this.callbacks.gameOver(),this.callbacks.updateHUD&&this.callbacks.updateHUD()}takeDamage(e){if(this.invulnerable)return!1;this.hitCount++,this.hitCount>1&&(this.wasOneShot=!1);let i=e,n=Math.random()<h.critChance;n&&(i*=h.critMultiplier,this.callbacks.shakeOnCrit&&this.callbacks.shakeOnCrit()),this.health-=i,this.hitFlash=1,this.callbacks.playSound&&this.callbacks.playSound("hit"),this.callbacks.showHitMarker&&this.callbacks.showHitMarker(n);for(let a=0;a<5;a++)H.push(ce(this.x,this.y,this.z,this.color));if(T.push({text:n?`CRIT ${Math.floor(i)}!`:`-${Math.floor(i)}`,x:this.x+(Math.random()-.5)*30,y:this.y-30,z:this.z,life:40,color:n?"#ff00ff":"#ffffff"}),this.isBoss){let a=document.getElementById("boss-health-bar");a&&(a.style.width=`${Math.max(0,this.health/this.maxHealth*100)}%`);let r=this.checkPhaseTransition();r!==null&&this.callbacks.triggerPhaseTransition&&this.callbacks.triggerPhaseTransition(this,r);let l=this.health/this.maxHealth;this.bossPhase>=2&&!this.minigameTriggered&&l<=c.BOSS_MINIGAME_THRESHOLD&&l>c.BOSS_MINIGAME_THRESHOLD-.05&&this.callbacks.startMinigame&&(this.minigameTriggered=!0,this.callbacks.startMinigame())}return this.health<=0?(this.die(),!0):!1}die(){if(this.isSigma&&this.hasEscaped)return;this.callbacks.incrementCombo&&this.callbacks.incrementCombo();let e=this.callbacks.getComboBonus?this.callbacks.getComboBonus(this.points):0,i=Math.floor(this.coins*h.coinMultiplier);s.score+=this.points+e,s.coins+=i,s.totalCoinsEarned+=i,M.totalCoins+=i,J(),s.kills++,this.callbacks.recordKill&&this.callbacks.recordKill(),this.callbacks.checkAchievements&&this.callbacks.checkAchievements(this),s.healReady||(s.healKills++,s.healKills>=s.healKillsRequired&&(s.healReady=!0,this.callbacks.playSound&&this.callbacks.playSound("heal_ready"))),this.callbacks.playSound&&this.callbacks.playSound("kill"),this.isBoss&&this.callbacks.shakeOnBossDeath?this.callbacks.shakeOnBossDeath():this.callbacks.shakeOnKill&&this.callbacks.shakeOnKill();for(let a=0;a<20;a++)H.push(ce(this.x,this.y,this.z,this.color));let n=e>0?`+${this.points+e} (\u{1F525}+${e})`:`+${this.points}`;if(T.push({text:n,x:this.x,y:this.y-50,z:this.z,life:60,color:e>0?"#ff00ff":"#ffcc00"}),T.push({text:`\u{1FA99}+${this.coins}`,x:this.x+30,y:this.y-70,z:this.z,life:60,color:"#ffd700"}),this.deathMessages&&this.deathMessages.length>0){let a=this.deathMessages[Math.floor(Math.random()*this.deathMessages.length)];T.push({text:a,x:this.x,y:this.y-100,z:this.z,life:90,color:"#00ff00"})}if(this.isBoss){let a=document.getElementById("boss-health-container");a&&(a.style.display="none"),s.bossActive=!1,s.currentBoss=null,this.callbacks.clearPhaseEffects&&this.callbacks.clearPhaseEffects()}this.callbacks.addKillFeed&&this.callbacks.addKillFeed(this.name),this.callbacks.updateHUD&&this.callbacks.updateHUD(),this.callbacks.spawnLensFlare&&this.callbacks.spawnLensFlare(this.x,this.z),this.isBoss&&this.callbacks.onChatBossKill?this.callbacks.onChatBossKill():this.callbacks.onChatKill&&this.callbacks.onChatKill()}draw(e,i){let n=this.isBoss&&this.ascendOffset||0,a=i.width/2+(this.x-h.x)*(_e/Math.max(be,-this.z)),r=i.height/2+(100+n)*(_e/Math.max(be,-this.z)),l=_e/Math.max(be,-this.z),m=this.size*l;if(-this.z<50||-this.z>2e3)return;let d=this.isBoss&&this.bossPhase===3?.3:1;e.fillStyle=`rgba(0,0,0,${.3*d})`,e.beginPath(),e.ellipse(a,i.height/2+100*(_e/Math.max(be,-this.z))+m*.4,m*.5*d,m*.2*d,0,0,Math.PI*2),e.fill();let A=Math.sin(this.wobble)*5;if(this.isBoss&&this.bossPhase===3?(e.shadowColor="#ff3300",e.shadowBlur=40+Math.sin(Date.now()/100)*10):(e.shadowColor=this.color,e.shadowBlur=this.hitFlash>0?30:15),e.fillStyle=this.hitFlash>0?"#ffffff":this.color,e.beginPath(),e.ellipse(a,r-m*.3+A,m*.4,m*.5,0,0,Math.PI*2),e.fill(),e.shadowBlur=0,e.font=`${m*.8}px Arial`,e.textAlign="center",e.textBaseline="middle",this.isBoss)if(this.bossPhase===3){e.fillText("\u{1F525}",a,r-m*.5+A),e.fillText("\u{1F996}",a,r-m*.1+A),e.font=`${m*.3}px Arial`;let I=Math.sin(Date.now()/50)*10;e.fillText("\u{1F525}",a-m*.3,r-m*.4+I),e.fillText("\u{1F525}",a+m*.3,r-m*.4-I)}else this.bossPhase===2?(e.fillText(this.traits[0],a,r-m*.5+A),e.fillText("\u{1F996}",a,r-m*.1+A),e.font=`${m*.5}px Arial`,e.fillText("\u{1F60E}",a,r-m*.35+A)):(e.fillText(this.traits[0],a,r-m*.5+A),e.fillText("\u{1F996}",a,r-m*.1+A));else e.fillText(this.emoji,a,r-m*.3+A);if(e.font=`${m*.3}px Arial`,this.isBoss&&this.bossPhase===3){let I=Math.floor(Date.now()/300)%3,y=["\u2604\uFE0F","\u{1F525}","\u{1F480}"];e.fillText(y[I],a+m*.4,r-m*.6)}else{let I=Math.floor(Date.now()/500)%this.traits.length;e.fillText(this.traits[I],a+m*.4,r-m*.6)}if(!this.isBoss){let I=m*.8,y=8,C=this.health/this.maxHealth;e.fillStyle="#333",e.fillRect(a-I/2,r-m-20,I,y),e.fillStyle=C>.5?"#00ff00":C>.25?"#ffff00":"#ff0000",e.fillRect(a-I/2,r-m-20,I*C,y)}e.font="bold 12px Orbitron",e.fillStyle=this.isBoss?"#ffd700":"#fff",this.isBoss&&this.bossPhase>1?e.fillText(`${this.name} [PHASE ${this.bossPhase}]`,a,r-m-35):e.fillText(this.name,a,r-m-35),this.invulnerable&&(e.font="bold 16px Orbitron",e.fillStyle="#ff0000",e.fillText("INVULNERABLE",a,r-m-55)),this.stunned&&(e.font="bold 16px Orbitron",e.fillStyle="#ff3333",e.fillText("STUNNED - SHOOT WEAK POINTS!",a,r-m-55)),this.phaseTransitioning&&(e.font="bold 20px Orbitron",e.fillStyle="#ff00ff",e.fillText("PHASE SHIFT!",a,r-m-75))}};var{PERSPECTIVE_SCALE:Xe,PERSPECTIVE_MIN_Z:Ze}=c,ae=class{constructor(e,i,n,a,r,l){this.x=e,this.y=i,this.z=n,this.vx=a,this.vy=r,this.vz=l,this.life=100,this.rotation=0;let m=F[f.currentWeapon];this.emoji=m.emoji;let d=m.damage+h.damage+h.damageBonus;this.damage=Math.floor(d*h.damageMultiplier),this.color=m.color,this.weaponType=f.currentWeapon,this.special=m.special||null}update(){this.x+=this.vx,this.y+=this.vy,this.z+=this.vz,this.vy+=.05,this.life--,this.special==="moai"&&(this.rotation+=.15)}spawnSkullTrail(){this.special==="doot"&&this.life%5===0&&T.push({text:"\u{1F480}",x:this.x+(Math.random()-.5)*20,y:this.y+(Math.random()-.5)*20,z:this.z,life:30,color:"#ffffff"})}static showYoAngelo(e,i,n){T.push({text:"Yo, Angelo \u{1F5FF}",x:e+(Math.random()-.5)*30,y:i,z:n,life:60,color:"#8b7355"})}static showSkeletonEffect(e,i,n){T.push({text:"\u{1F480}",x:e,y:i-30,z:n,life:60,color:"#ffffff"}),T.push({text:"DOOT!",x:e,y:i-60,z:n,life:45,color:"#daa520"})}draw(e,i){let n=i.width/2+this.x*(Xe/Math.max(Ze,-this.z)),a=i.height/2+(this.y+100)*(Xe/Math.max(Ze,-this.z)),r=Xe/Math.max(Ze,-this.z);-this.z<10||(e.save(),e.shadowColor=this.color,e.shadowBlur=20,e.font=`${30*r}px Arial`,e.textAlign="center",e.textBaseline="middle",this.special==="moai"?(e.translate(n,a),e.rotate(this.rotation),e.fillText(this.emoji,0,0)):e.fillText(this.emoji,n,a),e.shadowBlur=0,e.restore())}isExpired(){return this.life<=0}};function ve(t=10,e=200){(t>=w.intensity||!w.active)&&(w.intensity=t,w.duration=e,w.startTime=Date.now(),w.active=!0)}function bi(){let t=document.getElementById("game-container");if(!w.active){t.style.transform="translate(0, 0)";return}let i=(Date.now()-w.startTime)/w.duration;if(i>=1){w.active=!1,w.intensity=0,t.style.transform="translate(0, 0)";return}let n=w.intensity*(1-i),a=(Math.random()-.5)*2*n,r=(Math.random()-.5)*2*n;t.style.transform=`translate(${a}px, ${r}px)`}function Je(){ve(15,300)}function vi(){ve(5,150)}function Ci(){ve(8,200)}function Oi(){ve(30,500)}function Ri(t=!1){let e=document.createElement("div");e.className="hit-marker"+(t?" crit":""),e.style.left=v.x+"px",e.style.top=v.y+"px",document.getElementById("game-container").appendChild(e),zt(t),setTimeout(()=>e.remove(),200)}function Qe(){let t=document.getElementById("damage-overlay");t.style.opacity="0.7",setTimeout(()=>t.style.opacity="0",200)}function wi(){let t=document.getElementById("damage-overlay");t.style.background="radial-gradient(ellipse at center, rgba(0,255,0,0.4) 0%, transparent 70%)",t.style.opacity="1",setTimeout(()=>{t.style.opacity="0",t.style.background="radial-gradient(ellipse at center, transparent 50%, rgba(255,0,0,0.5) 100%)"},300)}function xi(){let t=document.getElementById("muzzle-flash");t.style.opacity="1",setTimeout(()=>t.style.opacity="0",50)}function ki(t,e=!1){let i=document.getElementById("wave-announcement");i.innerHTML=e?`\u26A0\uFE0F BOSS WAVE ${t} \u26A0\uFE0F<br><span style="font-size: 36px;">PREPARE FOR BATTLE!</span>`:`WAVE ${t}`,i.style.color=e?"#ff0000":"#ffcc00",i.style.opacity="1",i.style.transform="translate(-50%, -50%) scale(1.5)",setTimeout(()=>{i.style.opacity="0",i.style.transform="translate(-50%, -50%) scale(1)"},2e3)}function Bi(){let t=Date.now();t-P.lastKillTime>P.streakTimeout&&(P.count=0),P.count++,P.lastKillTime=t;let e=Et.slice().reverse().find(i=>P.count>=i.count);e&&P.count===e.count&&(Un(e),Kt(e.count),e.count===3?Yt():e.count>=5&&jt())}function Un(t){let e=document.querySelector(".kill-streak-announcement");e&&e.remove();let i=document.createElement("div");i.className="kill-streak-announcement",i.textContent=t.name,i.style.color=t.color,i.style.textShadow=`0 0 20px ${t.color}, 0 0 40px ${t.color}`,document.getElementById("game-container").appendChild(i),setTimeout(()=>i.remove(),1500)}function Li(){return S.count++,S.count>=c.WOMBO_COMBO_THRESHOLD&&!S.showWomboCombo?(S.showWomboCombo=!0,qn(),g("achievement")):S.count>1&&g("hit"),Ce(),S.count}function Fn(){return S.count>=c.COMBO_VERY_HIGH_THRESHOLD?c.COMBO_DECAY_VERY_HIGH_PERCENT:S.count>=c.COMBO_HIGH_THRESHOLD?c.COMBO_DECAY_HIGH_PERCENT:c.COMBO_DECAY_BASE_PERCENT}function zn(){return Date.now()-S.lastDamageTime<c.COMBO_DAMAGE_COOLDOWN_MS}function et(){if(S.count<=0||zn())return;S.lastDamageTime=Date.now();let t=Fn(),e=Math.ceil(S.count*t/100);S.count=Math.max(0,S.count-e),S.count<c.WOMBO_COMBO_THRESHOLD&&(S.showWomboCombo=!1),Ce()}function Kn(){return S.count<=0?1:1+S.count*c.COMBO_MULTIPLIER_PERCENT/100}function Ni(t){let e=Kn();return Math.floor(t*(e-1))}function Ce(){let t=document.getElementById("combo-counter");t&&(S.count>=2?(t.style.display="block",t.textContent=`COMBO x${S.count}`,S.count>=c.WOMBO_COMBO_THRESHOLD?(t.style.color="#ff00ff",t.style.textShadow="0 0 20px #ff00ff, 0 0 40px #ff00ff",t.classList.add("wombo-combo")):S.count>=5?(t.style.color="#ffff00",t.style.textShadow="0 0 15px #ffff00",t.classList.remove("wombo-combo")):(t.style.color="#00ff00",t.style.textShadow="0 0 10px #00ff00",t.classList.remove("wombo-combo"))):(t.style.display="none",t.classList.remove("wombo-combo")))}function qn(){let t=document.querySelector(".wombo-combo-announcement");t&&t.remove();let e=document.createElement("div");e.className="wombo-combo-announcement",e.innerHTML="\u{1F525} WOMBO COMBO! \u{1F525}",e.style.cssText=`
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) scale(0);
        font-family: 'Bungee', cursive;
        font-size: 72px;
        color: #ff00ff;
        text-shadow: 0 0 30px #ff00ff, 0 0 60px #ff00ff, 0 0 90px #ff00ff;
        z-index: 1000;
        pointer-events: none;
        animation: womboComboAnim 1.5s ease-out forwards;
    `;let i=document.getElementById("game-container");if(i){i.appendChild(e);let n=setTimeout(()=>e.remove(),1500);R(n)}}var{PERSPECTIVE_SCALE:tt,PERSPECTIVE_MIN_Z:it}=c;function Di(t,e){if(K.length>=c.DIALOGUE_BUBBLE_MAX)return;let i=gt[t.type];if(!i||!i[e])return;let n=i[e],a=n[Math.floor(Math.random()*n.length)],r={enemy:t,text:a,life:120,maxLife:120};K.push(r);let l=setTimeout(()=>{let m=K.indexOf(r);m>-1&&K.splice(m,1)},c.DIALOGUE_BUBBLE_DURATION);R(l)}function Pi(t){let e=Le[Math.floor(Math.random()*Le.length)];T.push({text:e,x:t.x,y:t.y-80,z:t.z,life:90,color:"#ffd700"})}function Gi(){let t=Ne[Math.floor(Math.random()*Ne.length)];T.push({text:t,x:0,y:-100,z:-300,life:120,color:"#ff4444"})}function Hi(t,e,i){T.push({text:"360 NO SCOPE!",x:t,y:e-80,z:i,life:60,color:"#ff00ff"})}function Vi(t,e,i){for(let n=K.length-1;n>=0;n--){let a=K[n];a.life--;let r=a.enemy;if(!r||r.health<=0){K.splice(n,1);continue}let l=e.width/2+(r.x-i.x)*(tt/Math.max(it,-r.z)),m=e.height/2+100*(tt/Math.max(it,-r.z)),d=tt/Math.max(it,-r.z);if(-r.z<50||-r.z>2e3)continue;let A=Math.min(1,a.life/30);t.globalAlpha=A,t.font=`bold ${Math.max(10,14*d)}px Orbitron, sans-serif`;let I=t.measureText(a.text).width,y=10*d,C=Math.min(300,I+y*2),Y=30*d,oe=l-C/2,U=m-r.size*d-Y-20*d;t.fillStyle="rgba(0, 0, 0, 0.85)",t.beginPath(),t.roundRect(oe,U,C,Y,8*d),t.fill(),t.strokeStyle="#ffcc00",t.lineWidth=2*d,t.stroke(),t.fillStyle="rgba(0, 0, 0, 0.85)",t.beginPath(),t.moveTo(l-8*d,U+Y),t.lineTo(l,U+Y+10*d),t.lineTo(l+8*d,U+Y),t.closePath(),t.fill(),t.fillStyle="#ffffff",t.textAlign="center",t.textBaseline="middle",t.fillText(a.text,l,U+Y/2),t.globalAlpha=1}}function Wi(){let t=document.getElementById("shop-indicator");t&&(t.classList.add("visible"),g("shop_available"))}function Ui(){let t=document.getElementById("shop-indicator");t&&t.classList.remove("visible")}function Yn(t,e){let i=document.querySelector(".equip-toast");i&&i.remove();let n=document.createElement("div");n.className="equip-toast",n.innerHTML=`<span class="equip-emoji">${e}</span> EQUIPPED!`,document.getElementById("shop-screen").appendChild(n),R(setTimeout(()=>{n.classList.add("hiding"),R(setTimeout(()=>n.remove(),300))},1500))}function $n(){return Object.entries(Z).every(([t,e])=>f.upgrades[t]>=e.maxLevel)}function jn(t,e){let i=$[t];return i.basePrice+e*i.priceIncrease}function Xn(){let t;s.coins>=2e3?t="rich":s.coins<100?t="broke":t="normal";let e=ge[t];return e[Math.floor(Math.random()*e.length)]}function Oe(t=null){let e=t==="purchase"?ge.purchase[Math.floor(Math.random()*ge.purchase.length)]:Xn();document.getElementById("shopkeeper-dialogue").textContent=e}function nt(t){!s.betweenWaves||!s.running||(b.shopSpending=0,s.paused=!0,document.getElementById("shop-screen").style.display="flex",document.getElementById("shop-coins").textContent=`\u{1FA99} ${s.coins}`,Oe(),pe(t))}function Fi(t){s.paused=!1,document.getElementById("shop-screen").style.display="none",s.betweenWaves&&(s.betweenWaves=!1,t())}function pe(t){let e=document.getElementById("weapons-list"),i=document.getElementById("upgrades-list");e.innerHTML="",i.innerHTML="";for(let[n,a]of Object.entries(F)){let r=f.weapons[n],l=f.currentWeapon===n,m=document.createElement("div");m.className=`shop-item ${r?"owned":""} ${l?"equipped":""}`,m.innerHTML=`
            <div class="shop-item-icon">${a.emoji}</div>
            <div class="shop-item-name">${a.name}</div>
            <div class="shop-item-desc">${a.description}</div>
            <div class="shop-item-desc">DMG: ${a.damage} | RATE: ${a.fireRate}</div>
            <div class="shop-item-price">${r?l?"\u2713 EQUIPPED":"CLICK TO EQUIP":`\u{1FA99} ${a.price}`}</div>
        `,m.onclick=()=>{r?(f.currentWeapon=n,g("equip"),Yn(a.name,a.emoji),t(),pe(t)):s.coins>=a.price&&(s.coins-=a.price,Me(a.price),f.weapons[n]=!0,f.currentWeapon=n,g("buy"),Oe("purchase"),document.getElementById("shop-coins").textContent=`\u{1FA99} ${s.coins}`,t(),pe(t))},e.appendChild(m)}for(let[n,a]of Object.entries(Z)){let r=f.upgrades[n],l=r>=a.maxLevel,m=a.basePrice+r*100,d=document.createElement("div");d.className=`shop-item ${l?"maxed":""}`,d.innerHTML=`
            <div class="shop-item-icon">${a.icon}</div>
            <div class="shop-item-name">${a.name}</div>
            <div class="shop-item-desc">${a.description}</div>
            <div class="shop-item-level">Level ${r} / ${a.maxLevel}</div>
            <div class="shop-item-price">${l?"MAXED":`\u{1FA99} ${m}`}</div>
        `,d.onclick=()=>{!l&&s.coins>=m&&(s.coins-=m,Me(m),f.upgrades[n]++,g("buy"),Oe("purchase"),zi(),document.getElementById("shop-coins").textContent=`\u{1FA99} ${s.coins}`,t(),pe(t))},i.appendChild(d)}Zn(t)}function Zn(t){let e=document.getElementById("prestige-upgrades");if(!e)return;if(!$n()){e.style.display="none";return}e.style.display="block";let n=document.getElementById("prestige-list");if(n){n.innerHTML="";for(let[a,r]of Object.entries($)){let l=f.prestigeUpgrades[a],m=jn(a,l),d=document.createElement("div");d.className="shop-item prestige-item",d.innerHTML=`
            <div class="shop-item-icon">${r.icon}</div>
            <div class="shop-item-name">${r.name}</div>
            <div class="shop-item-desc">${r.description}</div>
            <div class="shop-item-level">Level ${l}</div>
            <div class="shop-item-price">\u{1FA99} ${m}</div>
        `,d.onclick=()=>{s.coins>=m&&(s.coins-=m,Me(m),f.prestigeUpgrades[a]++,g("buy"),Oe("purchase"),zi(),document.getElementById("shop-coins").textContent=`\u{1FA99} ${s.coins}`,t(),pe(t))},n.appendChild(d)}}}function zi(){let t=c.PLAYER_BASE_HEALTH+f.upgrades.health*Z.health.perLevel;h.damageBonus=f.upgrades.damage*Z.damage.perLevel,h.fireRateBonus=f.upgrades.fireRate*Z.fireRate.perLevel;let e=c.PLAYER_BASE_CRIT_CHANCE+f.upgrades.critChance*Z.critChance.perLevel;h.damageMultiplier=1+f.prestigeUpgrades.overkill*$.overkill.perLevel,h.fireRateMultiplier=1+f.prestigeUpgrades.bulletHell*$.bulletHell.perLevel,h.healthMultiplier=1+f.prestigeUpgrades.titanHealth*$.titanHealth.perLevel,h.coinMultiplier=1+f.prestigeUpgrades.coinMagnet*$.coinMagnet.perLevel,s.maxHealth=Math.floor(t*h.healthMultiplier),h.critChance=e+f.prestigeUpgrades.criticalMass*$.criticalMass.perLevel}var at=!1;function Jn(t){if(Ee[t])return Ee[t];let e=[5,10,15,20,25],i=Math.floor((t-1)/5)%e.length,n=e[i],a=Ee[n];return{name:a.name+" MK"+Math.floor(t/25+1),title:a.title+" (Ascended)",emoji:a.emoji}}function Qn(t,e){let i=Jn(s.wave),n=document.getElementById("boss-intro-overlay"),a=document.getElementById("boss-intro-emoji"),r=document.getElementById("boss-intro-name"),l=document.getElementById("boss-intro-title"),m=document.getElementById("boss-intro-flash");if(!n||!a||!r||!l){t&&t(i,e);return}s.paused=!0,a.className="",r.className="",l.className="",m&&(m.className=""),a.textContent=i.emoji,r.textContent=i.name,l.textContent=`"${i.title}"`,n.classList.add("active"),R(setTimeout(()=>{a.classList.add("slide-in")},300)),R(setTimeout(()=>{r.classList.add("show")},800)),R(setTimeout(()=>{l.classList.add("show")},1200)),R(setTimeout(()=>{m&&m.classList.add("flash")},2500)),R(setTimeout(()=>{n.classList.remove("active"),s.running&&(s.paused=!1,t&&t(i,e))},3e3))}function ot(t){Qn((e,i)=>{let n=new Q("MINI_BOSS",0,-1e3,i);n.health=c.BOSS_BASE_HEALTH+s.wave*c.BOSS_HEALTH_PER_WAVE,n.maxHealth=n.health,n.shootCooldown=0,n.customName=e.name,ue(n),O.push(n),s.bossActive=!0,s.currentBoss=n;let a=document.getElementById("boss-health-container"),r=document.getElementById("boss-name"),l=document.getElementById("boss-health-bar");a&&(a.style.display="block"),r&&(r.textContent=`\u{1F451} ${e.name} \u{1F451}`),l&&(l.style.width="100%"),g("boss"),hi()},t)}function Ki(t){let e=document.getElementById("boss-tutorial"),i=document.getElementById("boss-tutorial-btn");if(!e||!i){t&&t();return}s.paused=!0,e.classList.add("visible");let n=()=>{e.classList.remove("visible"),s.paused=!1,at=!0,i.removeEventListener("click",n),t&&t()};i.addEventListener("click",n)}function qi(){return s.wave===5&&!at}function Yi(){at=!1}function $i(t,e,i){!t||t.phaseTransitioning||(t.phaseTransitioning=!0,t.invulnerable=!0,i&&i(e===3?"boss_phase3":"boss_phase2"),ea(t,e),R(setTimeout(()=>{t.transitionToPhase(e),t.phaseTransitioning=!1,t.invulnerable=!1,ta(),ia(e)},c.BOSS_PHASE_TRANSITION_DURATION)))}function ea(t,e){let i=document.getElementById("boss-phase-overlay"),n=document.getElementById("boss-phase-number"),a=document.getElementById("boss-phase-title"),r=document.getElementById("boss-phase-emoji");i&&(e===2?(n&&(n.textContent="PHASE 2"),a&&(a.textContent="SUNGLASSES MODE ACTIVATED"),r&&(r.textContent="\u{1F60E}")):e===3&&(n&&(n.textContent="FINAL PHASE"),a&&(a.textContent="ASCENSION COMPLETE"),r&&(r.textContent="\u{1F525}\u{1F451}\u{1F525}")),i.classList.add("active"),i.classList.add(`phase-${e}`))}function ta(){let t=document.getElementById("boss-phase-overlay");t&&t.classList.remove("active","phase-2","phase-3")}function ia(t){let e=document.getElementById("boss-phase-label"),i=document.getElementById("boss-phase-3-marker"),n=document.getElementById("boss-phase-3-label"),a=document.getElementById("game-container");if(e&&(t===2?(e.textContent="\u26A0\uFE0F PHASE 2 ACTIVE",e.style.color="#ff8800"):t===3&&(e.textContent="\u{1F525} FINAL PHASE \u{1F525}",e.style.color="#ff3333")),i&&t===2&&(i.style.display="block"),n&&t===2&&(n.style.display="block"),t===3){let r=document.getElementById("boss-phase-marker");r&&(r.style.opacity="0.3"),i&&(i.style.opacity="0.3"),a&&a.classList.add("phase-3-active"),T.push({text:"\u{1F525} BOSS ENRAGED! \u{1F525}",x:0,y:-200,z:-300,life:120,color:"#ff3333"})}}function ji(){let t=document.getElementById("game-container");t&&t.classList.remove("phase-3-active");let e=document.getElementById("boss-phase-marker"),i=document.getElementById("boss-phase-3-marker"),n=document.getElementById("boss-phase-3-label"),a=document.getElementById("boss-phase-label");e&&(e.style.opacity="1"),i&&(i.style.display="none",i.style.opacity="1"),n&&(n.style.display="none"),a&&(a.textContent="\u26A0\uFE0F PHASE 2",a.style.color="#ffd700")}var{PERSPECTIVE_SCALE:st,PERSPECTIVE_MIN_Z:rt}=c,Re=class{constructor(e,i,n,a={}){this.x=e,this.y=i,this.z=n,this.callbacks=a,this.size=50,this.health=1,this.hitFlash=0,this.markedForRemoval=!1,this.wobble=Math.random()*Math.PI*2,this.pulsePhase=Math.random()*Math.PI*2,this.floatPhase=Math.random()*Math.PI*2,this.baseY=i,this.lifetime=c.MINIGAME_TARGET_LIFETIME,this.spawnTime=Date.now()}update(){this.floatPhase+=.1,this.y=this.baseY+Math.sin(this.floatPhase)*15,this.wobble+=.05,this.pulsePhase+=.15,Date.now()-this.spawnTime>this.lifetime&&(this.markedForRemoval=!0),this.hitFlash=Math.max(0,this.hitFlash-.1)}takeDamage(e){this.hitFlash=1,E.hits++,this.callbacks.playSound&&this.callbacks.playSound("minigame_hit"),this.callbacks.showHitMarker&&this.callbacks.showHitMarker(!0);for(let i=0;i<8;i++)H.push(ce(this.x,this.y,this.z,"#ff3333"));return T.push({text:`WEAK POINT! +${c.MINIGAME_DAMAGE_PER_HIT}`,x:this.x+(Math.random()-.5)*30,y:this.y-30,z:this.z,life:50,color:"#ff3333"}),this.updateMinigameHUD(),this.health=0,!0}updateMinigameHUD(){let e=document.getElementById("minigame-hits");e&&(e.textContent=`HITS: ${E.hits} | DAMAGE: ${E.hits*c.MINIGAME_DAMAGE_PER_HIT}`)}draw(e,i,n){let a=i.width/2+(this.x-n.x)*(st/Math.max(rt,-this.z)),r=i.height/2+this.y*(st/Math.max(rt,-this.z)),l=st/Math.max(rt,-this.z),m=this.size*l;if(-this.z<50||-this.z>2e3)return;let d=Math.sin(this.pulsePhase)*.2+1,A=m*d,I=Date.now()-this.spawnTime,y=this.lifetime-I,C=y<500?y/500:1;e.save(),e.globalAlpha=C*.5,e.shadowColor="#ff3333",e.shadowBlur=30,e.beginPath(),e.arc(a,r,A*.5,0,Math.PI*2),e.fillStyle=this.hitFlash>0?"#ffffff":`rgba(255, 50, 50, ${C})`,e.fill(),e.beginPath(),e.arc(a,r,A*.3,0,Math.PI*2),e.fillStyle=`rgba(255, 200, 50, ${C})`,e.fill(),e.beginPath(),e.arc(a,r,A*.1,0,Math.PI*2),e.fillStyle=`rgba(255, 255, 255, ${C})`,e.fill(),e.shadowBlur=0,e.globalAlpha=C,e.font=`${A*.6}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText("\u{1F3AF}",a,r),e.font=`bold ${Math.max(10,A*.25)}px Orbitron`,e.fillStyle="#ffcc00",e.fillText("WEAK POINT",a,r-A*.5-10),e.restore()}isExpired(){return this.health<=0||this.markedForRemoval}};function na(t){return{playSound:t?.playSound||g,showHitMarker:t?.showHitMarker}}function Xi(t){if(!E.active||!s.currentBoss)return;let e=s.currentBoss,i=Math.random()*Math.PI*2,n=100+Math.random()*150,a=e.x+Math.cos(i)*n,r=-30-Math.random()*80,l=e.z-50-Math.random()*100,m=new Re(a,r,l,na(t));V.push(m)}function Zi(t){if(E.active)return;E.active=!0,E.hits=0,E.timeLeft=c.MINIGAME_DURATION_SEC,s.currentBoss&&(s.currentBoss.invulnerable=!1,s.currentBoss.stunned=!0);let e=document.getElementById("minigame-screen");e&&(e.style.display="flex",e.classList.add("hud-mode"));let i=document.getElementById("minigame-timer");i&&(i.textContent=E.timeLeft);let n=document.getElementById("minigame-hits");n&&(n.textContent="HITS: 0 | DAMAGE: 0");let a=document.getElementById("minigame-instructions");a&&(a.textContent="SHOOT THE WEAK POINTS!");let r=document.getElementById("minigame-area");r&&(r.style.display="none"),g("boss"),T.push({text:"BOSS VULNERABLE!",x:0,y:-150,z:-300,life:90,color:"#ff3333"}),E.targetInterval=setInterval(()=>{Xi(t)},c.MINIGAME_TARGET_SPAWN_INTERVAL);for(let l=0;l<3;l++)Xi(t);E.interval=setInterval(()=>{E.timeLeft--;let l=document.getElementById("minigame-timer");l&&(l.textContent=E.timeLeft),E.timeLeft<=0&&aa()},1e3)}function aa(){clearInterval(E.interval),clearInterval(E.targetInterval),E.active=!1;let t=document.getElementById("minigame-screen");if(t&&(t.style.display="none",t.classList.remove("hud-mode")),V.length=0,s.currentBoss){s.currentBoss.stunned=!1;let e=E.hits*c.MINIGAME_DAMAGE_PER_HIT;if(e>0){s.currentBoss.health-=e;let i=document.getElementById("boss-health-bar");i&&(i.style.width=`${Math.max(0,s.currentBoss.health/s.currentBoss.maxHealth*100)}%`),T.push({text:`WEAK POINT BONUS: -${e}!`,x:s.currentBoss.x,y:-100,z:s.currentBoss.z,life:90,color:"#ff00ff"}),s.currentBoss.health<=0&&(s.currentBoss.die(),s.currentBoss.markedForRemoval=!0)}else T.push({text:"BOSS RECOVERED!",x:s.currentBoss.x,y:-100,z:s.currentBoss.z,life:90,color:"#ffcc00"})}}var{PERSPECTIVE_SCALE:lt,PERSPECTIVE_MIN_Z:Ji}=c;function X(){document.getElementById("score").textContent=s.score.toLocaleString(),document.getElementById("coins-display").textContent=`\u{1FA99} ${s.coins}`,document.getElementById("kills").textContent=s.kills,document.getElementById("wave-display").textContent=`WAVE ${s.wave}`,document.getElementById("health-bar").style.width=`${Math.max(0,s.health/s.maxHealth*100)}%`;let t=F[f.currentWeapon];document.getElementById("weapon-name").textContent=t.name;let e=Math.floor((t.damage+h.damage+h.damageBonus)*h.damageMultiplier);document.getElementById("weapon-stats").textContent=`DMG: ${e} | CRIT: ${Math.floor(h.critChance*100)}%`;let i=s.healKills/s.healKillsRequired*100,n=document.getElementById("heal-power-bar"),a=document.getElementById("heal-power-text"),r=document.getElementById("heal-power-container");if(n.style.width=`${Math.min(100,i)}%`,s.healReady)a.textContent="\u2728 READY! Press E \u2728",a.style.color="#ffd700",r.style.borderColor="#ffd700",r.style.boxShadow="0 0 20px #ffd700",n.style.background="linear-gradient(90deg, #ffd700, #ffaa00)",r.classList.add("heal-ready");else{let l=s.healKillsRequired-s.healKills;a.textContent=`${l} more kill${l!==1?"s":""} needed`,a.style.color="#888",r.style.borderColor="#444",r.style.boxShadow="none",n.style.background="linear-gradient(90deg, #00ff00, #88ff88)",r.classList.remove("heal-ready")}}function Qi(){let t=document.getElementById("crosshair"),e=ne();if(E.active){t.style.display="none",document.body.style.cursor="crosshair";return}else t.style.display="block",document.body.style.cursor=e?"default":"none";t.style.left=v.x+"px",t.style.top=v.y+"px",t.style.transform="translate(-50%, -50%)"}function en(t){let e=document.getElementById("kill-feed"),i=document.createElement("div");for(i.className="kill-entry",i.innerHTML=`\u{1F385} SANTA <span style="color:#ff6b6b">eliminated</span> ${t}`,e.insertBefore(i,e.firstChild);e.children.length>c.KILL_FEED_MAX_ENTRIES;)e.removeChild(e.lastChild);setTimeout(()=>i.remove(),c.KILL_FEED_DURATION_MS)}function ct(t){t.width=window.innerWidth,t.height=window.innerHeight}function tn(t,e){let i=t.createLinearGradient(0,0,0,e.height);i.addColorStop(0,"#1a0a2e"),i.addColorStop(.5,"#16213e"),i.addColorStop(1,"#0f3460"),t.fillStyle=i,t.fillRect(0,0,e.width,e.height),t.fillStyle="#fff";for(let n=0;n<100;n++){let a=n*137.5%e.width,r=n*73.3%(e.height*.6),l=n%3+1,m=Math.sin(Date.now()/500+n)*.5+.5;t.globalAlpha=m,t.beginPath(),t.arc(a,r,l,0,Math.PI*2),t.fill()}t.globalAlpha=1,t.fillStyle="#ffffd0",t.shadowColor="#ffffd0",t.shadowBlur=50,t.beginPath(),t.arc(e.width-150,150,60,0,Math.PI*2),t.fill(),t.shadowBlur=0,t.fillStyle="#1a1a2e",t.fillRect(0,e.height*.65,e.width,e.height*.35),t.strokeStyle="#333355",t.lineWidth=1;for(let n=100;n<2e3;n+=100){let a=e.height*.65+lt/n*300;t.globalAlpha=1-n/2e3,t.beginPath(),t.moveTo(0,a),t.lineTo(e.width,a),t.stroke()}t.globalAlpha=1}function nn(t,e){let i=Math.sin(Date.now()/150)*3,n=F[f.currentWeapon],a=Jt();t.strokeStyle=a.glowColor+"50",t.lineWidth=2,t.setLineDash([5,5]),t.beginPath(),t.moveTo(e.width/2,e.height-100),t.lineTo(v.x,v.y),t.stroke(),t.setLineDash([]),t.fillStyle=a.color,t.shadowColor=a.glowColor,t.shadowBlur=10,t.beginPath(),t.ellipse(e.width/2-100,e.height-100+i,40,50,-.3,0,Math.PI*2),t.fill(),t.beginPath(),t.ellipse(e.width/2+100,e.height-100+i,40,50,.3,0,Math.PI*2),t.fill(),t.shadowBlur=0,t.save(),t.translate(e.width/2,e.height-80+i),t.fillStyle="#228b22",t.fillRect(-60,-40,120,80),t.fillStyle=n.color,t.fillRect(-10,-40,20,80),t.fillRect(-60,-10,120,20),t.font="40px Arial",t.textAlign="center",t.textBaseline="middle",t.fillText(n.emoji,0,0),t.fillStyle="#1a5c1a",t.fillRect(50,-20,40,40),t.restore()}function an(t,e){for(let i=T.length-1;i>=0;i--){let n=T[i];n.y-=2,n.life--;let a=e.width/2+n.x*(lt/Math.max(Ji,-n.z)),r=e.height/2+n.y*(lt/Math.max(Ji,-n.z));t.globalAlpha=n.life/60,t.font="bold 24px Bungee",t.fillStyle=n.color,t.textAlign="center",t.fillText(n.text,a,r),t.globalAlpha=1,n.life<=0&&T.splice(i,1)}}function on(t){if(!Ue())return;let e=k.floatingElements,i=De;if(e.length<i.MAX_FLOATING_ELEMENTS){for(let n of i.FLOATING_ELEMENTS)if(Math.random()<n.spawnChance){let a=n.name==="Airplane";e.push({emoji:n.emoji,name:n.name,x:-100,y:Math.random()*(t.height*.5),speed:n.speed+Math.random()*.3,size:n.size,rotation:Math.random()*Math.PI*2,rotationSpeed:(Math.random()-.5)*.02,banner:a?i.AIRPLANE_BANNERS[Math.floor(Math.random()*i.AIRPLANE_BANNERS.length)]:null,parallaxFactor:.05+Math.random()*.1});break}}for(let n=e.length-1;n>=0;n--){let a=e[n];a.x+=a.speed,a.rotation+=a.rotationSpeed,a.x>t.width+200&&e.splice(n,1)}}function sn(t,e){if(!Ue())return;let i=De,n=e.width/2,a=e.height/2,r=(v.x-n)/n,l=(v.y-a)/a,m=i.DOGE_MOON,d=e.width*m.x+r*i.PARALLAX_INTENSITY*m.parallaxFactor,A=e.height*m.y+l*i.PARALLAX_INTENSITY*m.parallaxFactor;t.save(),t.font=`${m.size}px Arial`,t.textAlign="center",t.textBaseline="middle",t.globalAlpha=.8,t.fillText(m.emoji,d,A),t.font="bold 12px Comic Sans MS, cursive",t.fillStyle="#FFD700",t.globalAlpha=.5,t.fillText("much moon",d+40,A-20),t.fillText("very space",d-45,A+25),t.restore();let I=k.floatingElements;for(let y of I){let C=r*i.PARALLAX_INTENSITY*y.parallaxFactor,Y=l*i.PARALLAX_INTENSITY*y.parallaxFactor;if(t.save(),t.translate(y.x+C,y.y+Y),t.rotate(y.rotation),t.globalAlpha=.7,t.font=`${y.size}px Arial`,t.textAlign="center",t.textBaseline="middle",t.fillText(y.emoji,0,0),y.banner){t.rotate(-y.rotation),t.font="bold 14px Bungee, Arial",t.fillStyle="#ffffff",t.strokeStyle="#000000",t.lineWidth=3,t.globalAlpha=.9,t.beginPath(),t.moveTo(y.size/2,0),t.lineTo(y.size/2+80,20),t.strokeStyle="#888888",t.lineWidth=2,t.stroke();let oe=y.size/2+80,U=20;t.fillStyle="#FF6B6B",t.fillRect(oe-5,U-12,t.measureText(y.banner).width+10,24),t.fillStyle="#ffffff",t.strokeStyle="#000000",t.lineWidth=1,t.strokeText(y.banner,oe,U),t.fillText(y.banner,oe,U)}t.restore()}}var _,B,rn=null;function oa(){if(!ne())return;let t=document.getElementById("mobile-heal-btn"),e=document.getElementById("mobile-shop-btn");t&&(s.healReady?(t.classList.add("ready"),t.classList.remove("disabled")):(t.classList.remove("ready"),t.classList.add("disabled"))),e&&(s.betweenWaves?(e.classList.add("ready"),e.classList.remove("disabled")):(e.classList.remove("ready"),e.classList.add("disabled")))}function we(){return{playSound:g,showDamageOverlay:Qe,shakeOnDamage:Je,shakeOnKill:vi,shakeOnCrit:Ci,shakeOnBossDeath:Oi,showHitMarker:Ri,showEnemyDialogue:Di,showSigmaDialogue:Pi,showSigmaEscapeText:Gi,showGamerAttackText:Hi,updateHUD:X,addKillFeed:en,recordKill:Bi,incrementCombo:Li,breakCombo:et,getComboBonus:Ni,startMinigame:Zi,gameOver:ln,checkAchievements:Ti,spawnLensFlare:rn,onChatKill:ci,onChatBossKill:ui,triggerPhaseTransition:(t,e)=>$i(t,e,g),clearPhaseEffects:ji}}function sa(){let t=(s.wave-1)*c.SIGMA_SPAWN_CHANCE_PER_WAVE;return Math.min(c.SIGMA_MAX_SPAWN_CHANCE,c.SIGMA_BASE_SPAWN_CHANCE+t)}function ra(){let t,e=Math.random(),i=sa();if(s.sigmaSpawnedThisWave<c.SIGMA_MAX_PER_WAVE&&e<i){t="SIGMA_DINO",s.sigmaSpawnedThisWave++;let d=(Math.random()>.5?1:-1)*c.SIGMA_SPAWN_X,A=c.SIGMA_SPAWN_Z_BASE-Math.random()*c.SIGMA_SPAWN_Z_RANGE,I=new Q(t,d,A,we());ue(I),O.push(I);return}else s.wave>=3&&e<.3?t="GAMER_DINO":e<.55?t="BUFF_NERD":t="GIGACHAD";let a=(Math.random()-.5)*c.ENEMY_SPAWN_X_RANGE,r=c.ENEMY_SPAWN_Z_BASE-Math.random()*c.ENEMY_SPAWN_Z_RANGE,l=new Q(t,a,r,we());ue(l),O.push(l)}function mt(){s.waveInProgress=!0,s.sigmaSpawnedThisWave=0,s.waveSpawningComplete=!1,Ei(),_i(s.wave),We();let t=s.wave%c.BOSS_WAVE_INTERVAL===0;if(ki(s.wave,t),t)setTimeout(()=>{qi()?Ki(()=>{ot(we()),s.waveSpawningComplete=!0}):(ot(we()),s.waveSpawningComplete=!0)},1e3);else{let e=c.ENEMIES_BASE_COUNT+s.wave*c.ENEMIES_PER_WAVE;for(let i=0;i<e;i++)setTimeout(()=>{ra(),i===e-1&&(s.waveSpawningComplete=!0)},i*c.ENEMY_SPAWN_DELAY_MS)}}function xe(){if(!s.running||s.paused||h.fireCooldown>0)return;let t=F[f.currentWeapon];Si(t.special),t.special==="doot"?g("doot"):g("shoot");let e=t.fireRate-h.fireRateBonus;h.fireCooldown=Math.max(3,Math.floor(e/h.fireRateMultiplier));let i=_.width/2,n=_.height/2,a=(v.x-i)/i,r=(v.y-n)/n,l=-t.speed,m=a*t.speed*.8,d=r*t.speed*.5-1;ie.push(new ae(h.x,0,0,m,d,l)),xi()}function ht(){!s.running||s.paused||s.healReady&&(s.healReady=!1,s.healKills=0,s.health=Math.min(s.maxHealth,s.health+c.HEAL_AMOUNT),g("heal"),wi(),T.push({text:`+${c.HEAL_AMOUNT} HP`,x:0,y:-50,z:-200,life:60,color:"#00ff00"}),X())}function ln(){s.running=!1,Xt(),mi(),Ai(),ni(),document.getElementById("game-over").style.display="flex"}function dt(){document.getElementById("start-screen").style.display="none",document.getElementById("game-over").style.display="none",document.getElementById("shop-screen").style.display="none",document.getElementById("boss-health-container").style.display="none",bt(),yt(),Mt(),It(),_t(),Ut(),vt(),Ct(),Ot(),Rt(),wt(),xt(),Yi(),Pt(),We(),Ce(),pi(),fi(),X(),mt(),Ft()}function cn(){if(B.clearRect(0,0,_.width,_.height),tn(B,_),on(_),sn(B,_),Qi(),bi(),oa(),s.running&&!s.paused){h.fireCooldown>0&&h.fireCooldown--;for(let t=ie.length-1;t>=0;t--){let e=ie[t];e.update(),e.spawnSkullTrail();for(let i=O.length-1;i>=0;i--){let n=O[i],a=e.x-n.x,r=e.y-n.y,l=e.z-n.z,m=Math.sqrt(a*a+r*r+l*l),d=c.PROJECTILE_HIT_RADIUS_BASE+n.size/3;if(m<d){e.special==="moai"&&(ae.showYoAngelo(n.x,n.y-50,n.z),g("moai")),n.takeDamage(e.damage)&&(e.special==="doot"&&(ae.showSkeletonEffect(n.x,n.y,n.z),g("doot_kill")),n.markedForRemoval=!0),e.life=0;break}}for(let i=V.length-1;i>=0;i--){let n=V[i],a=e.x-n.x,r=e.y-n.y,l=e.z-n.z;if(Math.sqrt(a*a+r*r+l*l)<60){n.takeDamage(e.damage),e.life=0;break}}e.draw(B,_),e.isExpired()&&ie.splice(t,1)}for(let t=G.length-1;t>=0;t--){let e=G[t];e.update(),e.checkPlayerCollision(h)&&(s.health-=e.damage,s.lastAttacker=e.attackerName,b.totalDamageTaken+=e.damage,Se(e.attackerName,e.damage),g("damage"),Qe(),Je(),et(),s.health<=0&&ln(),X()),e.draw(B,_),e.isExpired()&&G.splice(t,1)}O.sort((t,e)=>t.z-e.z),O.forEach(t=>{t.update(),t.draw(B,_)});for(let t=O.length-1;t>=0;t--)O[t].markedForRemoval&&O.splice(t,1);for(let t=V.length-1;t>=0;t--){let e=V[t];e.update(),e.draw(B,_,h),e.isExpired()&&V.splice(t,1)}for(let t=H.length-1;t>=0;t--){let e=H[t];e.update(),e.draw(B,_,h),e.isExpired()&&(Ht(e),H.splice(t,1))}if(an(B,_),Vi(B,_,h),O.length===0&&s.waveInProgress&&s.waveSpawningComplete){gi(),s.waveInProgress=!1,s.wave++,s.betweenWaves=!0,G.length=0,s.health=Math.min(s.maxHealth,s.health+c.WAVE_BETWEEN_HEAL_AMOUNT),X();let t=s.wave%c.BOSS_WAVE_INTERVAL===0;t||Wi(),setTimeout(()=>{s.betweenWaves&&(Ui(),t?(s.betweenWaves=!1,mt()):nt(X))},1500)}}nn(B,_),requestAnimationFrame(cn)}function mn(t){_=t,B=_.getContext("2d"),rn=li(_),ct(_),window.addEventListener("resize",()=>ct(_)),cn()}function ut(){nt(X)}function hn(){Fi(mt)}function la(){Vt();let t=document.getElementById("background-memes-btn");t&&(t.addEventListener("click",()=>{Wt(),dn()}),dn())}function dn(){let t=document.getElementById("background-memes-btn"),e=t?.querySelector(".toggle-text");!t||!e||(k.enabled?(t.classList.add("active"),e.textContent="BACKGROUND MEMES: ON"):(t.classList.remove("active"),e.textContent="BACKGROUND MEMES: OFF"))}function un(){let t=document.getElementById("game-canvas");St(),ca(),Qt(),oi(),yi(),la(),mn(t),ma()}function ca(){let t=document.getElementById("mobile-controls"),e=document.getElementById("desktop-controls"),i=document.getElementById("touch-controls");ne()?(t&&t.classList.add("visible"),e&&(e.style.display="none"),i&&(i.style.display="block"),document.body.classList.add("touch-device")):(t&&t.classList.remove("visible"),e&&(e.style.display="block"),i&&(i.style.display="none"))}function ma(){document.addEventListener("keydown",l=>{(l.key===" "||l.code==="Space")&&(l.preventDefault(),xe()),(l.key==="e"||l.key==="E")&&ht(),(l.key==="r"||l.key==="R")&&s.betweenWaves&&ut(),Mi(l),l.key.length===1&&/[a-zA-Z]/.test(l.key)&&Ii(l.key)}),document.addEventListener("mousemove",l=>{ye(l.clientX,l.clientY)}),document.addEventListener("click",l=>{s.running&&!s.paused&&xe()}),document.addEventListener("contextmenu",l=>l.preventDefault()),document.addEventListener("touchstart",l=>{if(!(l.target.closest(".mobile-btn")||l.target.closest(".game-btn")||l.target.closest("#shop-screen")||l.target.closest("#start-screen")||l.target.closest("#game-over"))&&s.running&&!s.paused){L.isAiming=!0;let m=l.touches[0];ye(m.clientX,m.clientY),L.lastTouchX=m.clientX,L.lastTouchY=m.clientY}},{passive:!0}),document.addEventListener("touchmove",l=>{if(!(l.target.closest(".mobile-btn")||l.target.closest(".game-btn")||l.target.closest("#shop-screen")||l.target.closest("#start-screen")||l.target.closest("#game-over"))&&L.isAiming&&s.running&&!s.paused){let m=l.touches[0];ye(m.clientX,m.clientY),L.lastTouchX=m.clientX,L.lastTouchY=m.clientY}},{passive:!0}),document.addEventListener("touchend",()=>{L.isAiming=!1},{passive:!0});let t=document.getElementById("mobile-fire-btn"),e=document.getElementById("mobile-heal-btn"),i=document.getElementById("mobile-shop-btn");t&&(t.addEventListener("touchstart",l=>{l.preventDefault(),l.stopPropagation(),s.running&&!s.paused&&(xe(),t.classList.add("active"))}),t.addEventListener("touchend",l=>{l.preventDefault(),t.classList.remove("active")})),e&&(e.addEventListener("touchstart",l=>{l.preventDefault(),l.stopPropagation(),s.running&&!s.paused&&(ht(),e.classList.add("active"))}),e.addEventListener("touchend",l=>{l.preventDefault(),e.classList.remove("active")})),i&&(i.addEventListener("touchstart",l=>{l.preventDefault(),l.stopPropagation(),s.betweenWaves&&(ut(),i.classList.add("active"))}),i.addEventListener("touchend",l=>{l.preventDefault(),i.classList.remove("active")})),document.addEventListener("touchstart",l=>{l.touches.length>1&&l.preventDefault()},{passive:!1});let n=0;document.addEventListener("touchend",l=>{let m=Date.now();m-n<=300&&l.preventDefault(),n=m},{passive:!1}),document.getElementById("start-btn").addEventListener("click",dt),document.getElementById("restart-btn").addEventListener("click",dt),document.getElementById("copy-receipt-btn").addEventListener("click",ai),document.getElementById("continue-btn").addEventListener("click",hn);let a=document.getElementById("volume-slider"),r=document.getElementById("volume-value");a&&r&&a.addEventListener("input",l=>{let m=parseInt(l.target.value,10);qt(m/100),r.textContent=m+"%"})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",un):un();})();
</script>
</body>
</html>